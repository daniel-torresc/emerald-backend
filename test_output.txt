============================= test session starts ==============================
platform darwin -- Python 3.13.1, pytest-8.4.2, pluggy-1.6.0 -- /Users/danieltorres/Documents/emerald/emerald-backend/.venv/bin/python3
cachedir: .pytest_cache
rootdir: /Users/danieltorres/Documents/emerald/emerald-backend
configfile: pyproject.toml
plugins: asyncio-1.2.0, anyio-4.11.0, cov-7.0.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 400 items

tests/e2e/test_collaboration_workflow.py::test_account_sharing_collaboration_workflow FAILED [  0%]
tests/e2e/test_collaboration_workflow.py::test_permission_downgrade_workflow PASSED [  0%]
tests/e2e/test_collaboration_workflow.py::test_shared_account_transaction_visibility FAILED [  0%]
tests/e2e/test_collaboration_workflow.py::test_share_list_visibility PASSED [  1%]
tests/e2e/test_collaboration_workflow.py::test_cascading_share_revocation PASSED [  1%]
tests/e2e/test_user_journey.py::test_complete_user_journey PASSED        [  1%]
tests/e2e/test_user_journey.py::test_new_user_creates_multiple_accounts_and_transactions FAILED [  1%]
tests/e2e/test_user_journey.py::test_user_deactivation_workflow PASSED   [  2%]
tests/e2e/test_user_journey.py::test_transaction_split_and_join_workflow FAILED [  2%]
tests/e2e/test_user_journey.py::test_account_lifecycle_workflow FAILED   [  2%]
tests/integration/test_account_routes.py::TestAccountRoutes::test_create_account_success PASSED [  2%]
tests/integration/test_account_routes.py::TestAccountRoutes::test_create_account_negative_balance PASSED [  3%]
tests/integration/test_account_routes.py::TestAccountRoutes::test_create_account_duplicate_name PASSED [  3%]
tests/integration/test_account_routes.py::TestAccountRoutes::test_create_account_invalid_currency PASSED [  3%]
tests/integration/test_account_routes.py::TestAccountRoutes::test_create_account_unsupported_currency PASSED [  3%]
tests/integration/test_account_routes.py::TestAccountRoutes::test_create_account_unauthenticated PASSED [  4%]
tests/integration/test_account_routes.py::TestAccountRoutes::test_list_accounts_empty PASSED [  4%]
tests/integration/test_account_routes.py::TestAccountRoutes::test_list_accounts_multiple PASSED [  4%]
tests/integration/test_account_routes.py::TestAccountRoutes::test_list_accounts_filter_by_type PASSED [  4%]
tests/integration/test_account_routes.py::TestAccountRoutes::test_list_accounts_filter_by_active PASSED [  5%]
tests/integration/test_account_routes.py::TestAccountRoutes::test_list_accounts_pagination PASSED [  5%]
tests/integration/test_account_routes.py::TestAccountRoutes::test_get_account_success PASSED [  5%]
tests/integration/test_account_routes.py::TestAccountRoutes::test_get_account_not_found PASSED [  5%]
tests/integration/test_account_routes.py::TestAccountRoutes::test_get_account_not_owner PASSED [  6%]
tests/integration/test_account_routes.py::TestAccountRoutes::test_update_account_name PASSED [  6%]
tests/integration/test_account_routes.py::TestAccountRoutes::test_update_account_duplicate_name PASSED [  6%]
tests/integration/test_account_routes.py::TestAccountRoutes::test_delete_account_success PASSED [  6%]
tests/integration/test_account_routes.py::TestAccountRoutes::test_delete_account_not_owner PASSED [  7%]
tests/integration/test_account_routes.py::TestAccountRoutes::test_delete_account_not_found PASSED [  7%]
tests/integration/test_account_routes.py::TestAccountRoutes::test_create_account_invalid_account_type_id PASSED [  7%]
tests/integration/test_account_routes.py::TestAccountRoutes::test_create_account_nil_uuid_account_type PASSED [  7%]
tests/integration/test_account_routes.py::TestAccountRoutes::test_create_account_inactive_account_type FAILED [  8%]
tests/integration/test_account_routes.py::TestAccountRoutes::test_create_account_system_account_type_success PASSED [  8%]
tests/integration/test_account_routes.py::TestAccountRoutes::test_update_account_change_account_type PASSED [  8%]
tests/integration/test_account_routes.py::TestAccountRoutes::test_update_account_invalid_account_type FAILED [  8%]
tests/integration/test_account_sharing_routes.py::test_create_share_viewer_success PASSED [  9%]
tests/integration/test_account_sharing_routes.py::test_create_share_editor_success PASSED [  9%]
tests/integration/test_account_sharing_routes.py::test_create_share_cannot_grant_owner_permission PASSED [  9%]
tests/integration/test_account_sharing_routes.py::test_create_share_non_owner_cannot_share PASSED [  9%]
tests/integration/test_account_sharing_routes.py::test_create_share_cannot_share_with_self PASSED [ 10%]
tests/integration/test_account_sharing_routes.py::test_create_share_nonexistent_account PASSED [ 10%]
tests/integration/test_account_sharing_routes.py::test_create_share_nonexistent_user PASSED [ 10%]
tests/integration/test_account_sharing_routes.py::test_create_share_duplicate_share PASSED [ 10%]
tests/integration/test_account_sharing_routes.py::test_list_shares_owner_sees_all PASSED [ 11%]
tests/integration/test_account_sharing_routes.py::test_list_shares_editor_can_view PASSED [ 11%]
tests/integration/test_account_sharing_routes.py::test_list_shares_viewer_can_view PASSED [ 11%]
tests/integration/test_account_sharing_routes.py::test_list_shares_non_member_cannot_view PASSED [ 11%]
tests/integration/test_account_sharing_routes.py::test_list_shares_empty_for_unshared_account PASSED [ 12%]
tests/integration/test_account_sharing_routes.py::test_update_share_upgrade_viewer_to_editor PASSED [ 12%]
tests/integration/test_account_sharing_routes.py::test_update_share_downgrade_editor_to_viewer PASSED [ 12%]
tests/integration/test_account_sharing_routes.py::test_update_share_cannot_grant_owner_permission PASSED [ 12%]
tests/integration/test_account_sharing_routes.py::test_update_share_non_owner_cannot_update PASSED [ 13%]
tests/integration/test_account_sharing_routes.py::test_update_share_nonexistent_share PASSED [ 13%]
tests/integration/test_account_sharing_routes.py::test_update_share_cannot_modify_owner_share PASSED [ 13%]
tests/integration/test_account_sharing_routes.py::test_revoke_share_viewer_success PASSED [ 13%]
tests/integration/test_account_sharing_routes.py::test_revoke_share_editor_success PASSED [ 14%]
tests/integration/test_account_sharing_routes.py::test_revoke_share_non_owner_cannot_revoke PASSED [ 14%]
tests/integration/test_account_sharing_routes.py::test_revoke_share_cannot_revoke_owner_share PASSED [ 14%]
tests/integration/test_account_sharing_routes.py::test_revoke_share_user_loses_access_immediately PASSED [ 14%]
tests/integration/test_account_sharing_routes.py::test_shared_viewer_cannot_create_transaction PASSED [ 15%]
tests/integration/test_account_sharing_routes.py::test_shared_editor_cannot_delete_account PASSED [ 15%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_create_account_type_success PASSED [ 15%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_create_account_type_minimal_data FAILED [ 15%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_create_account_type_duplicate_key FAILED [ 16%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_create_account_type_invalid_key_format FAILED [ 16%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_create_account_type_empty_key PASSED [ 16%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_create_account_type_whitespace_trimming FAILED [ 16%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_create_account_type_non_admin_forbidden PASSED [ 17%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_create_account_type_unauthenticated PASSED [ 17%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_list_account_types_success FAILED [ 17%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_list_account_types_filter_active_only FAILED [ 17%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_list_account_types_filter_inactive_only FAILED [ 18%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_list_account_types_all FAILED [ 18%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_list_account_types_ordering FAILED [ 18%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_list_account_types_unauthenticated PASSED [ 18%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_get_account_type_by_id_success FAILED [ 19%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_get_account_type_by_id_not_found PASSED [ 19%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_get_account_type_by_id_inactive FAILED [ 19%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_get_account_type_by_id_unauthenticated PASSED [ 19%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_get_account_type_by_key_success FAILED [ 20%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_get_account_type_by_key_case_insensitive FAILED [ 20%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_get_account_type_by_key_not_found PASSED [ 20%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_update_account_type_success FAILED [ 20%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_update_account_type_partial FAILED [ 21%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_update_account_type_deactivate_via_update FAILED [ 21%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_update_account_type_not_found PASSED [ 21%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_update_account_type_non_admin_forbidden FAILED [ 21%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_deactivate_account_type_success FAILED [ 22%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_deactivate_account_type_already_inactive FAILED [ 22%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_deactivate_account_type_non_admin_forbidden FAILED [ 22%]
tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_deactivate_account_type_not_found PASSED [ 22%]
tests/integration/test_auth_routes.py::TestRegistration::test_register_success PASSED [ 23%]
tests/integration/test_auth_routes.py::TestRegistration::test_register_duplicate_email PASSED [ 23%]
tests/integration/test_auth_routes.py::TestRegistration::test_register_duplicate_username PASSED [ 23%]
tests/integration/test_auth_routes.py::TestRegistration::test_register_weak_password PASSED [ 23%]
tests/integration/test_auth_routes.py::TestRegistration::test_register_invalid_email PASSED [ 24%]
tests/integration/test_auth_routes.py::TestLogin::test_login_success PASSED [ 24%]
tests/integration/test_auth_routes.py::TestLogin::test_login_invalid_email PASSED [ 24%]
tests/integration/test_auth_routes.py::TestLogin::test_login_invalid_password PASSED [ 24%]
tests/integration/test_auth_routes.py::TestLogin::test_login_inactive_user PASSED [ 25%]
tests/integration/test_auth_routes.py::TestTokenRefresh::test_refresh_success PASSED [ 25%]
tests/integration/test_auth_routes.py::TestTokenRefresh::test_refresh_invalid_token PASSED [ 25%]
tests/integration/test_auth_routes.py::TestTokenRefresh::test_refresh_access_token_fails PASSED [ 25%]
tests/integration/test_auth_routes.py::TestTokenRefresh::test_refresh_token_reuse_detection PASSED [ 26%]
tests/integration/test_auth_routes.py::TestLogout::test_logout_success PASSED [ 26%]
tests/integration/test_auth_routes.py::TestLogout::test_logout_invalid_token PASSED [ 26%]
tests/integration/test_auth_routes.py::TestPasswordChange::test_change_password_success PASSED [ 26%]
tests/integration/test_auth_routes.py::TestPasswordChange::test_change_password_wrong_current PASSED [ 27%]
tests/integration/test_auth_routes.py::TestPasswordChange::test_change_password_weak_new_password PASSED [ 27%]
tests/integration/test_auth_routes.py::TestPasswordChange::test_change_password_unauthenticated PASSED [ 27%]
tests/integration/test_auth_routes.py::TestAuthorization::test_access_with_valid_token PASSED [ 27%]
tests/integration/test_auth_routes.py::TestAuthorization::test_access_without_token PASSED [ 28%]
tests/integration/test_auth_routes.py::TestAuthorization::test_access_with_invalid_token PASSED [ 28%]
tests/integration/test_auth_routes.py::TestAuthenticationFlows::test_full_user_lifecycle PASSED [ 28%]
tests/integration/test_auth_routes.py::TestAuthenticationFlows::test_password_change_flow PASSED [ 28%]
tests/integration/test_card_routes.py::TestCreateCard::test_create_card_success PASSED [ 29%]
tests/integration/test_card_routes.py::TestCreateCard::test_create_card_minimal PASSED [ 29%]
tests/integration/test_card_routes.py::TestCreateCard::test_create_card_unauthorized PASSED [ 29%]
tests/integration/test_card_routes.py::TestCreateCard::test_create_card_account_not_found PASSED [ 29%]
tests/integration/test_card_routes.py::TestCreateCard::test_create_card_invalid_expiry_month PASSED [ 30%]
tests/integration/test_card_routes.py::TestGetCard::test_get_card_success PASSED [ 30%]
tests/integration/test_card_routes.py::TestGetCard::test_get_card_not_found PASSED [ 30%]
tests/integration/test_card_routes.py::TestGetCard::test_get_card_unauthorized PASSED [ 30%]
tests/integration/test_card_routes.py::TestListCards::test_list_cards_success PASSED [ 31%]
tests/integration/test_card_routes.py::TestListCards::test_list_cards_filter_by_type PASSED [ 31%]
tests/integration/test_card_routes.py::TestListCards::test_list_cards_unauthorized PASSED [ 31%]
tests/integration/test_card_routes.py::TestUpdateCard::test_update_card_success PASSED [ 31%]
tests/integration/test_card_routes.py::TestUpdateCard::test_update_card_not_found PASSED [ 32%]
tests/integration/test_card_routes.py::TestUpdateCard::test_update_card_unauthorized PASSED [ 32%]
tests/integration/test_card_routes.py::TestDeleteCard::test_delete_card_success PASSED [ 32%]
tests/integration/test_card_routes.py::TestDeleteCard::test_delete_card_not_found PASSED [ 32%]
tests/integration/test_card_routes.py::TestDeleteCard::test_delete_card_unauthorized PASSED [ 33%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_create_institution_success PASSED [ 33%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_create_institution_minimal_data PASSED [ 33%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_create_institution_duplicate_swift_code PASSED [ 33%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_create_institution_duplicate_routing_number PASSED [ 34%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_create_institution_invalid_swift_code PASSED [ 34%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_create_institution_invalid_routing_number PASSED [ 34%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_create_institution_non_admin_forbidden PASSED [ 34%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_create_institution_unauthenticated PASSED [ 35%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_list_institutions_success PASSED [ 35%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_list_institutions_filter_by_country PASSED [ 35%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_list_institutions_filter_by_type PASSED [ 35%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_list_institutions_search PASSED [ 36%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_list_institutions_pagination PASSED [ 36%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_list_institutions_unauthenticated PASSED [ 36%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_get_institution_by_id_success PASSED [ 36%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_get_institution_by_id_not_found PASSED [ 37%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_get_institution_by_id_unauthenticated PASSED [ 37%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_get_institution_by_swift_code_success PASSED [ 37%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_get_institution_by_swift_code_not_found PASSED [ 37%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_get_institution_by_routing_number_success PASSED [ 38%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_get_institution_by_routing_number_not_found PASSED [ 38%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_update_institution_success PASSED [ 38%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_update_institution_swift_code_conflict FAILED [ 38%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_update_institution_non_admin_forbidden PASSED [ 39%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_deactivate_institution_success FAILED [ 39%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_deactivate_institution_non_admin_forbidden FAILED [ 39%]
tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_deactivate_institution_not_found PASSED [ 39%]
tests/integration/test_metadata_routes.py::TestCurrenciesEndpoint::test_get_currencies_success PASSED [ 40%]
tests/integration/test_metadata_routes.py::TestCurrenciesEndpoint::test_get_currencies_response_structure PASSED [ 40%]
tests/integration/test_metadata_routes.py::TestCurrenciesEndpoint::test_get_currencies_has_minimum_currencies PASSED [ 40%]
tests/integration/test_metadata_routes.py::TestCurrenciesEndpoint::test_get_currencies_item_structure PASSED [ 40%]
tests/integration/test_metadata_routes.py::TestCurrenciesEndpoint::test_get_currencies_codes_are_uppercase PASSED [ 41%]
tests/integration/test_metadata_routes.py::TestCurrenciesEndpoint::test_get_currencies_contains_major_currencies PASSED [ 41%]
tests/integration/test_metadata_routes.py::TestCurrenciesEndpoint::test_get_currencies_no_duplicates PASSED [ 41%]
tests/integration/test_metadata_routes.py::TestCurrenciesEndpoint::test_get_currencies_symbols_valid_json PASSED [ 41%]
tests/integration/test_metadata_routes.py::TestMetadataEndpointsNoAuth::test_currencies_no_auth_required PASSED [ 42%]
tests/integration/test_transaction_api.py::TestTransactionAPI::test_create_transaction PASSED [ 42%]
tests/integration/test_transaction_api.py::TestTransactionAPI::test_list_transactions PASSED [ 42%]
tests/integration/test_transaction_api.py::TestTransactionAPI::test_get_transaction PASSED [ 42%]
tests/integration/test_transaction_api.py::TestTransactionAPI::test_update_transaction PASSED [ 43%]
tests/integration/test_transaction_api.py::TestTransactionAPI::test_delete_transaction FAILED [ 43%]
tests/integration/test_transaction_api.py::TestTransactionAPI::test_split_transaction FAILED [ 43%]
tests/integration/test_transaction_api.py::TestTransactionAPI::test_join_split_transaction FAILED [ 43%]
tests/integration/test_transaction_api.py::TestTransactionAPI::test_permission_denied PASSED [ 44%]
tests/integration/test_transaction_api.py::test_viewer_cannot_create_transaction PASSED [ 44%]
tests/integration/test_transaction_api.py::test_viewer_cannot_update_transaction PASSED [ 44%]
tests/integration/test_transaction_api.py::test_viewer_cannot_delete_transaction PASSED [ 44%]
tests/integration/test_transaction_api.py::test_editor_can_create_transaction PASSED [ 45%]
tests/integration/test_transaction_api.py::test_owner_has_full_access FAILED [ 45%]
tests/integration/test_transaction_api.py::test_cannot_create_transaction_with_wrong_currency PASSED [ 45%]
tests/integration/test_transaction_api.py::test_cannot_create_transaction_with_unsupported_currency PASSED [ 45%]
tests/integration/test_transaction_api.py::test_cannot_create_transaction_with_zero_amount PASSED [ 46%]
tests/integration/test_transaction_api.py::test_split_transaction_maintains_balance FAILED [ 46%]
tests/integration/test_transaction_api.py::test_cannot_split_already_split_transaction FAILED [ 46%]
tests/integration/test_transaction_api.py::test_cannot_create_transaction_in_non_member_account PASSED [ 46%]
tests/integration/test_transaction_api.py::test_cannot_access_another_users_transaction PASSED [ 47%]
tests/integration/test_transaction_api.py::TestTransactionCardIntegration::test_create_transaction_with_card PASSED [ 47%]
tests/integration/test_transaction_api.py::TestTransactionCardIntegration::test_create_transaction_without_card PASSED [ 47%]
tests/integration/test_transaction_api.py::TestTransactionCardIntegration::test_create_transaction_invalid_card_returns_404 PASSED [ 47%]
tests/integration/test_transaction_api.py::TestTransactionCardIntegration::test_get_transaction_includes_card_details PASSED [ 48%]
tests/integration/test_transaction_api.py::TestTransactionCardIntegration::test_update_transaction_add_card PASSED [ 48%]
tests/integration/test_transaction_api.py::TestTransactionCardIntegration::test_update_transaction_clear_card PASSED [ 48%]
tests/integration/test_transaction_api.py::TestTransactionCardIntegration::test_update_transaction_invalid_card_returns_404 PASSED [ 48%]
tests/integration/test_transaction_api.py::TestTransactionCardIntegration::test_list_transactions_filter_by_card_id PASSED [ 49%]
tests/integration/test_transaction_api.py::TestTransactionCardIntegration::test_list_transactions_filter_by_card_type PASSED [ 49%]
tests/integration/test_transaction_api.py::TestTransactionCardIntegration::test_list_transactions_card_type_excludes_cash PASSED [ 49%]
tests/unit/core/test_encryption.py::TestEncryptionService::test_encrypt_then_decrypt_returns_original PASSED [ 49%]
tests/unit/core/test_encryption.py::TestEncryptionService::test_encrypt_produces_different_ciphertexts PASSED [ 50%]
tests/unit/core/test_encryption.py::TestEncryptionService::test_encrypt_empty_string_returns_empty_string PASSED [ 50%]
tests/unit/core/test_encryption.py::TestEncryptionService::test_decrypt_empty_string_returns_empty_string PASSED [ 50%]
tests/unit/core/test_encryption.py::TestEncryptionService::test_decrypt_tampered_ciphertext_raises_error PASSED [ 50%]
tests/unit/core/test_encryption.py::TestEncryptionService::test_decrypt_invalid_token_raises_error PASSED [ 51%]
tests/unit/core/test_encryption.py::TestEncryptionService::test_key_derivation_is_deterministic PASSED [ 51%]
tests/unit/core/test_encryption.py::TestEncryptionService::test_encrypt_unicode_characters PASSED [ 51%]
tests/unit/core/test_encryption.py::TestEncryptionService::test_encrypt_long_string PASSED [ 51%]
tests/unit/core/test_encryption.py::TestEncryptionService::test_encrypt_special_characters PASSED [ 52%]
tests/unit/core/test_encryption.py::TestEncryptionService::test_ciphertext_is_url_safe_base64 PASSED [ 52%]
tests/unit/core/test_security.py::TestPasswordHashing::test_hash_password_returns_string PASSED [ 52%]
tests/unit/core/test_security.py::TestPasswordHashing::test_hash_password_different_for_same_password PASSED [ 52%]
tests/unit/core/test_security.py::TestPasswordHashing::test_verify_password_correct_password PASSED [ 53%]
tests/unit/core/test_security.py::TestPasswordHashing::test_verify_password_incorrect_password PASSED [ 53%]
tests/unit/core/test_security.py::TestPasswordHashing::test_verify_password_invalid_hash PASSED [ 53%]
tests/unit/core/test_security.py::TestPasswordHashing::test_verify_password_handles_verify_mismatch_error PASSED [ 53%]
tests/unit/core/test_security.py::TestPasswordHashing::test_verify_password_handles_invalid_hash_error PASSED [ 54%]
tests/unit/core/test_security.py::TestPasswordStrengthValidation::test_validate_strong_password PASSED [ 54%]
tests/unit/core/test_security.py::TestPasswordStrengthValidation::test_validate_too_short_password PASSED [ 54%]
tests/unit/core/test_security.py::TestPasswordStrengthValidation::test_validate_no_uppercase PASSED [ 54%]
tests/unit/core/test_security.py::TestPasswordStrengthValidation::test_validate_no_lowercase PASSED [ 55%]
tests/unit/core/test_security.py::TestPasswordStrengthValidation::test_validate_no_digit PASSED [ 55%]
tests/unit/core/test_security.py::TestPasswordStrengthValidation::test_validate_no_special_character PASSED [ 55%]
tests/unit/core/test_security.py::TestPasswordStrengthValidation::test_validate_all_special_characters_allowed PASSED [ 55%]
tests/unit/core/test_security.py::TestJWTAccessToken::test_create_access_token_structure PASSED [ 56%]
tests/unit/core/test_security.py::TestJWTAccessToken::test_create_access_token_default_expiration PASSED [ 56%]
tests/unit/core/test_security.py::TestJWTAccessToken::test_create_access_token_custom_expiration PASSED [ 56%]
tests/unit/core/test_security.py::TestJWTAccessToken::test_create_access_token_includes_jti PASSED [ 56%]
tests/unit/core/test_security.py::TestJWTAccessToken::test_create_access_token_preserves_custom_claims PASSED [ 57%]
tests/unit/core/test_security.py::TestJWTRefreshToken::test_create_refresh_token_structure PASSED [ 57%]
tests/unit/core/test_security.py::TestJWTRefreshToken::test_create_refresh_token_default_expiration PASSED [ 57%]
tests/unit/core/test_security.py::TestJWTRefreshToken::test_create_refresh_token_includes_jti PASSED [ 57%]
tests/unit/core/test_security.py::TestDecodeToken::test_decode_valid_token PASSED [ 58%]
tests/unit/core/test_security.py::TestDecodeToken::test_decode_invalid_token_raises_error PASSED [ 58%]
tests/unit/core/test_security.py::TestDecodeToken::test_decode_logs_jwt_errors PASSED [ 58%]
tests/unit/core/test_security.py::TestVerifyTokenType::test_verify_access_token_type PASSED [ 58%]
tests/unit/core/test_security.py::TestVerifyTokenType::test_verify_refresh_token_type PASSED [ 59%]
tests/unit/core/test_security.py::TestVerifyTokenType::test_verify_missing_type_returns_false PASSED [ 59%]
tests/unit/core/test_security.py::TestRefreshTokenHashing::test_hash_refresh_token_returns_string PASSED [ 59%]
tests/unit/core/test_security.py::TestRefreshTokenHashing::test_hash_refresh_token_deterministic PASSED [ 59%]
tests/unit/core/test_security.py::TestRefreshTokenHashing::test_hash_different_tokens_produce_different_hashes PASSED [ 60%]
tests/unit/core/test_security.py::TestRefreshTokenHashing::test_verify_refresh_token_hash_correct_token PASSED [ 60%]
tests/unit/core/test_security.py::TestRefreshTokenHashing::test_verify_refresh_token_hash_incorrect_token PASSED [ 60%]
tests/unit/core/test_security.py::TestTokenUniqueness::test_access_tokens_created_simultaneously_are_unique PASSED [ 60%]
tests/unit/core/test_security.py::TestTokenUniqueness::test_refresh_tokens_created_simultaneously_are_unique PASSED [ 61%]
tests/unit/repositories/test_account_repository.py::TestAccountRepository::test_create_account PASSED [ 61%]
tests/unit/repositories/test_account_repository.py::TestAccountRepository::test_get_by_id PASSED [ 61%]
tests/unit/repositories/test_account_repository.py::TestAccountRepository::test_get_by_user PASSED [ 61%]
tests/unit/repositories/test_account_repository.py::TestAccountRepository::test_get_by_user_with_filters FAILED [ 62%]
tests/unit/repositories/test_account_repository.py::TestAccountRepository::test_get_by_user_pagination PASSED [ 62%]
tests/unit/repositories/test_account_repository.py::TestAccountRepository::test_get_by_name PASSED [ 62%]
tests/unit/repositories/test_account_repository.py::TestAccountRepository::test_exists_by_name PASSED [ 62%]
tests/unit/repositories/test_account_repository.py::TestAccountRepository::test_exists_by_name_with_exclude PASSED [ 63%]
tests/unit/repositories/test_account_repository.py::TestAccountRepository::test_count_user_accounts FAILED [ 63%]
tests/unit/repositories/test_account_repository.py::TestAccountRepository::test_soft_delete_filtering PASSED [ 63%]
tests/unit/repositories/test_transaction_repository.py::TestTransactionRepository::test_create_transaction PASSED [ 63%]
tests/unit/repositories/test_transaction_repository.py::TestTransactionRepository::test_get_by_id PASSED [ 64%]
tests/unit/repositories/test_transaction_repository.py::TestTransactionRepository::test_get_by_account_id PASSED [ 64%]
tests/unit/repositories/test_transaction_repository.py::TestTransactionRepository::test_count_by_account_id PASSED [ 64%]
tests/unit/repositories/test_transaction_repository.py::TestTransactionRepository::test_search_by_date_range PASSED [ 64%]
tests/unit/repositories/test_transaction_repository.py::TestTransactionRepository::test_search_by_amount_range PASSED [ 65%]
tests/unit/repositories/test_transaction_repository.py::TestTransactionRepository::test_search_by_type PASSED [ 65%]
tests/unit/repositories/test_transaction_repository.py::TestTransactionRepository::test_get_children PASSED [ 65%]
tests/unit/repositories/test_transaction_repository.py::TestTransactionRepository::test_has_children PASSED [ 65%]
tests/unit/repositories/test_transaction_repository.py::TestTransactionRepository::test_calculate_account_balance PASSED [ 66%]
tests/unit/repositories/test_transaction_repository.py::TestTransactionRepository::test_get_balance_at_date PASSED [ 66%]
tests/unit/repositories/test_transaction_repository.py::TestTransactionRepository::test_soft_delete_filtering FAILED [ 66%]
tests/unit/repositories/test_transaction_repository.py::TestTransactionRepository::test_pagination PASSED [ 66%]
tests/unit/services/test_account_service.py::TestAccountService::test_create_account_success PASSED [ 67%]
tests/unit/services/test_account_service.py::TestAccountService::test_create_account_duplicate_name PASSED [ 67%]
tests/unit/services/test_account_service.py::TestAccountService::test_create_account_invalid_currency FAILED [ 67%]
tests/unit/services/test_account_service.py::TestAccountService::test_create_account_negative_balance PASSED [ 67%]
tests/unit/services/test_account_service.py::TestAccountService::test_get_account_success PASSED [ 68%]
tests/unit/services/test_account_service.py::TestAccountService::test_get_account_not_owner PASSED [ 68%]
tests/unit/services/test_account_service.py::TestAccountService::test_get_account_not_found PASSED [ 68%]
tests/unit/services/test_account_service.py::TestAccountService::test_list_accounts FAILED [ 68%]
tests/unit/services/test_account_service.py::TestAccountService::test_list_accounts_with_filters FAILED [ 69%]
tests/unit/services/test_account_service.py::TestAccountService::test_list_accounts_pagination FAILED [ 69%]
tests/unit/services/test_account_service.py::TestAccountService::test_list_accounts_limit_enforced FAILED [ 69%]
tests/unit/services/test_account_service.py::TestAccountService::test_update_account_name PASSED [ 69%]
tests/unit/services/test_account_service.py::TestAccountService::test_update_account_duplicate_name PASSED [ 70%]
tests/unit/services/test_account_service.py::TestAccountService::test_update_account_no_changes PASSED [ 70%]
tests/unit/services/test_account_service.py::TestAccountService::test_delete_account FAILED [ 70%]
tests/unit/services/test_account_service.py::TestAccountService::test_delete_account_not_owner PASSED [ 70%]
tests/unit/services/test_account_service.py::TestAccountService::test_count_user_accounts FAILED [ 71%]
tests/unit/services/test_audit_service.py::TestLogEvent::test_log_event_creates_audit_log PASSED [ 71%]
tests/unit/services/test_audit_service.py::TestLogEvent::test_log_event_with_minimal_parameters PASSED [ 71%]
tests/unit/services/test_audit_service.py::TestLogEvent::test_log_event_with_null_user_id PASSED [ 71%]
tests/unit/services/test_audit_service.py::TestLogLogin::test_log_successful_login PASSED [ 72%]
tests/unit/services/test_audit_service.py::TestLogLogin::test_log_failed_login PASSED [ 72%]
tests/unit/services/test_audit_service.py::TestLogLogout::test_log_logout PASSED [ 72%]
tests/unit/services/test_audit_service.py::TestLogPasswordChange::test_log_successful_password_change PASSED [ 72%]
tests/unit/services/test_audit_service.py::TestLogPasswordChange::test_log_failed_password_change PASSED [ 73%]
tests/unit/services/test_audit_service.py::TestLogTokenRefresh::test_log_successful_token_refresh PASSED [ 73%]
tests/unit/services/test_audit_service.py::TestLogTokenRefresh::test_log_failed_token_refresh PASSED [ 73%]
tests/unit/services/test_audit_service.py::TestLogDataChange::test_log_create_action PASSED [ 73%]
tests/unit/services/test_audit_service.py::TestLogDataChange::test_log_update_action PASSED [ 74%]
tests/unit/services/test_audit_service.py::TestLogDataChange::test_log_delete_action PASSED [ 74%]
tests/unit/services/test_audit_service.py::TestGetUserAuditLogs::test_get_user_audit_logs_with_filters PASSED [ 74%]
tests/unit/services/test_audit_service.py::TestGetUserAuditLogs::test_get_user_audit_logs_with_pagination PASSED [ 74%]
tests/unit/services/test_audit_service.py::TestGetUserAuditLogs::test_get_user_audit_logs_no_results PASSED [ 75%]
tests/unit/services/test_audit_service.py::TestGetAllAuditLogs::test_get_all_audit_logs_with_filters PASSED [ 75%]
tests/unit/services/test_audit_service.py::TestGetAllAuditLogs::test_get_all_audit_logs_no_filters PASSED [ 75%]
tests/unit/services/test_audit_service.py::TestGetAllAuditLogs::test_get_all_audit_logs_by_entity_type PASSED [ 75%]
tests/unit/services/test_auth_service.py::TestRegister::test_register_success PASSED [ 76%]
tests/unit/services/test_auth_service.py::TestRegister::test_register_email_already_exists PASSED [ 76%]
tests/unit/services/test_auth_service.py::TestRegister::test_register_username_already_exists PASSED [ 76%]
tests/unit/services/test_auth_service.py::TestLogin::test_login_success PASSED [ 76%]
tests/unit/services/test_auth_service.py::TestLogin::test_login_user_not_found PASSED [ 77%]
tests/unit/services/test_auth_service.py::TestLogin::test_login_wrong_password PASSED [ 77%]
tests/unit/services/test_auth_service.py::TestLogin::test_login_inactive_user PASSED [ 77%]
tests/unit/services/test_auth_service.py::TestRefreshAccessToken::test_refresh_token_success PASSED [ 77%]
tests/unit/services/test_auth_service.py::TestRefreshAccessToken::test_refresh_token_invalid_jwt PASSED [ 78%]
tests/unit/services/test_auth_service.py::TestRefreshAccessToken::test_refresh_token_wrong_type PASSED [ 78%]
tests/unit/services/test_auth_service.py::TestRefreshAccessToken::test_refresh_token_not_in_database PASSED [ 78%]
tests/unit/services/test_auth_service.py::TestRefreshAccessToken::test_refresh_token_reuse_detection PASSED [ 78%]
tests/unit/services/test_auth_service.py::TestRefreshAccessToken::test_refresh_token_expired PASSED [ 79%]
tests/unit/services/test_auth_service.py::TestRefreshAccessToken::test_refresh_token_inactive_user PASSED [ 79%]
tests/unit/services/test_auth_service.py::TestLogout::test_logout_success PASSED [ 79%]
tests/unit/services/test_auth_service.py::TestLogout::test_logout_invalid_jwt PASSED [ 79%]
tests/unit/services/test_auth_service.py::TestLogout::test_logout_wrong_token_type PASSED [ 80%]
tests/unit/services/test_auth_service.py::TestLogout::test_logout_token_not_found PASSED [ 80%]
tests/unit/services/test_auth_service.py::TestChangePassword::test_change_password_success PASSED [ 80%]
tests/unit/services/test_auth_service.py::TestChangePassword::test_change_password_user_not_found PASSED [ 80%]
tests/unit/services/test_auth_service.py::TestChangePassword::test_change_password_wrong_current_password PASSED [ 81%]
tests/unit/services/test_auth_service.py::TestGenerateTokens::test_generate_tokens_new_family PASSED [ 81%]
tests/unit/services/test_auth_service.py::TestGenerateTokens::test_generate_tokens_existing_family PASSED [ 81%]
tests/unit/services/test_currency_service.py::TestCurrency::test_currency_creation PASSED [ 81%]
tests/unit/services/test_currency_service.py::TestCurrency::test_currency_create_factory PASSED [ 82%]
tests/unit/services/test_currency_service.py::TestCurrency::test_currency_is_frozen PASSED [ 82%]
tests/unit/services/test_currency_service.py::TestCurrency::test_currency_validation PASSED [ 82%]
tests/unit/services/test_currency_service.py::TestCurrencyService::test_service_instantiation_without_session PASSED [ 82%]
tests/unit/services/test_currency_service.py::TestCurrencyService::test_service_instantiation_with_session PASSED [ 83%]
tests/unit/services/test_currency_service.py::TestCurrencyService::test_multiple_instances_are_different PASSED [ 83%]
tests/unit/services/test_currency_service.py::TestCurrencyService::test_get_all_returns_currencies PASSED [ 83%]
tests/unit/services/test_currency_service.py::TestCurrencyService::test_get_all_returns_copy PASSED [ 83%]
tests/unit/services/test_currency_service.py::TestCurrencyService::test_all_currencies_have_required_fields PASSED [ 84%]
tests/unit/services/test_currency_service.py::TestCurrencyService::test_no_duplicate_currency_codes PASSED [ 84%]
tests/unit/services/test_currency_service.py::TestCurrencyService::test_get_by_code_found PASSED [ 84%]
tests/unit/services/test_currency_service.py::TestCurrencyService::test_get_by_code_case_insensitive PASSED [ 84%]
tests/unit/services/test_currency_service.py::TestCurrencyService::test_get_by_code_not_found PASSED [ 85%]
tests/unit/services/test_currency_service.py::TestCurrencyService::test_is_supported_true PASSED [ 85%]
tests/unit/services/test_currency_service.py::TestCurrencyService::test_is_supported_case_insensitive PASSED [ 85%]
tests/unit/services/test_currency_service.py::TestCurrencyService::test_is_supported_false PASSED [ 85%]
tests/unit/services/test_currency_service.py::TestCurrencyService::test_specific_currencies_exist PASSED [ 86%]
tests/unit/services/test_currency_service.py::TestCurrencyService::test_currency_symbols_are_valid_utf8 PASSED [ 86%]
tests/unit/services/test_currency_service.py::TestCurrencyService::test_get_supported_codes PASSED [ 86%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceCreate::test_create_transaction_success PASSED [ 86%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceCreate::test_create_transaction_updates_balance PASSED [ 87%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceCreate::test_create_transaction_currency_mismatch PASSED [ 87%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceCreate::test_create_transaction_zero_amount PASSED [ 87%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceCreate::test_create_transaction_permission_denied PASSED [ 87%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceRead::test_get_transaction_success PASSED [ 88%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceRead::test_get_transaction_not_found PASSED [ 88%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceRead::test_get_transaction_permission_denied PASSED [ 88%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceRead::test_search_transactions PASSED [ 88%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceUpdate::test_update_transaction_success PASSED [ 89%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceUpdate::test_update_transaction_balance_delta PASSED [ 89%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceUpdate::test_update_transaction_zero_amount PASSED [ 89%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceUpdate::test_update_transaction_permission_denied PASSED [ 89%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceDelete::test_delete_transaction_success FAILED [ 90%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceDelete::test_delete_transaction_updates_balance FAILED [ 90%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceDelete::test_delete_parent_deletes_children FAILED [ 90%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceSplit::test_split_transaction_success PASSED [ 90%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceSplit::test_split_transaction_amounts_must_sum PASSED [ 91%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceSplit::test_split_requires_minimum_two_splits PASSED [ 91%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceSplit::test_cannot_split_child_transaction PASSED [ 91%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceSplit::test_join_split_transaction FAILED [ 91%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceSplit::test_join_requires_splits PASSED [ 92%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceCardValidation::test_create_transaction_with_valid_card PASSED [ 92%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceCardValidation::test_create_transaction_without_card PASSED [ 92%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceCardValidation::test_create_transaction_with_invalid_card_raises_not_found PASSED [ 92%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceCardValidation::test_create_transaction_with_other_users_card_raises_not_found FAILED [ 93%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceCardValidation::test_update_transaction_card_id PASSED [ 93%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceCardValidation::test_update_transaction_clear_card PASSED [ 93%]
tests/unit/services/test_transaction_service.py::TestTransactionServiceCardValidation::test_update_transaction_invalid_card_raises_not_found PASSED [ 93%]
tests/unit/services/test_user_service.py::TestGetUserProfile::test_get_own_profile PASSED [ 94%]
tests/unit/services/test_user_service.py::TestGetUserProfile::test_admin_view_other_profile PASSED [ 94%]
tests/unit/services/test_user_service.py::TestGetUserProfile::test_user_cannot_view_other_profile PASSED [ 94%]
tests/unit/services/test_user_service.py::TestGetUserProfile::test_get_profile_user_not_found PASSED [ 94%]
tests/unit/services/test_user_service.py::TestUpdateUserProfile::test_update_own_profile PASSED [ 95%]
tests/unit/services/test_user_service.py::TestUpdateUserProfile::test_update_email_uniqueness_check PASSED [ 95%]
tests/unit/services/test_user_service.py::TestUpdateUserProfile::test_update_username_uniqueness_check PASSED [ 95%]
tests/unit/services/test_user_service.py::TestUpdateUserProfile::test_admin_update_other_profile PASSED [ 95%]
tests/unit/services/test_user_service.py::TestUpdateUserProfile::test_user_cannot_update_other_profile PASSED [ 96%]
tests/unit/services/test_user_service.py::TestUpdateUserProfile::test_update_profile_user_not_found PASSED [ 96%]
tests/unit/services/test_user_service.py::TestListUsers::test_list_users_as_admin PASSED [ 96%]
tests/unit/services/test_user_service.py::TestListUsers::test_list_users_with_filters PASSED [ 96%]
tests/unit/services/test_user_service.py::TestListUsers::test_list_users_not_admin PASSED [ 97%]
tests/unit/services/test_user_service.py::TestDeactivateUser::test_deactivate_user_as_admin FAILED [ 97%]
tests/unit/services/test_user_service.py::TestDeactivateUser::test_deactivate_user_not_admin PASSED [ 97%]
tests/unit/services/test_user_service.py::TestDeactivateUser::test_deactivate_user_not_found PASSED [ 97%]
tests/unit/services/test_user_service.py::TestSoftDeleteUser::test_soft_delete_user_as_admin PASSED [ 98%]
tests/unit/services/test_user_service.py::TestSoftDeleteUser::test_soft_delete_user_not_admin PASSED [ 98%]
tests/unit/services/test_user_service.py::TestSoftDeleteUser::test_soft_delete_user_not_found PASSED [ 98%]
tests/unit/test_enums.py::TestTransactionType::test_transaction_type_values PASSED [ 98%]
tests/unit/test_enums.py::TestTransactionType::test_transaction_type_count PASSED [ 99%]
tests/unit/test_enums.py::TestTransactionType::test_transaction_type_to_dict_list PASSED [ 99%]
tests/unit/test_enums.py::TestTransactionType::test_transaction_type_string_enum PASSED [ 99%]
tests/unit/test_enums.py::TestTransactionType::test_transaction_type_iteration PASSED [ 99%]
tests/unit/test_enums.py::TestTransactionType::test_transaction_type_dict_list_format PASSED [100%]

=================================== FAILURES ===================================
_________________ test_account_sharing_collaboration_workflow __________________
tests/e2e/test_collaboration_workflow.py:110: in test_account_sharing_collaboration_workflow
    account_names = [acc["account_name"] for acc in b_accounts]
                     ^^^^^^^^^^^^^^^^^^^
E   TypeError: string indices must be integers, not 'str'
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:02,035", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:02,035", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:02,035", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:02,338", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:02,537", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 134, "funcName": "register", "message": "User registered successfully: afe03d48-ccdd-409d-8fbb-9b4c6541d2df (usera@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:02,585", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=afe03d48-ccdd-409d-8fbb-9b4c6541d2df, action=CREATE, entity=user:afe03d48-ccdd-409d-8fbb-9b4c6541d2df, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:02,588", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 113, "funcName": "register", "message": "User registered: afe03d48-ccdd-409d-8fbb-9b4c6541d2df (usera@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:02,589", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/register 201 - request_id=unknown client=127.0.0.1 duration=0.128s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:02,590", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/register \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:02,648", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: afe03d48-ccdd-409d-8fbb-9b4c6541d2df (usera@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:02,685", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=afe03d48-ccdd-409d-8fbb-9b4c6541d2df, action=LOGIN, entity=user:afe03d48-ccdd-409d-8fbb-9b4c6541d2df, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:02,687", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: afe03d48-ccdd-409d-8fbb-9b4c6541d2df (usera@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:02,688", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.097s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:02,688", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:02,741", "name": "src.core.encryption", "levelname": "INFO", "filename": "encryption.py", "lineno": 64, "funcName": "__init__", "message": "Encryption service initialized successfully", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:02,783", "name": "src.services.account_service", "levelname": "INFO", "filename": "account_service.py", "lineno": 217, "funcName": "create_account", "message": "Created account 5ad0dbb0-37ae-427a-a7e3-eae3a5032e2a (Shared Savings) for user afe03d48-ccdd-409d-8fbb-9b4c6541d2df", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:02,791", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=afe03d48-ccdd-409d-8fbb-9b4c6541d2df, action=CREATE, entity=account:5ad0dbb0-37ae-427a-a7e3-eae3a5032e2a, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:02,793", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/accounts 201 - request_id=unknown client=127.0.0.1 duration=0.104s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:02,797", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/accounts \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
 Step 1: User A created savings account ($5000.00)
{"asctime": "2025-12-14 19:21:02,851", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 134, "funcName": "register", "message": "User registered successfully: cd3aec49-d026-460a-b405-a297506ca1b2 (userb@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:02,888", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=cd3aec49-d026-460a-b405-a297506ca1b2, action=CREATE, entity=user:cd3aec49-d026-460a-b405-a297506ca1b2, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:02,890", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 113, "funcName": "register", "message": "User registered: cd3aec49-d026-460a-b405-a297506ca1b2 (userb@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:02,891", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/register 201 - request_id=unknown client=127.0.0.1 duration=0.093s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:02,892", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/register \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:02,944", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: cd3aec49-d026-460a-b405-a297506ca1b2 (userb@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:02,980", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=cd3aec49-d026-460a-b405-a297506ca1b2, action=LOGIN, entity=user:cd3aec49-d026-460a-b405-a297506ca1b2, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:02,983", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: cd3aec49-d026-460a-b405-a297506ca1b2 (userb@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:02,983", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.091s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:02,984", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:03,034", "name": "src.core.encryption", "levelname": "INFO", "filename": "encryption.py", "lineno": 64, "funcName": "__init__", "message": "Encryption service initialized successfully", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:03,078", "name": "src.services.account_service", "levelname": "INFO", "filename": "account_service.py", "lineno": 732, "funcName": "share_account", "message": "User afe03d48-ccdd-409d-8fbb-9b4c6541d2df shared account 5ad0dbb0-37ae-427a-a7e3-eae3a5032e2a with user cd3aec49-d026-460a-b405-a297506ca1b2 (editor)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:03,085", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=afe03d48-ccdd-409d-8fbb-9b4c6541d2df, action=CREATE, entity=account_share:5c388f5b-9a2a-4d9e-a01d-312f27982a95, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:03,085", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/accounts/5ad0dbb0-37ae-427a-a7e3-eae3a5032e2a/shares 201 - request_id=unknown client=127.0.0.1 duration=0.101s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:03,088", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/accounts/5ad0dbb0-37ae-427a-a7e3-eae3a5032e2a/shares \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
 Step 2: User A shared account with User B (EDITOR)
{"asctime": "2025-12-14 19:21:03,137", "name": "src.core.encryption", "levelname": "INFO", "filename": "encryption.py", "lineno": 64, "funcName": "__init__", "message": "Encryption service initialized successfully", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:03,172", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "GET /api/v1/accounts 200 - request_id=unknown client=127.0.0.1 duration=0.083s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:03,175", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: GET http://test/api/v1/accounts \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/register "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/accounts "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/register "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/accounts/5ad0dbb0-37ae-427a-a7e3-eae3a5032e2a/shares "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: GET http://test/api/v1/accounts "HTTP/1.1 200 OK"
__________________ test_shared_account_transaction_visibility __________________
tests/e2e/test_collaboration_workflow.py:410: in test_shared_account_transaction_visibility
    assert sharer_txns.json()["total"] == viewer_txns.json()["total"]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   KeyError: 'total'
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:04,332", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:04,486", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 134, "funcName": "register", "message": "User registered successfully: 0da6ce64-98c9-48cd-a198-b338a18ccdfd (sharer@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,519", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=0da6ce64-98c9-48cd-a198-b338a18ccdfd, action=CREATE, entity=user:0da6ce64-98c9-48cd-a198-b338a18ccdfd, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,532", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 113, "funcName": "register", "message": "User registered: 0da6ce64-98c9-48cd-a198-b338a18ccdfd (sharer@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,532", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/register 201 - request_id=unknown client=127.0.0.1 duration=0.097s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,533", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/register \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,582", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 0da6ce64-98c9-48cd-a198-b338a18ccdfd (sharer@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,615", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=0da6ce64-98c9-48cd-a198-b338a18ccdfd, action=LOGIN, entity=user:0da6ce64-98c9-48cd-a198-b338a18ccdfd, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,623", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 0da6ce64-98c9-48cd-a198-b338a18ccdfd (sharer@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,624", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.091s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,625", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,676", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 134, "funcName": "register", "message": "User registered successfully: 56091e6e-5e7a-46a9-b36e-f1acf3888377 (viewer@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,708", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=56091e6e-5e7a-46a9-b36e-f1acf3888377, action=CREATE, entity=user:56091e6e-5e7a-46a9-b36e-f1acf3888377, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,710", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 113, "funcName": "register", "message": "User registered: 56091e6e-5e7a-46a9-b36e-f1acf3888377 (viewer@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,711", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/register 201 - request_id=unknown client=127.0.0.1 duration=0.085s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,711", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/register \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,760", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 56091e6e-5e7a-46a9-b36e-f1acf3888377 (viewer@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,794", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=56091e6e-5e7a-46a9-b36e-f1acf3888377, action=LOGIN, entity=user:56091e6e-5e7a-46a9-b36e-f1acf3888377, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,797", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 56091e6e-5e7a-46a9-b36e-f1acf3888377 (viewer@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,797", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.085s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,797", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,846", "name": "src.core.encryption", "levelname": "INFO", "filename": "encryption.py", "lineno": 64, "funcName": "__init__", "message": "Encryption service initialized successfully", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,872", "name": "src.services.account_service", "levelname": "INFO", "filename": "account_service.py", "lineno": 217, "funcName": "create_account", "message": "Created account 5086464c-d96b-4960-b803-f4d07deebbd3 (Visibility Test) for user 0da6ce64-98c9-48cd-a198-b338a18ccdfd", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,878", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=0da6ce64-98c9-48cd-a198-b338a18ccdfd, action=CREATE, entity=account:5086464c-d96b-4960-b803-f4d07deebbd3, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,879", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/accounts 201 - request_id=unknown client=127.0.0.1 duration=0.081s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,882", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/accounts \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,946", "name": "src.services.transaction_service", "levelname": "INFO", "filename": "transaction_service.py", "lineno": 232, "funcName": "create_transaction", "message": "Created transaction f6757fc7-c5a0-477a-85ed-8da0b58dd194 for account 5086464c-d96b-4960-b803-f4d07deebbd3, updated balance: 1000.00 -> 990.00", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,957", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=0da6ce64-98c9-48cd-a198-b338a18ccdfd, action=CREATE, entity=transaction:f6757fc7-c5a0-477a-85ed-8da0b58dd194, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,958", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/accounts/5086464c-d96b-4960-b803-f4d07deebbd3/transactions 201 - request_id=unknown client=127.0.0.1 duration=0.076s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:04,961", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/accounts/5086464c-d96b-4960-b803-f4d07deebbd3/transactions \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:05,021", "name": "src.services.transaction_service", "levelname": "INFO", "filename": "transaction_service.py", "lineno": 232, "funcName": "create_transaction", "message": "Created transaction 3e7e8618-6ced-49dd-bf02-8c5d7aa0c745 for account 5086464c-d96b-4960-b803-f4d07deebbd3, updated balance: 990.00 -> 970.00", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:05,029", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=0da6ce64-98c9-48cd-a198-b338a18ccdfd, action=CREATE, entity=transaction:3e7e8618-6ced-49dd-bf02-8c5d7aa0c745, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:05,030", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/accounts/5086464c-d96b-4960-b803-f4d07deebbd3/transactions 201 - request_id=unknown client=127.0.0.1 duration=0.069s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:05,033", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/accounts/5086464c-d96b-4960-b803-f4d07deebbd3/transactions \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:05,095", "name": "src.services.transaction_service", "levelname": "INFO", "filename": "transaction_service.py", "lineno": 232, "funcName": "create_transaction", "message": "Created transaction 499b751a-6740-4323-948b-73e88f07cb65 for account 5086464c-d96b-4960-b803-f4d07deebbd3, updated balance: 970.00 -> 940.00", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:05,104", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=0da6ce64-98c9-48cd-a198-b338a18ccdfd, action=CREATE, entity=transaction:499b751a-6740-4323-948b-73e88f07cb65, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:05,105", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/accounts/5086464c-d96b-4960-b803-f4d07deebbd3/transactions 201 - request_id=unknown client=127.0.0.1 duration=0.072s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:05,108", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/accounts/5086464c-d96b-4960-b803-f4d07deebbd3/transactions \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:05,159", "name": "src.core.encryption", "levelname": "INFO", "filename": "encryption.py", "lineno": 64, "funcName": "__init__", "message": "Encryption service initialized successfully", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:05,198", "name": "src.services.account_service", "levelname": "INFO", "filename": "account_service.py", "lineno": 732, "funcName": "share_account", "message": "User 0da6ce64-98c9-48cd-a198-b338a18ccdfd shared account 5086464c-d96b-4960-b803-f4d07deebbd3 with user 56091e6e-5e7a-46a9-b36e-f1acf3888377 (viewer)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:05,205", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=0da6ce64-98c9-48cd-a198-b338a18ccdfd, action=CREATE, entity=account_share:11bb78d6-d811-486f-8bbf-a0617487f3d1, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:05,206", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/accounts/5086464c-d96b-4960-b803-f4d07deebbd3/shares 201 - request_id=unknown client=127.0.0.1 duration=0.097s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:05,209", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/accounts/5086464c-d96b-4960-b803-f4d07deebbd3/shares \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:05,280", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "GET /api/v1/accounts/5086464c-d96b-4960-b803-f4d07deebbd3/transactions 200 - request_id=unknown client=127.0.0.1 duration=0.070s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:05,283", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: GET http://test/api/v1/accounts/5086464c-d96b-4960-b803-f4d07deebbd3/transactions \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:05,351", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "GET /api/v1/accounts/5086464c-d96b-4960-b803-f4d07deebbd3/transactions 200 - request_id=unknown client=127.0.0.1 duration=0.068s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:05,354", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: GET http://test/api/v1/accounts/5086464c-d96b-4960-b803-f4d07deebbd3/transactions \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/register "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/register "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/accounts "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/accounts/5086464c-d96b-4960-b803-f4d07deebbd3/transactions "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/accounts/5086464c-d96b-4960-b803-f4d07deebbd3/transactions "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/accounts/5086464c-d96b-4960-b803-f4d07deebbd3/transactions "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/accounts/5086464c-d96b-4960-b803-f4d07deebbd3/shares "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: GET http://test/api/v1/accounts/5086464c-d96b-4960-b803-f4d07deebbd3/transactions "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: GET http://test/api/v1/accounts/5086464c-d96b-4960-b803-f4d07deebbd3/transactions "HTTP/1.1 200 OK"
___________ test_new_user_creates_multiple_accounts_and_transactions ___________
tests/e2e/test_user_journey.py:276: in test_new_user_creates_multiple_accounts_and_transactions
    assert checking_txns.json()["total"] == 3
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   KeyError: 'total'
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:08,527", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:08,679", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 134, "funcName": "register", "message": "User registered successfully: 0335248b-ca63-4326-8478-0b9c685de65e (multi@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:08,712", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=0335248b-ca63-4326-8478-0b9c685de65e, action=CREATE, entity=user:0335248b-ca63-4326-8478-0b9c685de65e, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:08,714", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 113, "funcName": "register", "message": "User registered: 0335248b-ca63-4326-8478-0b9c685de65e (multi@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:08,714", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/register 201 - request_id=unknown client=127.0.0.1 duration=0.086s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:08,715", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/register \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:08,763", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 0335248b-ca63-4326-8478-0b9c685de65e (multi@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:08,797", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=0335248b-ca63-4326-8478-0b9c685de65e, action=LOGIN, entity=user:0335248b-ca63-4326-8478-0b9c685de65e, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:08,800", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 0335248b-ca63-4326-8478-0b9c685de65e (multi@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:08,800", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.085s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:08,801", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:08,848", "name": "src.core.encryption", "levelname": "INFO", "filename": "encryption.py", "lineno": 64, "funcName": "__init__", "message": "Encryption service initialized successfully", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:08,874", "name": "src.services.account_service", "levelname": "INFO", "filename": "account_service.py", "lineno": 217, "funcName": "create_account", "message": "Created account 03ff74ed-964a-4a40-8bae-0442f8637eb2 (Checking) for user 0335248b-ca63-4326-8478-0b9c685de65e", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:08,881", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=0335248b-ca63-4326-8478-0b9c685de65e, action=CREATE, entity=account:03ff74ed-964a-4a40-8bae-0442f8637eb2, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:08,881", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/accounts 201 - request_id=unknown client=127.0.0.1 duration=0.080s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:08,884", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/accounts \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:08,932", "name": "src.core.encryption", "levelname": "INFO", "filename": "encryption.py", "lineno": 64, "funcName": "__init__", "message": "Encryption service initialized successfully", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:08,958", "name": "src.services.account_service", "levelname": "INFO", "filename": "account_service.py", "lineno": 217, "funcName": "create_account", "message": "Created account 61321b16-720d-4807-b52e-3ce975d5f9f2 (Savings) for user 0335248b-ca63-4326-8478-0b9c685de65e", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:08,965", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=0335248b-ca63-4326-8478-0b9c685de65e, action=CREATE, entity=account:61321b16-720d-4807-b52e-3ce975d5f9f2, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:08,965", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/accounts 201 - request_id=unknown client=127.0.0.1 duration=0.080s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:08,968", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/accounts \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:09,026", "name": "src.services.transaction_service", "levelname": "INFO", "filename": "transaction_service.py", "lineno": 232, "funcName": "create_transaction", "message": "Created transaction 3adddc0b-4ef7-476a-9be8-e98b67981027 for account 03ff74ed-964a-4a40-8bae-0442f8637eb2, updated balance: 500.00 -> 490.00", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:09,034", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=0335248b-ca63-4326-8478-0b9c685de65e, action=CREATE, entity=transaction:3adddc0b-4ef7-476a-9be8-e98b67981027, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:09,036", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/accounts/03ff74ed-964a-4a40-8bae-0442f8637eb2/transactions 201 - request_id=unknown client=127.0.0.1 duration=0.067s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:09,040", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/accounts/03ff74ed-964a-4a40-8bae-0442f8637eb2/transactions \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:09,099", "name": "src.services.transaction_service", "levelname": "INFO", "filename": "transaction_service.py", "lineno": 232, "funcName": "create_transaction", "message": "Created transaction 1336dd0e-fe5c-45d6-b21a-3a9dbf8c4ba6 for account 03ff74ed-964a-4a40-8bae-0442f8637eb2, updated balance: 490.00 -> 475.00", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:09,107", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=0335248b-ca63-4326-8478-0b9c685de65e, action=CREATE, entity=transaction:1336dd0e-fe5c-45d6-b21a-3a9dbf8c4ba6, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:09,109", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/accounts/03ff74ed-964a-4a40-8bae-0442f8637eb2/transactions 201 - request_id=unknown client=127.0.0.1 duration=0.068s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:09,112", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/accounts/03ff74ed-964a-4a40-8bae-0442f8637eb2/transactions \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:09,170", "name": "src.services.transaction_service", "levelname": "INFO", "filename": "transaction_service.py", "lineno": 232, "funcName": "create_transaction", "message": "Created transaction 261a3b4a-2f4b-4880-916e-5f18927fa655 for account 03ff74ed-964a-4a40-8bae-0442f8637eb2, updated balance: 475.00 -> 455.00", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:09,177", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=0335248b-ca63-4326-8478-0b9c685de65e, action=CREATE, entity=transaction:261a3b4a-2f4b-4880-916e-5f18927fa655, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:09,178", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/accounts/03ff74ed-964a-4a40-8bae-0442f8637eb2/transactions 201 - request_id=unknown client=127.0.0.1 duration=0.065s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:09,181", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/accounts/03ff74ed-964a-4a40-8bae-0442f8637eb2/transactions \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:09,240", "name": "src.services.transaction_service", "levelname": "INFO", "filename": "transaction_service.py", "lineno": 232, "funcName": "create_transaction", "message": "Created transaction 83466992-9dd8-48c6-bc08-3d7fdc05adb4 for account 61321b16-720d-4807-b52e-3ce975d5f9f2, updated balance: 5000.00 -> 5100.00", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:09,247", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=0335248b-ca63-4326-8478-0b9c685de65e, action=CREATE, entity=transaction:83466992-9dd8-48c6-bc08-3d7fdc05adb4, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:09,248", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/accounts/61321b16-720d-4807-b52e-3ce975d5f9f2/transactions 201 - request_id=unknown client=127.0.0.1 duration=0.066s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:09,251", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/accounts/61321b16-720d-4807-b52e-3ce975d5f9f2/transactions \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:09,299", "name": "src.core.encryption", "levelname": "INFO", "filename": "encryption.py", "lineno": 64, "funcName": "__init__", "message": "Encryption service initialized successfully", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:09,326", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "GET /api/v1/accounts 200 - request_id=unknown client=127.0.0.1 duration=0.075s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:09,328", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: GET http://test/api/v1/accounts \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:09,388", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "GET /api/v1/accounts/03ff74ed-964a-4a40-8bae-0442f8637eb2/transactions 200 - request_id=unknown client=127.0.0.1 duration=0.059s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:09,390", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: GET http://test/api/v1/accounts/03ff74ed-964a-4a40-8bae-0442f8637eb2/transactions \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/register "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/accounts "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/accounts "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/accounts/03ff74ed-964a-4a40-8bae-0442f8637eb2/transactions "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/accounts/03ff74ed-964a-4a40-8bae-0442f8637eb2/transactions "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/accounts/03ff74ed-964a-4a40-8bae-0442f8637eb2/transactions "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/accounts/61321b16-720d-4807-b52e-3ce975d5f9f2/transactions "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: GET http://test/api/v1/accounts "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: GET http://test/api/v1/accounts/03ff74ed-964a-4a40-8bae-0442f8637eb2/transactions "HTTP/1.1 200 OK"
___________________ test_transaction_split_and_join_workflow ___________________
tests/e2e/test_user_journey.py:399: in test_transaction_split_and_join_workflow
    assert "child_transactions" in get_response.json()
E   AssertionError: assert 'child_transactions' in {'account_id': 'f76414fd-4ef5-4ec8-b7ea-e22b8f27acb4', 'amount': '-100.00', 'card': None, 'card_id': None, ...}
E    +  where {'account_id': 'f76414fd-4ef5-4ec8-b7ea-e22b8f27acb4', 'amount': '-100.00', 'card': None, 'card_id': None, ...} = json()
E    +    where json = <Response [200 OK]>.json
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:09,816", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:09,965", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 134, "funcName": "register", "message": "User registered successfully: 9dc1e262-8438-48bd-9eb8-bf302a30c2e0 (splitter@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:09,998", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=9dc1e262-8438-48bd-9eb8-bf302a30c2e0, action=CREATE, entity=user:9dc1e262-8438-48bd-9eb8-bf302a30c2e0, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,001", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 113, "funcName": "register", "message": "User registered: 9dc1e262-8438-48bd-9eb8-bf302a30c2e0 (splitter@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,001", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/register 201 - request_id=unknown client=127.0.0.1 duration=0.086s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,002", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/register \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,052", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 9dc1e262-8438-48bd-9eb8-bf302a30c2e0 (splitter@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,085", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=9dc1e262-8438-48bd-9eb8-bf302a30c2e0, action=LOGIN, entity=user:9dc1e262-8438-48bd-9eb8-bf302a30c2e0, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,088", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 9dc1e262-8438-48bd-9eb8-bf302a30c2e0 (splitter@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,093", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.091s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,098", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,149", "name": "src.core.encryption", "levelname": "INFO", "filename": "encryption.py", "lineno": 64, "funcName": "__init__", "message": "Encryption service initialized successfully", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,178", "name": "src.services.account_service", "levelname": "INFO", "filename": "account_service.py", "lineno": 217, "funcName": "create_account", "message": "Created account f76414fd-4ef5-4ec8-b7ea-e22b8f27acb4 (Split Account) for user 9dc1e262-8438-48bd-9eb8-bf302a30c2e0", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,185", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=9dc1e262-8438-48bd-9eb8-bf302a30c2e0, action=CREATE, entity=account:f76414fd-4ef5-4ec8-b7ea-e22b8f27acb4, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,185", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/accounts 201 - request_id=unknown client=127.0.0.1 duration=0.087s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,188", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/accounts \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,250", "name": "src.services.transaction_service", "levelname": "INFO", "filename": "transaction_service.py", "lineno": 232, "funcName": "create_transaction", "message": "Created transaction 3916aef1-ea46-474a-9ffd-a9934af11e9b for account f76414fd-4ef5-4ec8-b7ea-e22b8f27acb4, updated balance: 1000.00 -> 900.00", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,258", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=9dc1e262-8438-48bd-9eb8-bf302a30c2e0, action=CREATE, entity=transaction:3916aef1-ea46-474a-9ffd-a9934af11e9b, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,259", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/accounts/f76414fd-4ef5-4ec8-b7ea-e22b8f27acb4/transactions 201 - request_id=unknown client=127.0.0.1 duration=0.070s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,262", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/accounts/f76414fd-4ef5-4ec8-b7ea-e22b8f27acb4/transactions \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,367", "name": "src.services.transaction_service", "levelname": "INFO", "filename": "transaction_service.py", "lineno": 901, "funcName": "split_transaction", "message": "Split transaction 3916aef1-ea46-474a-9ffd-a9934af11e9b into 2 children", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,377", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=9dc1e262-8438-48bd-9eb8-bf302a30c2e0, action=SPLIT_TRANSACTION, entity=transaction:3916aef1-ea46-474a-9ffd-a9934af11e9b, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,380", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/transactions/3916aef1-ea46-474a-9ffd-a9934af11e9b/split 200 - request_id=unknown client=127.0.0.1 duration=0.118s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,385", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/transactions/3916aef1-ea46-474a-9ffd-a9934af11e9b/split \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,450", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "GET /api/v1/transactions/3916aef1-ea46-474a-9ffd-a9934af11e9b 200 - request_id=unknown client=127.0.0.1 duration=0.065s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,453", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: GET http://test/api/v1/transactions/3916aef1-ea46-474a-9ffd-a9934af11e9b \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/register "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/accounts "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/accounts/f76414fd-4ef5-4ec8-b7ea-e22b8f27acb4/transactions "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/transactions/3916aef1-ea46-474a-9ffd-a9934af11e9b/split "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: GET http://test/api/v1/transactions/3916aef1-ea46-474a-9ffd-a9934af11e9b "HTTP/1.1 200 OK"
_______________________ test_account_lifecycle_workflow ________________________
tests/e2e/test_user_journey.py:469: in test_account_lifecycle_workflow
    assert deactivate_response.status_code == 200
E   assert 422 == 200
E    +  where 422 = <Response [422 Unprocessable Entity]>.status_code
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:10,556", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:10,712", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 134, "funcName": "register", "message": "User registered successfully: c6b0bb7a-6504-47b8-8981-674ec520f013 (lifecycle@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,746", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=c6b0bb7a-6504-47b8-8981-674ec520f013, action=CREATE, entity=user:c6b0bb7a-6504-47b8-8981-674ec520f013, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,749", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 113, "funcName": "register", "message": "User registered: c6b0bb7a-6504-47b8-8981-674ec520f013 (lifecycle@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,749", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/register 201 - request_id=unknown client=127.0.0.1 duration=0.090s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,750", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/register \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,800", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: c6b0bb7a-6504-47b8-8981-674ec520f013 (lifecycle@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,840", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=c6b0bb7a-6504-47b8-8981-674ec520f013, action=LOGIN, entity=user:c6b0bb7a-6504-47b8-8981-674ec520f013, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,843", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: c6b0bb7a-6504-47b8-8981-674ec520f013 (lifecycle@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,843", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.093s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,844", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,902", "name": "src.core.encryption", "levelname": "INFO", "filename": "encryption.py", "lineno": 64, "funcName": "__init__", "message": "Encryption service initialized successfully", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,931", "name": "src.services.account_service", "levelname": "INFO", "filename": "account_service.py", "lineno": 217, "funcName": "create_account", "message": "Created account 60e6a189-aebc-4ad3-a2e3-646d6d27708a (Lifecycle Account) for user c6b0bb7a-6504-47b8-8981-674ec520f013", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,938", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=c6b0bb7a-6504-47b8-8981-674ec520f013, action=CREATE, entity=account:60e6a189-aebc-4ad3-a2e3-646d6d27708a, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,939", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/accounts 201 - request_id=unknown client=127.0.0.1 duration=0.094s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,942", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/accounts \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:10,990", "name": "src.core.encryption", "levelname": "INFO", "filename": "encryption.py", "lineno": 64, "funcName": "__init__", "message": "Encryption service initialized successfully", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:11,026", "name": "src.services.account_service", "levelname": "INFO", "filename": "account_service.py", "lineno": 537, "funcName": "update_account", "message": "Updated account 60e6a189-aebc-4ad3-a2e3-646d6d27708a: {'account_name': {'old': 'Lifecycle Account', 'new': 'Updated Lifecycle Account'}}", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:11,032", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=c6b0bb7a-6504-47b8-8981-674ec520f013, action=UPDATE, entity=account:60e6a189-aebc-4ad3-a2e3-646d6d27708a, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:11,033", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "PUT /api/v1/accounts/60e6a189-aebc-4ad3-a2e3-646d6d27708a 200 - request_id=unknown client=127.0.0.1 duration=0.090s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:11,037", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: PUT http://test/api/v1/accounts/60e6a189-aebc-4ad3-a2e3-646d6d27708a \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:11,084", "name": "src.core.encryption", "levelname": "INFO", "filename": "encryption.py", "lineno": 64, "funcName": "__init__", "message": "Encryption service initialized successfully", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:11,087", "name": "src.main", "levelname": "WARNING", "filename": "main.py", "lineno": 162, "funcName": "validation_exception_handler", "message": "Validation error: [{'type': 'missing', 'loc': ('body',), 'msg': 'Field required', 'input': None}] (request_id=05b8028a-6d62-4dac-9896-c673679fb8f9)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:11,087", "name": "src.middleware", "levelname": "WARNING", "filename": "middleware.py", "lineno": 208, "funcName": "dispatch", "message": "PUT /api/v1/accounts/60e6a189-aebc-4ad3-a2e3-646d6d27708a 422 - request_id=unknown client=127.0.0.1 duration=0.050s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:11,087", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: PUT http://test/api/v1/accounts/60e6a189-aebc-4ad3-a2e3-646d6d27708a \"HTTP/1.1 422 Unprocessable Entity\"", "correlation_id": "no-request-id"}
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/register "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/accounts "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: PUT http://test/api/v1/accounts/60e6a189-aebc-4ad3-a2e3-646d6d27708a "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: PUT http://test/api/v1/accounts/60e6a189-aebc-4ad3-a2e3-646d6d27708a "HTTP/1.1 422 Unprocessable Entity"
_________ TestAccountRoutes.test_create_account_inactive_account_type __________
tests/integration/test_account_routes.py:733: in test_create_account_inactive_account_type
    assert response.status_code == 422  # Validation error from service
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   assert 201 == 422
E    +  where 201 = <Response [201 Created]>.status_code
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:22,202", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:22,336", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: b55395cf-b50a-488d-b57f-aeed880a50b2 (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:22,369", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=b55395cf-b50a-488d-b57f-aeed880a50b2, action=LOGIN, entity=user:b55395cf-b50a-488d-b57f-aeed880a50b2, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:22,372", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: b55395cf-b50a-488d-b57f-aeed880a50b2 (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:22,372", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.085s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:22,372", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:22,524", "name": "src.core.encryption", "levelname": "INFO", "filename": "encryption.py", "lineno": 64, "funcName": "__init__", "message": "Encryption service initialized successfully", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:22,549", "name": "src.services.account_service", "levelname": "INFO", "filename": "account_service.py", "lineno": 217, "funcName": "create_account", "message": "Created account f90c3d63-a95a-4fc1-bd53-e916d257800c (Test Account) for user b55395cf-b50a-488d-b57f-aeed880a50b2", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:22,555", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=b55395cf-b50a-488d-b57f-aeed880a50b2, action=CREATE, entity=account:f90c3d63-a95a-4fc1-bd53-e916d257800c, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:22,555", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/accounts 201 - request_id=unknown client=127.0.0.1 duration=0.079s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:22,559", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/accounts \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/accounts "HTTP/1.1 201 Created"
__________ TestAccountRoutes.test_update_account_invalid_account_type __________
tests/integration/test_account_routes.py:829: in test_update_account_invalid_account_type
    assert response.status_code == 422
E   assert 200 == 422
E    +  where 200 = <Response [200 OK]>.status_code
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:23,666", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:23,801", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: f365c83a-bbfc-4255-a98b-c0fd06269e94 (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:23,835", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=f365c83a-bbfc-4255-a98b-c0fd06269e94, action=LOGIN, entity=user:f365c83a-bbfc-4255-a98b-c0fd06269e94, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:23,838", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: f365c83a-bbfc-4255-a98b-c0fd06269e94 (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:23,839", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.086s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:23,839", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:23,990", "name": "src.core.encryption", "levelname": "INFO", "filename": "encryption.py", "lineno": 64, "funcName": "__init__", "message": "Encryption service initialized successfully", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:24,021", "name": "src.services.account_service", "levelname": "INFO", "filename": "account_service.py", "lineno": 217, "funcName": "create_account", "message": "Created account 9f908985-838c-4e64-a631-650a3bbe12bb (Test Account) for user f365c83a-bbfc-4255-a98b-c0fd06269e94", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:24,027", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=f365c83a-bbfc-4255-a98b-c0fd06269e94, action=CREATE, entity=account:9f908985-838c-4e64-a631-650a3bbe12bb, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:24,029", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/accounts 201 - request_id=unknown client=127.0.0.1 duration=0.086s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:24,033", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/accounts \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:24,081", "name": "src.core.encryption", "levelname": "INFO", "filename": "encryption.py", "lineno": 64, "funcName": "__init__", "message": "Encryption service initialized successfully", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:24,114", "name": "src.services.account_service", "levelname": "INFO", "filename": "account_service.py", "lineno": 537, "funcName": "update_account", "message": "Updated account 9f908985-838c-4e64-a631-650a3bbe12bb: {'account_type_id': {'old': '1a7e9233-2547-4d89-a5a0-1c02869de94d', 'new': 'bb357c36-a9a0-44e0-9e9e-0ddf65efcd2e'}}", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:24,121", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=f365c83a-bbfc-4255-a98b-c0fd06269e94, action=UPDATE, entity=account:9f908985-838c-4e64-a631-650a3bbe12bb, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:24,121", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "PUT /api/v1/accounts/9f908985-838c-4e64-a631-650a3bbe12bb 200 - request_id=unknown client=127.0.0.1 duration=0.088s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:24,125", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: PUT http://test/api/v1/accounts/9f908985-838c-4e64-a631-650a3bbe12bb \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/accounts "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: PUT http://test/api/v1/accounts/9f908985-838c-4e64-a631-650a3bbe12bb "HTTP/1.1 200 OK"
_________ TestAccountTypeRoutes.test_create_account_type_minimal_data __________
  + Exception Group Traceback (most recent call last):
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 246, in <lambda>
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 61, in test_create_account_type_minimal_data
    |     response = await async_client.post(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<6 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...<13 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<4 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    |     return await service.create_account_type(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<5 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    |     return AccountTypeResponse.model_validate(account_type)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    |     return cls.__pydantic_validator__.validate_python(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         obj,
    |         ^^^^
    |     ...<5 lines>...
    |         by_name=by_name,
    |         ^^^^^^^^^^^^^^^^
    |     )
    |     ^
    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
    | icon_url
    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 61, in test_create_account_type_minimal_data
    response = await async_client.post(
               ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    return await service.create_account_type(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        obj,
        ^^^^
    ...<5 lines>...
        by_name=by_name,
        ^^^^^^^^^^^^^^^^
    )
    ^
pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
icon_url
  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing

The above exception was the direct cause of the following exception:
tests/integration/test_account_type_routes.py:61: in test_create_account_type_minimal_data
    response = await async_client.post(
.venv/lib/python3.13/site-packages/httpx/_client.py:1859: in post
    return await self.request(
.venv/lib/python3.13/site-packages/httpx/_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1629: in send
    response = await self._send_handling_auth(
.venv/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
.venv/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/applications.py:1134: in __call__
    await super().__call__(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
.venv/lib/python3.13/site-packages/starlette/middleware/cors.py:85: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:102: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:182: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:56: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:736: in app
    await route.handle(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:290: in handle
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/routing.py:124: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/routing.py:110: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/fastapi/routing.py:390: in app
    raw_response = await run_endpoint_function(
.venv/lib/python3.13/site-packages/fastapi/routing.py:289: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/api/routes/account_types.py:66: in create_account_type
    return await service.create_account_type(
src/services/account_type_service.py:141: in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
E   icon_url
E     Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:40,746", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:40,887", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 4ff86194-5bca-4464-9e81-7132a741abc8 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:40,919", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=4ff86194-5bca-4464-9e81-7132a741abc8, action=LOGIN, entity=user:4ff86194-5bca-4464-9e81-7132a741abc8, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:40,922", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 4ff86194-5bca-4464-9e81-7132a741abc8 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:40,922", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.087s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:40,923", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:40,951", "name": "src.services.account_type_service", "levelname": "INFO", "filename": "account_type_service.py", "lineno": 121, "funcName": "create_account_type", "message": "Account type created: e14e6d7d-6380-4497-a2fc-cabf0aac1ce4 ('minimal_type') by admin 4ff86194-5bca-4464-9e81-7132a741abc8", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:40,979", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=4ff86194-5bca-4464-9e81-7132a741abc8, action=CREATE_ACCOUNT_TYPE, entity=account_type:e14e6d7d-6380-4497-a2fc-cabf0aac1ce4, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:40,982", "name": "src.middleware", "levelname": "ERROR", "filename": "middleware.py", "lineno": 186, "funcName": "dispatch", "message": "Request failed: POST /api/v1/account-types - request_id=unknown client=127.0.0.1 duration=0.059s error=1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:41,002", "name": "src.main", "levelname": "ERROR", "filename": "main.py", "lineno": 201, "funcName": "general_exception_handler", "message": "Unexpected error: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing (request_id=6b0f02fe-fea3-4657-baf8-d09dad5de3b3)", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
_________ TestAccountTypeRoutes.test_create_account_type_duplicate_key _________
  + Exception Group Traceback (most recent call last):
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 246, in <lambda>
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 84, in test_create_account_type_duplicate_key
    |     await async_client.post(
    |     ...<6 lines>...
    |     )
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...<13 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<4 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    |     return await service.create_account_type(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<5 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    |     return AccountTypeResponse.model_validate(account_type)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    |     return cls.__pydantic_validator__.validate_python(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         obj,
    |         ^^^^
    |     ...<5 lines>...
    |         by_name=by_name,
    |         ^^^^^^^^^^^^^^^^
    |     )
    |     ^
    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
    | icon_url
    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 84, in test_create_account_type_duplicate_key
    await async_client.post(
    ...<6 lines>...
    )
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    return await service.create_account_type(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        obj,
        ^^^^
    ...<5 lines>...
        by_name=by_name,
        ^^^^^^^^^^^^^^^^
    )
    ^
pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
icon_url
  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing

The above exception was the direct cause of the following exception:
tests/integration/test_account_type_routes.py:84: in test_create_account_type_duplicate_key
    await async_client.post(
.venv/lib/python3.13/site-packages/httpx/_client.py:1859: in post
    return await self.request(
.venv/lib/python3.13/site-packages/httpx/_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1629: in send
    response = await self._send_handling_auth(
.venv/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
.venv/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/applications.py:1134: in __call__
    await super().__call__(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
.venv/lib/python3.13/site-packages/starlette/middleware/cors.py:85: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:102: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:182: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:56: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:736: in app
    await route.handle(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:290: in handle
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/routing.py:124: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/routing.py:110: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/fastapi/routing.py:390: in app
    raw_response = await run_endpoint_function(
.venv/lib/python3.13/site-packages/fastapi/routing.py:289: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/api/routes/account_types.py:66: in create_account_type
    return await service.create_account_type(
src/services/account_type_service.py:141: in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
E   icon_url
E     Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:41,257", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:41,396", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 4a8b5e25-4ff9-4982-82cd-73b6eee1cfd0 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:41,429", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=4a8b5e25-4ff9-4982-82cd-73b6eee1cfd0, action=LOGIN, entity=user:4a8b5e25-4ff9-4982-82cd-73b6eee1cfd0, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:41,432", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 4a8b5e25-4ff9-4982-82cd-73b6eee1cfd0 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:41,432", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.088s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:41,433", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:41,462", "name": "src.services.account_type_service", "levelname": "INFO", "filename": "account_type_service.py", "lineno": 121, "funcName": "create_account_type", "message": "Account type created: 068c0b0b-91d3-49bf-9b44-12a276aa9bc5 ('duplicate_key') by admin 4a8b5e25-4ff9-4982-82cd-73b6eee1cfd0", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:41,491", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=4a8b5e25-4ff9-4982-82cd-73b6eee1cfd0, action=CREATE_ACCOUNT_TYPE, entity=account_type:068c0b0b-91d3-49bf-9b44-12a276aa9bc5, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:41,493", "name": "src.middleware", "levelname": "ERROR", "filename": "middleware.py", "lineno": 186, "funcName": "dispatch", "message": "Request failed: POST /api/v1/account-types - request_id=unknown client=127.0.0.1 duration=0.060s error=1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:41,506", "name": "src.main", "levelname": "ERROR", "filename": "main.py", "lineno": 201, "funcName": "general_exception_handler", "message": "Unexpected error: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing (request_id=55165661-151d-4a49-9a61-7f2442d76fd7)", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
______ TestAccountTypeRoutes.test_create_account_type_invalid_key_format _______
  + Exception Group Traceback (most recent call last):
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 246, in <lambda>
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 165, in test_create_account_type_invalid_key_format
    |     response = await async_client.post(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<6 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...<13 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<4 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    |     return await service.create_account_type(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<5 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    |     return AccountTypeResponse.model_validate(account_type)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    |     return cls.__pydantic_validator__.validate_python(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         obj,
    |         ^^^^
    |     ...<5 lines>...
    |         by_name=by_name,
    |         ^^^^^^^^^^^^^^^^
    |     )
    |     ^
    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
    | icon_url
    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 165, in test_create_account_type_invalid_key_format
    response = await async_client.post(
               ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    return await service.create_account_type(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        obj,
        ^^^^
    ...<5 lines>...
        by_name=by_name,
        ^^^^^^^^^^^^^^^^
    )
    ^
pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
icon_url
  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing

The above exception was the direct cause of the following exception:
tests/integration/test_account_type_routes.py:165: in test_create_account_type_invalid_key_format
    response = await async_client.post(
.venv/lib/python3.13/site-packages/httpx/_client.py:1859: in post
    return await self.request(
.venv/lib/python3.13/site-packages/httpx/_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1629: in send
    response = await self._send_handling_auth(
.venv/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
.venv/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/applications.py:1134: in __call__
    await super().__call__(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
.venv/lib/python3.13/site-packages/starlette/middleware/cors.py:85: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:102: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:182: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:56: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:736: in app
    await route.handle(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:290: in handle
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/routing.py:124: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/routing.py:110: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/fastapi/routing.py:390: in app
    raw_response = await run_endpoint_function(
.venv/lib/python3.13/site-packages/fastapi/routing.py:289: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/api/routes/account_types.py:66: in create_account_type
    return await service.create_account_type(
src/services/account_type_service.py:141: in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
E   icon_url
E     Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:41,755", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:41,893", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 5e45d64b-bd43-4b64-b276-e44254cb3ff4 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:41,926", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=5e45d64b-bd43-4b64-b276-e44254cb3ff4, action=LOGIN, entity=user:5e45d64b-bd43-4b64-b276-e44254cb3ff4, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:41,929", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 5e45d64b-bd43-4b64-b276-e44254cb3ff4 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:41,929", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.085s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:41,929", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:41,954", "name": "src.main", "levelname": "WARNING", "filename": "main.py", "lineno": 162, "funcName": "validation_exception_handler", "message": "Validation error: [{'type': 'string_pattern_mismatch', 'loc': ('body', 'key'), 'msg': \"String should match pattern '^[a-z0-9_]+$'\", 'input': 'invalid key', 'ctx': {'pattern': '^[a-z0-9_]+$'}}] (request_id=d62a264b-f5c5-4ebf-b50c-d52cbaa1d947)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:41,954", "name": "src.middleware", "levelname": "WARNING", "filename": "middleware.py", "lineno": 208, "funcName": "dispatch", "message": "POST /api/v1/account-types 422 - request_id=unknown client=127.0.0.1 duration=0.024s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:41,955", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/account-types \"HTTP/1.1 422 Unprocessable Entity\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:41,979", "name": "src.main", "levelname": "WARNING", "filename": "main.py", "lineno": 162, "funcName": "validation_exception_handler", "message": "Validation error: [{'type': 'string_pattern_mismatch', 'loc': ('body', 'key'), 'msg': \"String should match pattern '^[a-z0-9_]+$'\", 'input': 'invalid-key', 'ctx': {'pattern': '^[a-z0-9_]+$'}}] (request_id=5a7e3297-d2f8-45dd-bb7b-2ba41835b56d)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:41,980", "name": "src.middleware", "levelname": "WARNING", "filename": "middleware.py", "lineno": 208, "funcName": "dispatch", "message": "POST /api/v1/account-types 422 - request_id=unknown client=127.0.0.1 duration=0.024s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:41,980", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/account-types \"HTTP/1.1 422 Unprocessable Entity\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:42,007", "name": "src.main", "levelname": "WARNING", "filename": "main.py", "lineno": 162, "funcName": "validation_exception_handler", "message": "Validation error: [{'type': 'string_pattern_mismatch', 'loc': ('body', 'key'), 'msg': \"String should match pattern '^[a-z0-9_]+$'\", 'input': 'UPPERCASE', 'ctx': {'pattern': '^[a-z0-9_]+$'}}] (request_id=865258f3-551a-4688-8b78-ae62df2a80f2)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:42,007", "name": "src.middleware", "levelname": "WARNING", "filename": "middleware.py", "lineno": 208, "funcName": "dispatch", "message": "POST /api/v1/account-types 422 - request_id=unknown client=127.0.0.1 duration=0.027s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:42,007", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/account-types \"HTTP/1.1 422 Unprocessable Entity\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:42,036", "name": "src.services.account_type_service", "levelname": "INFO", "filename": "account_type_service.py", "lineno": 121, "funcName": "create_account_type", "message": "Account type created: 832d2485-b7b4-411f-a16c-8cd5327454c8 ('valid_key_123') by admin 5e45d64b-bd43-4b64-b276-e44254cb3ff4", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:42,066", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=5e45d64b-bd43-4b64-b276-e44254cb3ff4, action=CREATE_ACCOUNT_TYPE, entity=account_type:832d2485-b7b4-411f-a16c-8cd5327454c8, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:42,069", "name": "src.middleware", "levelname": "ERROR", "filename": "middleware.py", "lineno": 186, "funcName": "dispatch", "message": "Request failed: POST /api/v1/account-types - request_id=unknown client=127.0.0.1 duration=0.061s error=1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:42,081", "name": "src.main", "levelname": "ERROR", "filename": "main.py", "lineno": 201, "funcName": "general_exception_handler", "message": "Unexpected error: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing (request_id=2b52bd4e-b39c-4815-ac2d-5837e4fe62fa)", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/account-types "HTTP/1.1 422 Unprocessable Entity"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/account-types "HTTP/1.1 422 Unprocessable Entity"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/account-types "HTTP/1.1 422 Unprocessable Entity"
______ TestAccountTypeRoutes.test_create_account_type_whitespace_trimming ______
  + Exception Group Traceback (most recent call last):
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 246, in <lambda>
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 200, in test_create_account_type_whitespace_trimming
    |     response = await async_client.post(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<7 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...<13 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<4 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    |     return await service.create_account_type(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<5 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    |     return AccountTypeResponse.model_validate(account_type)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    |     return cls.__pydantic_validator__.validate_python(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         obj,
    |         ^^^^
    |     ...<5 lines>...
    |         by_name=by_name,
    |         ^^^^^^^^^^^^^^^^
    |     )
    |     ^
    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
    | icon_url
    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 200, in test_create_account_type_whitespace_trimming
    response = await async_client.post(
               ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    return await service.create_account_type(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        obj,
        ^^^^
    ...<5 lines>...
        by_name=by_name,
        ^^^^^^^^^^^^^^^^
    )
    ^
pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
icon_url
  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing

The above exception was the direct cause of the following exception:
tests/integration/test_account_type_routes.py:200: in test_create_account_type_whitespace_trimming
    response = await async_client.post(
.venv/lib/python3.13/site-packages/httpx/_client.py:1859: in post
    return await self.request(
.venv/lib/python3.13/site-packages/httpx/_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1629: in send
    response = await self._send_handling_auth(
.venv/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
.venv/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/applications.py:1134: in __call__
    await super().__call__(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
.venv/lib/python3.13/site-packages/starlette/middleware/cors.py:85: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:102: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:182: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:56: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:736: in app
    await route.handle(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:290: in handle
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/routing.py:124: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/routing.py:110: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/fastapi/routing.py:390: in app
    raw_response = await run_endpoint_function(
.venv/lib/python3.13/site-packages/fastapi/routing.py:289: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/api/routes/account_types.py:66: in create_account_type
    return await service.create_account_type(
src/services/account_type_service.py:141: in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
E   icon_url
E     Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:42,631", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:42,765", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 278a3b8b-bebc-4a9e-95a9-65194fd37249 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:42,799", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=278a3b8b-bebc-4a9e-95a9-65194fd37249, action=LOGIN, entity=user:278a3b8b-bebc-4a9e-95a9-65194fd37249, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:42,802", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 278a3b8b-bebc-4a9e-95a9-65194fd37249 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:42,802", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.087s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:42,803", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:42,831", "name": "src.services.account_type_service", "levelname": "INFO", "filename": "account_type_service.py", "lineno": 121, "funcName": "create_account_type", "message": "Account type created: 28c0f22a-5606-4ec3-95c3-99a53a5f2255 ('trim_test_key') by admin 278a3b8b-bebc-4a9e-95a9-65194fd37249", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:42,862", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=278a3b8b-bebc-4a9e-95a9-65194fd37249, action=CREATE_ACCOUNT_TYPE, entity=account_type:28c0f22a-5606-4ec3-95c3-99a53a5f2255, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:42,864", "name": "src.middleware", "levelname": "ERROR", "filename": "middleware.py", "lineno": 186, "funcName": "dispatch", "message": "Request failed: POST /api/v1/account-types - request_id=unknown client=127.0.0.1 duration=0.061s error=1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:42,877", "name": "src.main", "levelname": "ERROR", "filename": "main.py", "lineno": 201, "funcName": "general_exception_handler", "message": "Unexpected error: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing (request_id=6b8499e3-eeba-4e30-9fa5-5c20a19c6ba6)", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
____________ TestAccountTypeRoutes.test_list_account_types_success _____________
  + Exception Group Traceback (most recent call last):
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 246, in <lambda>
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 254, in test_list_account_types_success
    |     await async_client.post(
    |     ...<7 lines>...
    |     )
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...<13 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<4 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    |     return await service.create_account_type(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<5 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    |     return AccountTypeResponse.model_validate(account_type)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    |     return cls.__pydantic_validator__.validate_python(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         obj,
    |         ^^^^
    |     ...<5 lines>...
    |         by_name=by_name,
    |         ^^^^^^^^^^^^^^^^
    |     )
    |     ^
    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
    | icon_url
    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 254, in test_list_account_types_success
    await async_client.post(
    ...<7 lines>...
    )
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    return await service.create_account_type(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        obj,
        ^^^^
    ...<5 lines>...
        by_name=by_name,
        ^^^^^^^^^^^^^^^^
    )
    ^
pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
icon_url
  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing

The above exception was the direct cause of the following exception:
tests/integration/test_account_type_routes.py:254: in test_list_account_types_success
    await async_client.post(
.venv/lib/python3.13/site-packages/httpx/_client.py:1859: in post
    return await self.request(
.venv/lib/python3.13/site-packages/httpx/_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1629: in send
    response = await self._send_handling_auth(
.venv/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
.venv/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/applications.py:1134: in __call__
    await super().__call__(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
.venv/lib/python3.13/site-packages/starlette/middleware/cors.py:85: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:102: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:182: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:56: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:736: in app
    await route.handle(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:290: in handle
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/routing.py:124: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/routing.py:110: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/fastapi/routing.py:390: in app
    raw_response = await run_endpoint_function(
.venv/lib/python3.13/site-packages/fastapi/routing.py:289: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/api/routes/account_types.py:66: in create_account_type
    return await service.create_account_type(
src/services/account_type_service.py:141: in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
E   icon_url
E     Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:43,509", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:43,645", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 70208652-de7c-4a33-a1e4-6f3e7be89b26 (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:43,679", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=70208652-de7c-4a33-a1e4-6f3e7be89b26, action=LOGIN, entity=user:70208652-de7c-4a33-a1e4-6f3e7be89b26, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:43,681", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 70208652-de7c-4a33-a1e4-6f3e7be89b26 (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:43,682", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.086s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:43,682", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:43,799", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: cd711060-f81f-4a93-bda5-ae5779dddae6 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:43,833", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=cd711060-f81f-4a93-bda5-ae5779dddae6, action=LOGIN, entity=user:cd711060-f81f-4a93-bda5-ae5779dddae6, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:43,836", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: cd711060-f81f-4a93-bda5-ae5779dddae6 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:43,836", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.086s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:43,837", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:43,866", "name": "src.services.account_type_service", "levelname": "INFO", "filename": "account_type_service.py", "lineno": 121, "funcName": "create_account_type", "message": "Account type created: 9028aa6b-e81b-4bb4-9819-63f8fba1b383 ('test_type_0') by admin cd711060-f81f-4a93-bda5-ae5779dddae6", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:43,896", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=cd711060-f81f-4a93-bda5-ae5779dddae6, action=CREATE_ACCOUNT_TYPE, entity=account_type:9028aa6b-e81b-4bb4-9819-63f8fba1b383, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:43,898", "name": "src.middleware", "levelname": "ERROR", "filename": "middleware.py", "lineno": 186, "funcName": "dispatch", "message": "Request failed: POST /api/v1/account-types - request_id=unknown client=127.0.0.1 duration=0.061s error=1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:43,911", "name": "src.main", "levelname": "ERROR", "filename": "main.py", "lineno": 201, "funcName": "general_exception_handler", "message": "Unexpected error: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing (request_id=06050ac1-a235-47c2-b9ae-6ba63f475e15)", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
_______ TestAccountTypeRoutes.test_list_account_types_filter_active_only _______
  + Exception Group Traceback (most recent call last):
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 246, in <lambda>
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 289, in test_list_account_types_filter_active_only
    |     await async_client.post(
    |     ...<6 lines>...
    |     )
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...<13 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<4 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    |     return await service.create_account_type(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<5 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    |     return AccountTypeResponse.model_validate(account_type)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    |     return cls.__pydantic_validator__.validate_python(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         obj,
    |         ^^^^
    |     ...<5 lines>...
    |         by_name=by_name,
    |         ^^^^^^^^^^^^^^^^
    |     )
    |     ^
    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
    | icon_url
    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 289, in test_list_account_types_filter_active_only
    await async_client.post(
    ...<6 lines>...
    )
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    return await service.create_account_type(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        obj,
        ^^^^
    ...<5 lines>...
        by_name=by_name,
        ^^^^^^^^^^^^^^^^
    )
    ^
pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
icon_url
  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing

The above exception was the direct cause of the following exception:
tests/integration/test_account_type_routes.py:289: in test_list_account_types_filter_active_only
    await async_client.post(
.venv/lib/python3.13/site-packages/httpx/_client.py:1859: in post
    return await self.request(
.venv/lib/python3.13/site-packages/httpx/_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1629: in send
    response = await self._send_handling_auth(
.venv/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
.venv/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/applications.py:1134: in __call__
    await super().__call__(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
.venv/lib/python3.13/site-packages/starlette/middleware/cors.py:85: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:102: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:182: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:56: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:736: in app
    await route.handle(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:290: in handle
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/routing.py:124: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/routing.py:110: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/fastapi/routing.py:390: in app
    raw_response = await run_endpoint_function(
.venv/lib/python3.13/site-packages/fastapi/routing.py:289: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/api/routes/account_types.py:66: in create_account_type
    return await service.create_account_type(
src/services/account_type_service.py:141: in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
E   icon_url
E     Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:44,155", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:44,292", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: f6f6008e-7ba6-404f-a650-d7ec060601bf (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:44,325", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=f6f6008e-7ba6-404f-a650-d7ec060601bf, action=LOGIN, entity=user:f6f6008e-7ba6-404f-a650-d7ec060601bf, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:44,329", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: f6f6008e-7ba6-404f-a650-d7ec060601bf (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:44,330", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.088s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:44,331", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:44,449", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 40685347-12b7-4940-84a6-f3ad3266e79f (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:44,481", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=40685347-12b7-4940-84a6-f3ad3266e79f, action=LOGIN, entity=user:40685347-12b7-4940-84a6-f3ad3266e79f, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:44,483", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 40685347-12b7-4940-84a6-f3ad3266e79f (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:44,484", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.085s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:44,484", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:44,512", "name": "src.services.account_type_service", "levelname": "INFO", "filename": "account_type_service.py", "lineno": 121, "funcName": "create_account_type", "message": "Account type created: 8aaabaaa-3b1b-4d5a-9ec6-f7d5aaa1934b ('active_type') by admin 40685347-12b7-4940-84a6-f3ad3266e79f", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:44,540", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=40685347-12b7-4940-84a6-f3ad3266e79f, action=CREATE_ACCOUNT_TYPE, entity=account_type:8aaabaaa-3b1b-4d5a-9ec6-f7d5aaa1934b, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:44,542", "name": "src.middleware", "levelname": "ERROR", "filename": "middleware.py", "lineno": 186, "funcName": "dispatch", "message": "Request failed: POST /api/v1/account-types - request_id=unknown client=127.0.0.1 duration=0.057s error=1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:44,555", "name": "src.main", "levelname": "ERROR", "filename": "main.py", "lineno": 201, "funcName": "general_exception_handler", "message": "Unexpected error: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing (request_id=bd9bf9ab-13c8-4d4b-bb0d-3d91def123ad)", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
______ TestAccountTypeRoutes.test_list_account_types_filter_inactive_only ______
  + Exception Group Traceback (most recent call last):
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 246, in <lambda>
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 324, in test_list_account_types_filter_inactive_only
    |     await async_client.post(
    |     ...<6 lines>...
    |     )
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...<13 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<4 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    |     return await service.create_account_type(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<5 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    |     return AccountTypeResponse.model_validate(account_type)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    |     return cls.__pydantic_validator__.validate_python(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         obj,
    |         ^^^^
    |     ...<5 lines>...
    |         by_name=by_name,
    |         ^^^^^^^^^^^^^^^^
    |     )
    |     ^
    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
    | icon_url
    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 324, in test_list_account_types_filter_inactive_only
    await async_client.post(
    ...<6 lines>...
    )
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    return await service.create_account_type(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        obj,
        ^^^^
    ...<5 lines>...
        by_name=by_name,
        ^^^^^^^^^^^^^^^^
    )
    ^
pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
icon_url
  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing

The above exception was the direct cause of the following exception:
tests/integration/test_account_type_routes.py:324: in test_list_account_types_filter_inactive_only
    await async_client.post(
.venv/lib/python3.13/site-packages/httpx/_client.py:1859: in post
    return await self.request(
.venv/lib/python3.13/site-packages/httpx/_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1629: in send
    response = await self._send_handling_auth(
.venv/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
.venv/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/applications.py:1134: in __call__
    await super().__call__(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
.venv/lib/python3.13/site-packages/starlette/middleware/cors.py:85: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:102: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:182: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:56: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:736: in app
    await route.handle(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:290: in handle
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/routing.py:124: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/routing.py:110: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/fastapi/routing.py:390: in app
    raw_response = await run_endpoint_function(
.venv/lib/python3.13/site-packages/fastapi/routing.py:289: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/api/routes/account_types.py:66: in create_account_type
    return await service.create_account_type(
src/services/account_type_service.py:141: in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
E   icon_url
E     Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:44,795", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:44,930", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: bf49f9d8-4a38-4e51-97ca-37b7ece23900 (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:44,962", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=bf49f9d8-4a38-4e51-97ca-37b7ece23900, action=LOGIN, entity=user:bf49f9d8-4a38-4e51-97ca-37b7ece23900, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:44,964", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: bf49f9d8-4a38-4e51-97ca-37b7ece23900 (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:44,965", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.086s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:44,965", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:45,081", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: be75a190-a135-4ba0-9c26-18b6ecfa8bd8 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:45,113", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=be75a190-a135-4ba0-9c26-18b6ecfa8bd8, action=LOGIN, entity=user:be75a190-a135-4ba0-9c26-18b6ecfa8bd8, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:45,115", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: be75a190-a135-4ba0-9c26-18b6ecfa8bd8 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:45,116", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.083s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:45,116", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:45,144", "name": "src.services.account_type_service", "levelname": "INFO", "filename": "account_type_service.py", "lineno": 121, "funcName": "create_account_type", "message": "Account type created: f6873dfb-1a02-4497-806f-2101c09b3172 ('active_type_2') by admin be75a190-a135-4ba0-9c26-18b6ecfa8bd8", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:45,172", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=be75a190-a135-4ba0-9c26-18b6ecfa8bd8, action=CREATE_ACCOUNT_TYPE, entity=account_type:f6873dfb-1a02-4497-806f-2101c09b3172, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:45,175", "name": "src.middleware", "levelname": "ERROR", "filename": "middleware.py", "lineno": 186, "funcName": "dispatch", "message": "Request failed: POST /api/v1/account-types - request_id=unknown client=127.0.0.1 duration=0.058s error=1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:45,188", "name": "src.main", "levelname": "ERROR", "filename": "main.py", "lineno": 201, "funcName": "general_exception_handler", "message": "Unexpected error: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing (request_id=96d8556b-24b9-4d65-822b-5a50aa7406ab)", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
______________ TestAccountTypeRoutes.test_list_account_types_all _______________
  + Exception Group Traceback (most recent call last):
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 246, in <lambda>
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 355, in test_list_account_types_all
    |     active_response = await async_client.post(
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<6 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...<13 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<4 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    |     return await service.create_account_type(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<5 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    |     return AccountTypeResponse.model_validate(account_type)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    |     return cls.__pydantic_validator__.validate_python(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         obj,
    |         ^^^^
    |     ...<5 lines>...
    |         by_name=by_name,
    |         ^^^^^^^^^^^^^^^^
    |     )
    |     ^
    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
    | icon_url
    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 355, in test_list_account_types_all
    active_response = await async_client.post(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    return await service.create_account_type(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        obj,
        ^^^^
    ...<5 lines>...
        by_name=by_name,
        ^^^^^^^^^^^^^^^^
    )
    ^
pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
icon_url
  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing

The above exception was the direct cause of the following exception:
tests/integration/test_account_type_routes.py:355: in test_list_account_types_all
    active_response = await async_client.post(
.venv/lib/python3.13/site-packages/httpx/_client.py:1859: in post
    return await self.request(
.venv/lib/python3.13/site-packages/httpx/_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1629: in send
    response = await self._send_handling_auth(
.venv/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
.venv/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/applications.py:1134: in __call__
    await super().__call__(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
.venv/lib/python3.13/site-packages/starlette/middleware/cors.py:85: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:102: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:182: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:56: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:736: in app
    await route.handle(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:290: in handle
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/routing.py:124: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/routing.py:110: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/fastapi/routing.py:390: in app
    raw_response = await run_endpoint_function(
.venv/lib/python3.13/site-packages/fastapi/routing.py:289: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/api/routes/account_types.py:66: in create_account_type
    return await service.create_account_type(
src/services/account_type_service.py:141: in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
E   icon_url
E     Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:45,425", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:45,558", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 0160ba19-f7af-4148-abfa-bfb8744197ad (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:45,592", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=0160ba19-f7af-4148-abfa-bfb8744197ad, action=LOGIN, entity=user:0160ba19-f7af-4148-abfa-bfb8744197ad, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:45,594", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 0160ba19-f7af-4148-abfa-bfb8744197ad (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:45,595", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.084s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:45,595", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:45,713", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 7c8fb312-0c5b-4bbb-b21f-c2f2c0b3b5b8 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:45,747", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=7c8fb312-0c5b-4bbb-b21f-c2f2c0b3b5b8, action=LOGIN, entity=user:7c8fb312-0c5b-4bbb-b21f-c2f2c0b3b5b8, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:45,749", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 7c8fb312-0c5b-4bbb-b21f-c2f2c0b3b5b8 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:45,750", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.087s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:45,750", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:45,777", "name": "src.services.account_type_service", "levelname": "INFO", "filename": "account_type_service.py", "lineno": 121, "funcName": "create_account_type", "message": "Account type created: b0c25827-46e5-4144-b1bb-95b5943da804 ('all_test_active') by admin 7c8fb312-0c5b-4bbb-b21f-c2f2c0b3b5b8", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:45,806", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=7c8fb312-0c5b-4bbb-b21f-c2f2c0b3b5b8, action=CREATE_ACCOUNT_TYPE, entity=account_type:b0c25827-46e5-4144-b1bb-95b5943da804, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:45,809", "name": "src.middleware", "levelname": "ERROR", "filename": "middleware.py", "lineno": 186, "funcName": "dispatch", "message": "Request failed: POST /api/v1/account-types - request_id=unknown client=127.0.0.1 duration=0.058s error=1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:45,821", "name": "src.main", "levelname": "ERROR", "filename": "main.py", "lineno": 201, "funcName": "general_exception_handler", "message": "Unexpected error: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing (request_id=1d72af53-b443-494c-b291-9f51972ada5a)", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
____________ TestAccountTypeRoutes.test_list_account_types_ordering ____________
  + Exception Group Traceback (most recent call last):
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 246, in <lambda>
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 407, in test_list_account_types_ordering
    |     await async_client.post(
    |     ...<3 lines>...
    |     )
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...<13 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<4 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    |     return await service.create_account_type(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<5 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    |     return AccountTypeResponse.model_validate(account_type)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    |     return cls.__pydantic_validator__.validate_python(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         obj,
    |         ^^^^
    |     ...<5 lines>...
    |         by_name=by_name,
    |         ^^^^^^^^^^^^^^^^
    |     )
    |     ^
    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
    | icon_url
    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 407, in test_list_account_types_ordering
    await async_client.post(
    ...<3 lines>...
    )
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    return await service.create_account_type(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        obj,
        ^^^^
    ...<5 lines>...
        by_name=by_name,
        ^^^^^^^^^^^^^^^^
    )
    ^
pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
icon_url
  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing

The above exception was the direct cause of the following exception:
tests/integration/test_account_type_routes.py:407: in test_list_account_types_ordering
    await async_client.post(
.venv/lib/python3.13/site-packages/httpx/_client.py:1859: in post
    return await self.request(
.venv/lib/python3.13/site-packages/httpx/_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1629: in send
    response = await self._send_handling_auth(
.venv/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
.venv/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/applications.py:1134: in __call__
    await super().__call__(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
.venv/lib/python3.13/site-packages/starlette/middleware/cors.py:85: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:102: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:182: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:56: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:736: in app
    await route.handle(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:290: in handle
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/routing.py:124: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/routing.py:110: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/fastapi/routing.py:390: in app
    raw_response = await run_endpoint_function(
.venv/lib/python3.13/site-packages/fastapi/routing.py:289: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/api/routes/account_types.py:66: in create_account_type
    return await service.create_account_type(
src/services/account_type_service.py:141: in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
E   icon_url
E     Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:46,065", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:46,204", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 217cfcb5-5258-45c8-a310-747431ecf752 (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:46,236", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=217cfcb5-5258-45c8-a310-747431ecf752, action=LOGIN, entity=user:217cfcb5-5258-45c8-a310-747431ecf752, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:46,239", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 217cfcb5-5258-45c8-a310-747431ecf752 (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:46,239", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.085s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:46,240", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:46,358", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: b66a7eee-dcca-457a-a83d-d80cd2fdb00c (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:46,390", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=b66a7eee-dcca-457a-a83d-d80cd2fdb00c, action=LOGIN, entity=user:b66a7eee-dcca-457a-a83d-d80cd2fdb00c, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:46,393", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: b66a7eee-dcca-457a-a83d-d80cd2fdb00c (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:46,393", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.083s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:46,394", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:46,421", "name": "src.services.account_type_service", "levelname": "INFO", "filename": "account_type_service.py", "lineno": 121, "funcName": "create_account_type", "message": "Account type created: b31a29b3-6654-494a-b8c3-9280798c964b ('z_type') by admin b66a7eee-dcca-457a-a83d-d80cd2fdb00c", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:46,449", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=b66a7eee-dcca-457a-a83d-d80cd2fdb00c, action=CREATE_ACCOUNT_TYPE, entity=account_type:b31a29b3-6654-494a-b8c3-9280798c964b, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:46,452", "name": "src.middleware", "levelname": "ERROR", "filename": "middleware.py", "lineno": 186, "funcName": "dispatch", "message": "Request failed: POST /api/v1/account-types - request_id=unknown client=127.0.0.1 duration=0.058s error=1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:46,465", "name": "src.main", "levelname": "ERROR", "filename": "main.py", "lineno": 201, "funcName": "general_exception_handler", "message": "Unexpected error: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing (request_id=71e7536b-8901-4db3-ae56-45a4d0c44ea7)", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
__________ TestAccountTypeRoutes.test_get_account_type_by_id_success ___________
  + Exception Group Traceback (most recent call last):
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 246, in <lambda>
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 458, in test_get_account_type_by_id_success
    |     create_response = await async_client.post(
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<6 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...<13 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<4 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    |     return await service.create_account_type(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<5 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    |     return AccountTypeResponse.model_validate(account_type)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    |     return cls.__pydantic_validator__.validate_python(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         obj,
    |         ^^^^
    |     ...<5 lines>...
    |         by_name=by_name,
    |         ^^^^^^^^^^^^^^^^
    |     )
    |     ^
    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
    | icon_url
    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 458, in test_get_account_type_by_id_success
    create_response = await async_client.post(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    return await service.create_account_type(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        obj,
        ^^^^
    ...<5 lines>...
        by_name=by_name,
        ^^^^^^^^^^^^^^^^
    )
    ^
pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
icon_url
  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing

The above exception was the direct cause of the following exception:
tests/integration/test_account_type_routes.py:458: in test_get_account_type_by_id_success
    create_response = await async_client.post(
.venv/lib/python3.13/site-packages/httpx/_client.py:1859: in post
    return await self.request(
.venv/lib/python3.13/site-packages/httpx/_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1629: in send
    response = await self._send_handling_auth(
.venv/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
.venv/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/applications.py:1134: in __call__
    await super().__call__(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
.venv/lib/python3.13/site-packages/starlette/middleware/cors.py:85: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:102: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:182: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:56: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:736: in app
    await route.handle(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:290: in handle
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/routing.py:124: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/routing.py:110: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/fastapi/routing.py:390: in app
    raw_response = await run_endpoint_function(
.venv/lib/python3.13/site-packages/fastapi/routing.py:289: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/api/routes/account_types.py:66: in create_account_type
    return await service.create_account_type(
src/services/account_type_service.py:141: in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
E   icon_url
E     Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:46,811", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:46,945", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: ada2f185-1bd1-4b84-92cc-9392f0b3e8ec (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:46,979", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=ada2f185-1bd1-4b84-92cc-9392f0b3e8ec, action=LOGIN, entity=user:ada2f185-1bd1-4b84-92cc-9392f0b3e8ec, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:46,982", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: ada2f185-1bd1-4b84-92cc-9392f0b3e8ec (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:46,982", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.085s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:46,982", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:47,100", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: d97049d5-ed48-4ec2-a3dd-3beff40da5f2 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:47,136", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=d97049d5-ed48-4ec2-a3dd-3beff40da5f2, action=LOGIN, entity=user:d97049d5-ed48-4ec2-a3dd-3beff40da5f2, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:47,139", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: d97049d5-ed48-4ec2-a3dd-3beff40da5f2 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:47,139", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.088s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:47,140", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:47,167", "name": "src.services.account_type_service", "levelname": "INFO", "filename": "account_type_service.py", "lineno": 121, "funcName": "create_account_type", "message": "Account type created: 61158d2a-4673-4263-9c27-09529d413b03 ('get_by_id_test') by admin d97049d5-ed48-4ec2-a3dd-3beff40da5f2", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:47,197", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=d97049d5-ed48-4ec2-a3dd-3beff40da5f2, action=CREATE_ACCOUNT_TYPE, entity=account_type:61158d2a-4673-4263-9c27-09529d413b03, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:47,200", "name": "src.middleware", "levelname": "ERROR", "filename": "middleware.py", "lineno": 186, "funcName": "dispatch", "message": "Request failed: POST /api/v1/account-types - request_id=unknown client=127.0.0.1 duration=0.059s error=1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:47,212", "name": "src.main", "levelname": "ERROR", "filename": "main.py", "lineno": 201, "funcName": "general_exception_handler", "message": "Unexpected error: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing (request_id=79328c4e-9e2e-475c-aef5-7cc8e52f7963)", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
__________ TestAccountTypeRoutes.test_get_account_type_by_id_inactive __________
  + Exception Group Traceback (most recent call last):
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 246, in <lambda>
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 500, in test_get_account_type_by_id_inactive
    |     create_response = await async_client.post(
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<6 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...<13 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<4 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    |     return await service.create_account_type(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<5 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    |     return AccountTypeResponse.model_validate(account_type)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    |     return cls.__pydantic_validator__.validate_python(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         obj,
    |         ^^^^
    |     ...<5 lines>...
    |         by_name=by_name,
    |         ^^^^^^^^^^^^^^^^
    |     )
    |     ^
    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
    | icon_url
    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 500, in test_get_account_type_by_id_inactive
    create_response = await async_client.post(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    return await service.create_account_type(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        obj,
        ^^^^
    ...<5 lines>...
        by_name=by_name,
        ^^^^^^^^^^^^^^^^
    )
    ^
pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
icon_url
  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing

The above exception was the direct cause of the following exception:
tests/integration/test_account_type_routes.py:500: in test_get_account_type_by_id_inactive
    create_response = await async_client.post(
.venv/lib/python3.13/site-packages/httpx/_client.py:1859: in post
    return await self.request(
.venv/lib/python3.13/site-packages/httpx/_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1629: in send
    response = await self._send_handling_auth(
.venv/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
.venv/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/applications.py:1134: in __call__
    await super().__call__(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
.venv/lib/python3.13/site-packages/starlette/middleware/cors.py:85: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:102: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:182: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:56: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:736: in app
    await route.handle(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:290: in handle
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/routing.py:124: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/routing.py:110: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/fastapi/routing.py:390: in app
    raw_response = await run_endpoint_function(
.venv/lib/python3.13/site-packages/fastapi/routing.py:289: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/api/routes/account_types.py:66: in create_account_type
    return await service.create_account_type(
src/services/account_type_service.py:141: in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
E   icon_url
E     Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:47,742", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:47,875", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 6ac04f25-7091-4c44-a498-40dcad3a6dcb (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:47,910", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=6ac04f25-7091-4c44-a498-40dcad3a6dcb, action=LOGIN, entity=user:6ac04f25-7091-4c44-a498-40dcad3a6dcb, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:47,913", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 6ac04f25-7091-4c44-a498-40dcad3a6dcb (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:47,913", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.087s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:47,913", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:48,031", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 9f6ffe6e-fac4-4aae-ad62-ad98bf1f2616 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:48,064", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=9f6ffe6e-fac4-4aae-ad62-ad98bf1f2616, action=LOGIN, entity=user:9f6ffe6e-fac4-4aae-ad62-ad98bf1f2616, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:48,067", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 9f6ffe6e-fac4-4aae-ad62-ad98bf1f2616 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:48,067", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.086s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:48,068", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:48,094", "name": "src.services.account_type_service", "levelname": "INFO", "filename": "account_type_service.py", "lineno": 121, "funcName": "create_account_type", "message": "Account type created: 2205974a-07f2-4039-b563-c38ef57e63db ('inactive_get') by admin 9f6ffe6e-fac4-4aae-ad62-ad98bf1f2616", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:48,124", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=9f6ffe6e-fac4-4aae-ad62-ad98bf1f2616, action=CREATE_ACCOUNT_TYPE, entity=account_type:2205974a-07f2-4039-b563-c38ef57e63db, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:48,126", "name": "src.middleware", "levelname": "ERROR", "filename": "middleware.py", "lineno": 186, "funcName": "dispatch", "message": "Request failed: POST /api/v1/account-types - request_id=unknown client=127.0.0.1 duration=0.058s error=1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:48,139", "name": "src.main", "levelname": "ERROR", "filename": "main.py", "lineno": 201, "funcName": "general_exception_handler", "message": "Unexpected error: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing (request_id=117bca7c-06af-4599-8b59-459aa487698c)", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
__________ TestAccountTypeRoutes.test_get_account_type_by_key_success __________
  + Exception Group Traceback (most recent call last):
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 246, in <lambda>
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 539, in test_get_account_type_by_key_success
    |     await async_client.post(
    |     ...<6 lines>...
    |     )
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...<13 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<4 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    |     return await service.create_account_type(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<5 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    |     return AccountTypeResponse.model_validate(account_type)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    |     return cls.__pydantic_validator__.validate_python(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         obj,
    |         ^^^^
    |     ...<5 lines>...
    |         by_name=by_name,
    |         ^^^^^^^^^^^^^^^^
    |     )
    |     ^
    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
    | icon_url
    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 539, in test_get_account_type_by_key_success
    await async_client.post(
    ...<6 lines>...
    )
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    return await service.create_account_type(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        obj,
        ^^^^
    ...<5 lines>...
        by_name=by_name,
        ^^^^^^^^^^^^^^^^
    )
    ^
pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
icon_url
  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing

The above exception was the direct cause of the following exception:
tests/integration/test_account_type_routes.py:539: in test_get_account_type_by_key_success
    await async_client.post(
.venv/lib/python3.13/site-packages/httpx/_client.py:1859: in post
    return await self.request(
.venv/lib/python3.13/site-packages/httpx/_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1629: in send
    response = await self._send_handling_auth(
.venv/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
.venv/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/applications.py:1134: in __call__
    await super().__call__(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
.venv/lib/python3.13/site-packages/starlette/middleware/cors.py:85: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:102: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:182: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:56: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:736: in app
    await route.handle(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:290: in handle
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/routing.py:124: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/routing.py:110: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/fastapi/routing.py:390: in app
    raw_response = await run_endpoint_function(
.venv/lib/python3.13/site-packages/fastapi/routing.py:289: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/api/routes/account_types.py:66: in create_account_type
    return await service.create_account_type(
src/services/account_type_service.py:141: in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
E   icon_url
E     Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:48,493", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:48,627", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 70d04dec-3bd9-4a9a-9b21-23b406bb8419 (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:48,659", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=70d04dec-3bd9-4a9a-9b21-23b406bb8419, action=LOGIN, entity=user:70d04dec-3bd9-4a9a-9b21-23b406bb8419, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:48,661", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 70d04dec-3bd9-4a9a-9b21-23b406bb8419 (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:48,662", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.082s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:48,662", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:48,779", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 09adb052-2ed3-44c6-bd02-d9288bfdba36 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:48,812", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=09adb052-2ed3-44c6-bd02-d9288bfdba36, action=LOGIN, entity=user:09adb052-2ed3-44c6-bd02-d9288bfdba36, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:48,815", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 09adb052-2ed3-44c6-bd02-d9288bfdba36 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:48,815", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.084s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:48,816", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:48,845", "name": "src.services.account_type_service", "levelname": "INFO", "filename": "account_type_service.py", "lineno": 121, "funcName": "create_account_type", "message": "Account type created: 28eeb469-7927-4170-81ed-1dc392545c99 ('get_by_key_test') by admin 09adb052-2ed3-44c6-bd02-d9288bfdba36", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:48,874", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=09adb052-2ed3-44c6-bd02-d9288bfdba36, action=CREATE_ACCOUNT_TYPE, entity=account_type:28eeb469-7927-4170-81ed-1dc392545c99, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:48,877", "name": "src.middleware", "levelname": "ERROR", "filename": "middleware.py", "lineno": 186, "funcName": "dispatch", "message": "Request failed: POST /api/v1/account-types - request_id=unknown client=127.0.0.1 duration=0.060s error=1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:48,890", "name": "src.main", "levelname": "ERROR", "filename": "main.py", "lineno": 201, "funcName": "general_exception_handler", "message": "Unexpected error: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing (request_id=1213b679-1105-4de2-83ea-5ee1cc5812ae)", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
_____ TestAccountTypeRoutes.test_get_account_type_by_key_case_insensitive ______
  + Exception Group Traceback (most recent call last):
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 246, in <lambda>
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 565, in test_get_account_type_by_key_case_insensitive
    |     await async_client.post(
    |     ...<6 lines>...
    |     )
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...<13 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<4 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    |     return await service.create_account_type(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<5 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    |     return AccountTypeResponse.model_validate(account_type)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    |     return cls.__pydantic_validator__.validate_python(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         obj,
    |         ^^^^
    |     ...<5 lines>...
    |         by_name=by_name,
    |         ^^^^^^^^^^^^^^^^
    |     )
    |     ^
    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
    | icon_url
    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 565, in test_get_account_type_by_key_case_insensitive
    await async_client.post(
    ...<6 lines>...
    )
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    return await service.create_account_type(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        obj,
        ^^^^
    ...<5 lines>...
        by_name=by_name,
        ^^^^^^^^^^^^^^^^
    )
    ^
pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
icon_url
  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing

The above exception was the direct cause of the following exception:
tests/integration/test_account_type_routes.py:565: in test_get_account_type_by_key_case_insensitive
    await async_client.post(
.venv/lib/python3.13/site-packages/httpx/_client.py:1859: in post
    return await self.request(
.venv/lib/python3.13/site-packages/httpx/_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1629: in send
    response = await self._send_handling_auth(
.venv/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
.venv/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/applications.py:1134: in __call__
    await super().__call__(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
.venv/lib/python3.13/site-packages/starlette/middleware/cors.py:85: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:102: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:182: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:56: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:736: in app
    await route.handle(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:290: in handle
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/routing.py:124: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/routing.py:110: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/fastapi/routing.py:390: in app
    raw_response = await run_endpoint_function(
.venv/lib/python3.13/site-packages/fastapi/routing.py:289: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/api/routes/account_types.py:66: in create_account_type
    return await service.create_account_type(
src/services/account_type_service.py:141: in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
E   icon_url
E     Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:49,191", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:49,329", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: cd62e4fc-6033-41d0-8536-f322c6860143 (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:49,362", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=cd62e4fc-6033-41d0-8536-f322c6860143, action=LOGIN, entity=user:cd62e4fc-6033-41d0-8536-f322c6860143, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:49,365", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: cd62e4fc-6033-41d0-8536-f322c6860143 (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:49,365", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.085s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:49,365", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:49,482", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: b84a8a13-61f7-49c3-931e-694af7aede06 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:49,514", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=b84a8a13-61f7-49c3-931e-694af7aede06, action=LOGIN, entity=user:b84a8a13-61f7-49c3-931e-694af7aede06, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:49,516", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: b84a8a13-61f7-49c3-931e-694af7aede06 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:49,517", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.082s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:49,517", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:49,547", "name": "src.services.account_type_service", "levelname": "INFO", "filename": "account_type_service.py", "lineno": 121, "funcName": "create_account_type", "message": "Account type created: 2ad9d4d0-1495-443f-97a1-a54a33bd20b0 ('case_test') by admin b84a8a13-61f7-49c3-931e-694af7aede06", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:49,576", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=b84a8a13-61f7-49c3-931e-694af7aede06, action=CREATE_ACCOUNT_TYPE, entity=account_type:2ad9d4d0-1495-443f-97a1-a54a33bd20b0, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:49,578", "name": "src.middleware", "levelname": "ERROR", "filename": "middleware.py", "lineno": 186, "funcName": "dispatch", "message": "Request failed: POST /api/v1/account-types - request_id=unknown client=127.0.0.1 duration=0.060s error=1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:49,590", "name": "src.main", "levelname": "ERROR", "filename": "main.py", "lineno": 201, "funcName": "general_exception_handler", "message": "Unexpected error: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing (request_id=663b410d-7228-4bc1-aa32-7ba15850c612)", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
____________ TestAccountTypeRoutes.test_update_account_type_success ____________
  + Exception Group Traceback (most recent call last):
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 246, in <lambda>
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 604, in test_update_account_type_success
    |     create_response = await async_client.post(
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<7 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...<13 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<4 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    |     return await service.create_account_type(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<5 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    |     return AccountTypeResponse.model_validate(account_type)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    |     return cls.__pydantic_validator__.validate_python(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         obj,
    |         ^^^^
    |     ...<5 lines>...
    |         by_name=by_name,
    |         ^^^^^^^^^^^^^^^^
    |     )
    |     ^
    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
    | icon_url
    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 604, in test_update_account_type_success
    create_response = await async_client.post(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    return await service.create_account_type(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        obj,
        ^^^^
    ...<5 lines>...
        by_name=by_name,
        ^^^^^^^^^^^^^^^^
    )
    ^
pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
icon_url
  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing

The above exception was the direct cause of the following exception:
tests/integration/test_account_type_routes.py:604: in test_update_account_type_success
    create_response = await async_client.post(
.venv/lib/python3.13/site-packages/httpx/_client.py:1859: in post
    return await self.request(
.venv/lib/python3.13/site-packages/httpx/_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1629: in send
    response = await self._send_handling_auth(
.venv/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
.venv/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/applications.py:1134: in __call__
    await super().__call__(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
.venv/lib/python3.13/site-packages/starlette/middleware/cors.py:85: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:102: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:182: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:56: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:736: in app
    await route.handle(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:290: in handle
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/routing.py:124: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/routing.py:110: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/fastapi/routing.py:390: in app
    raw_response = await run_endpoint_function(
.venv/lib/python3.13/site-packages/fastapi/routing.py:289: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/api/routes/account_types.py:66: in create_account_type
    return await service.create_account_type(
src/services/account_type_service.py:141: in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
E   icon_url
E     Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:50,126", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:50,263", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 62aaee83-00fe-4e17-a8c7-58ae1dd073f2 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:50,296", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=62aaee83-00fe-4e17-a8c7-58ae1dd073f2, action=LOGIN, entity=user:62aaee83-00fe-4e17-a8c7-58ae1dd073f2, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:50,298", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 62aaee83-00fe-4e17-a8c7-58ae1dd073f2 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:50,299", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.087s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:50,300", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:50,331", "name": "src.services.account_type_service", "levelname": "INFO", "filename": "account_type_service.py", "lineno": 121, "funcName": "create_account_type", "message": "Account type created: 6834d301-2e57-4ca1-9948-bfedb9a13a76 ('update_test') by admin 62aaee83-00fe-4e17-a8c7-58ae1dd073f2", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:50,360", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=62aaee83-00fe-4e17-a8c7-58ae1dd073f2, action=CREATE_ACCOUNT_TYPE, entity=account_type:6834d301-2e57-4ca1-9948-bfedb9a13a76, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:50,363", "name": "src.middleware", "levelname": "ERROR", "filename": "middleware.py", "lineno": 186, "funcName": "dispatch", "message": "Request failed: POST /api/v1/account-types - request_id=unknown client=127.0.0.1 duration=0.062s error=1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:50,375", "name": "src.main", "levelname": "ERROR", "filename": "main.py", "lineno": 201, "funcName": "general_exception_handler", "message": "Unexpected error: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing (request_id=1d4ae307-102d-40a6-81f3-337ee291b7c3)", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
____________ TestAccountTypeRoutes.test_update_account_type_partial ____________
  + Exception Group Traceback (most recent call last):
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 246, in <lambda>
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 642, in test_update_account_type_partial
    |     create_response = await async_client.post(
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<7 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...<13 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<4 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    |     return await service.create_account_type(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<5 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    |     return AccountTypeResponse.model_validate(account_type)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    |     return cls.__pydantic_validator__.validate_python(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         obj,
    |         ^^^^
    |     ...<5 lines>...
    |         by_name=by_name,
    |         ^^^^^^^^^^^^^^^^
    |     )
    |     ^
    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
    | icon_url
    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 642, in test_update_account_type_partial
    create_response = await async_client.post(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    return await service.create_account_type(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        obj,
        ^^^^
    ...<5 lines>...
        by_name=by_name,
        ^^^^^^^^^^^^^^^^
    )
    ^
pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
icon_url
  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing

The above exception was the direct cause of the following exception:
tests/integration/test_account_type_routes.py:642: in test_update_account_type_partial
    create_response = await async_client.post(
.venv/lib/python3.13/site-packages/httpx/_client.py:1859: in post
    return await self.request(
.venv/lib/python3.13/site-packages/httpx/_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1629: in send
    response = await self._send_handling_auth(
.venv/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
.venv/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/applications.py:1134: in __call__
    await super().__call__(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
.venv/lib/python3.13/site-packages/starlette/middleware/cors.py:85: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:102: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:182: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:56: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:736: in app
    await route.handle(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:290: in handle
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/routing.py:124: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/routing.py:110: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/fastapi/routing.py:390: in app
    raw_response = await run_endpoint_function(
.venv/lib/python3.13/site-packages/fastapi/routing.py:289: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/api/routes/account_types.py:66: in create_account_type
    return await service.create_account_type(
src/services/account_type_service.py:141: in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
E   icon_url
E     Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:50,620", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:50,755", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 57ce2ed1-d767-406d-9826-87e0476c21e6 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:50,787", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=57ce2ed1-d767-406d-9826-87e0476c21e6, action=LOGIN, entity=user:57ce2ed1-d767-406d-9826-87e0476c21e6, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:50,790", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 57ce2ed1-d767-406d-9826-87e0476c21e6 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:50,790", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.084s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:50,790", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:50,818", "name": "src.services.account_type_service", "levelname": "INFO", "filename": "account_type_service.py", "lineno": 121, "funcName": "create_account_type", "message": "Account type created: bbf4bee9-78ab-4efb-8b17-a57945e94305 ('partial_update') by admin 57ce2ed1-d767-406d-9826-87e0476c21e6", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:50,849", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=57ce2ed1-d767-406d-9826-87e0476c21e6, action=CREATE_ACCOUNT_TYPE, entity=account_type:bbf4bee9-78ab-4efb-8b17-a57945e94305, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:50,852", "name": "src.middleware", "levelname": "ERROR", "filename": "middleware.py", "lineno": 186, "funcName": "dispatch", "message": "Request failed: POST /api/v1/account-types - request_id=unknown client=127.0.0.1 duration=0.061s error=1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:50,865", "name": "src.main", "levelname": "ERROR", "filename": "main.py", "lineno": 201, "funcName": "general_exception_handler", "message": "Unexpected error: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing (request_id=df07401c-459c-421b-8648-05ae7f1087b2)", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
_____ TestAccountTypeRoutes.test_update_account_type_deactivate_via_update _____
  + Exception Group Traceback (most recent call last):
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 246, in <lambda>
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 672, in test_update_account_type_deactivate_via_update
    |     create_response = await async_client.post(
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<6 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...<13 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<4 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    |     return await service.create_account_type(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<5 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    |     return AccountTypeResponse.model_validate(account_type)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    |     return cls.__pydantic_validator__.validate_python(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         obj,
    |         ^^^^
    |     ...<5 lines>...
    |         by_name=by_name,
    |         ^^^^^^^^^^^^^^^^
    |     )
    |     ^
    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
    | icon_url
    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 672, in test_update_account_type_deactivate_via_update
    create_response = await async_client.post(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    return await service.create_account_type(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        obj,
        ^^^^
    ...<5 lines>...
        by_name=by_name,
        ^^^^^^^^^^^^^^^^
    )
    ^
pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
icon_url
  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing

The above exception was the direct cause of the following exception:
tests/integration/test_account_type_routes.py:672: in test_update_account_type_deactivate_via_update
    create_response = await async_client.post(
.venv/lib/python3.13/site-packages/httpx/_client.py:1859: in post
    return await self.request(
.venv/lib/python3.13/site-packages/httpx/_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1629: in send
    response = await self._send_handling_auth(
.venv/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
.venv/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/applications.py:1134: in __call__
    await super().__call__(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
.venv/lib/python3.13/site-packages/starlette/middleware/cors.py:85: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:102: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:182: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:56: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:736: in app
    await route.handle(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:290: in handle
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/routing.py:124: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/routing.py:110: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/fastapi/routing.py:390: in app
    raw_response = await run_endpoint_function(
.venv/lib/python3.13/site-packages/fastapi/routing.py:289: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/api/routes/account_types.py:66: in create_account_type
    return await service.create_account_type(
src/services/account_type_service.py:141: in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
E   icon_url
E     Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:51,113", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:51,250", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 42676bc7-f710-4557-8ec8-9d6eefb89dfc (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:51,283", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=42676bc7-f710-4557-8ec8-9d6eefb89dfc, action=LOGIN, entity=user:42676bc7-f710-4557-8ec8-9d6eefb89dfc, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:51,285", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 42676bc7-f710-4557-8ec8-9d6eefb89dfc (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:51,285", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.085s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:51,286", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:51,313", "name": "src.services.account_type_service", "levelname": "INFO", "filename": "account_type_service.py", "lineno": 121, "funcName": "create_account_type", "message": "Account type created: 48a776c2-ac8d-4b5d-b44d-66af352225ea ('deactivate_via_update') by admin 42676bc7-f710-4557-8ec8-9d6eefb89dfc", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:51,343", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=42676bc7-f710-4557-8ec8-9d6eefb89dfc, action=CREATE_ACCOUNT_TYPE, entity=account_type:48a776c2-ac8d-4b5d-b44d-66af352225ea, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:51,346", "name": "src.middleware", "levelname": "ERROR", "filename": "middleware.py", "lineno": 186, "funcName": "dispatch", "message": "Request failed: POST /api/v1/account-types - request_id=unknown client=127.0.0.1 duration=0.060s error=1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:51,358", "name": "src.main", "levelname": "ERROR", "filename": "main.py", "lineno": 201, "funcName": "general_exception_handler", "message": "Unexpected error: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing (request_id=b9b41e52-5fe2-42c5-9dcc-93f1ba0157c6)", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
______ TestAccountTypeRoutes.test_update_account_type_non_admin_forbidden ______
  + Exception Group Traceback (most recent call last):
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 246, in <lambda>
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 711, in test_update_account_type_non_admin_forbidden
    |     create_response = await async_client.post(
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<6 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...<13 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<4 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    |     return await service.create_account_type(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<5 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    |     return AccountTypeResponse.model_validate(account_type)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    |     return cls.__pydantic_validator__.validate_python(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         obj,
    |         ^^^^
    |     ...<5 lines>...
    |         by_name=by_name,
    |         ^^^^^^^^^^^^^^^^
    |     )
    |     ^
    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
    | icon_url
    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 711, in test_update_account_type_non_admin_forbidden
    create_response = await async_client.post(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    return await service.create_account_type(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        obj,
        ^^^^
    ...<5 lines>...
        by_name=by_name,
        ^^^^^^^^^^^^^^^^
    )
    ^
pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
icon_url
  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing

The above exception was the direct cause of the following exception:
tests/integration/test_account_type_routes.py:711: in test_update_account_type_non_admin_forbidden
    create_response = await async_client.post(
.venv/lib/python3.13/site-packages/httpx/_client.py:1859: in post
    return await self.request(
.venv/lib/python3.13/site-packages/httpx/_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1629: in send
    response = await self._send_handling_auth(
.venv/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
.venv/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/applications.py:1134: in __call__
    await super().__call__(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
.venv/lib/python3.13/site-packages/starlette/middleware/cors.py:85: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:102: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:182: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:56: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:736: in app
    await route.handle(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:290: in handle
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/routing.py:124: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/routing.py:110: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/fastapi/routing.py:390: in app
    raw_response = await run_endpoint_function(
.venv/lib/python3.13/site-packages/fastapi/routing.py:289: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/api/routes/account_types.py:66: in create_account_type
    return await service.create_account_type(
src/services/account_type_service.py:141: in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
E   icon_url
E     Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:51,886", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:52,021", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 8c2be8f6-a1a3-47f7-900a-0f0327028bf9 (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:52,053", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=8c2be8f6-a1a3-47f7-900a-0f0327028bf9, action=LOGIN, entity=user:8c2be8f6-a1a3-47f7-900a-0f0327028bf9, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:52,055", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 8c2be8f6-a1a3-47f7-900a-0f0327028bf9 (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:52,055", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.084s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:52,056", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:52,173", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: e7208ede-d87a-44c1-9c25-4263a9e3e663 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:52,207", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=e7208ede-d87a-44c1-9c25-4263a9e3e663, action=LOGIN, entity=user:e7208ede-d87a-44c1-9c25-4263a9e3e663, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:52,210", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: e7208ede-d87a-44c1-9c25-4263a9e3e663 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:52,210", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.085s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:52,210", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:52,238", "name": "src.services.account_type_service", "levelname": "INFO", "filename": "account_type_service.py", "lineno": 121, "funcName": "create_account_type", "message": "Account type created: 5fd50345-8ad7-496c-9a85-e2643df1e502 ('no_update') by admin e7208ede-d87a-44c1-9c25-4263a9e3e663", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:52,267", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=e7208ede-d87a-44c1-9c25-4263a9e3e663, action=CREATE_ACCOUNT_TYPE, entity=account_type:5fd50345-8ad7-496c-9a85-e2643df1e502, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:52,270", "name": "src.middleware", "levelname": "ERROR", "filename": "middleware.py", "lineno": 186, "funcName": "dispatch", "message": "Request failed: POST /api/v1/account-types - request_id=unknown client=127.0.0.1 duration=0.059s error=1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:52,283", "name": "src.main", "levelname": "ERROR", "filename": "main.py", "lineno": 201, "funcName": "general_exception_handler", "message": "Unexpected error: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing (request_id=4ec360b8-efee-4ba8-9b18-2ba4c0db42ef)", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
__________ TestAccountTypeRoutes.test_deactivate_account_type_success __________
  + Exception Group Traceback (most recent call last):
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 246, in <lambda>
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 740, in test_deactivate_account_type_success
    |     create_response = await async_client.post(
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<6 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...<13 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<4 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    |     return await service.create_account_type(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<5 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    |     return AccountTypeResponse.model_validate(account_type)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    |     return cls.__pydantic_validator__.validate_python(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         obj,
    |         ^^^^
    |     ...<5 lines>...
    |         by_name=by_name,
    |         ^^^^^^^^^^^^^^^^
    |     )
    |     ^
    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
    | icon_url
    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 740, in test_deactivate_account_type_success
    create_response = await async_client.post(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    return await service.create_account_type(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        obj,
        ^^^^
    ...<5 lines>...
        by_name=by_name,
        ^^^^^^^^^^^^^^^^
    )
    ^
pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
icon_url
  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing

The above exception was the direct cause of the following exception:
tests/integration/test_account_type_routes.py:740: in test_deactivate_account_type_success
    create_response = await async_client.post(
.venv/lib/python3.13/site-packages/httpx/_client.py:1859: in post
    return await self.request(
.venv/lib/python3.13/site-packages/httpx/_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1629: in send
    response = await self._send_handling_auth(
.venv/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
.venv/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/applications.py:1134: in __call__
    await super().__call__(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
.venv/lib/python3.13/site-packages/starlette/middleware/cors.py:85: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:102: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:182: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:56: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:736: in app
    await route.handle(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:290: in handle
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/routing.py:124: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/routing.py:110: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/fastapi/routing.py:390: in app
    raw_response = await run_endpoint_function(
.venv/lib/python3.13/site-packages/fastapi/routing.py:289: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/api/routes/account_types.py:66: in create_account_type
    return await service.create_account_type(
src/services/account_type_service.py:141: in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
E   icon_url
E     Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:52,525", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:52,656", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: e6aec5af-6d2c-432d-975c-93c82e62b345 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:52,690", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=e6aec5af-6d2c-432d-975c-93c82e62b345, action=LOGIN, entity=user:e6aec5af-6d2c-432d-975c-93c82e62b345, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:52,692", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: e6aec5af-6d2c-432d-975c-93c82e62b345 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:52,693", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.084s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:52,693", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:52,720", "name": "src.services.account_type_service", "levelname": "INFO", "filename": "account_type_service.py", "lineno": 121, "funcName": "create_account_type", "message": "Account type created: 752173d9-18f5-457e-b9c0-62e9b89967e6 ('deactivate_test') by admin e6aec5af-6d2c-432d-975c-93c82e62b345", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:52,751", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=e6aec5af-6d2c-432d-975c-93c82e62b345, action=CREATE_ACCOUNT_TYPE, entity=account_type:752173d9-18f5-457e-b9c0-62e9b89967e6, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:52,754", "name": "src.middleware", "levelname": "ERROR", "filename": "middleware.py", "lineno": 186, "funcName": "dispatch", "message": "Request failed: POST /api/v1/account-types - request_id=unknown client=127.0.0.1 duration=0.060s error=1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:52,766", "name": "src.main", "levelname": "ERROR", "filename": "main.py", "lineno": 201, "funcName": "general_exception_handler", "message": "Unexpected error: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing (request_id=6b358d33-282c-4d02-a176-c1b719b9fd87)", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
_____ TestAccountTypeRoutes.test_deactivate_account_type_already_inactive ______
  + Exception Group Traceback (most recent call last):
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 246, in <lambda>
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 765, in test_deactivate_account_type_already_inactive
    |     create_response = await async_client.post(
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<6 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...<13 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<4 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    |     return await service.create_account_type(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<5 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    |     return AccountTypeResponse.model_validate(account_type)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    |     return cls.__pydantic_validator__.validate_python(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         obj,
    |         ^^^^
    |     ...<5 lines>...
    |         by_name=by_name,
    |         ^^^^^^^^^^^^^^^^
    |     )
    |     ^
    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
    | icon_url
    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 765, in test_deactivate_account_type_already_inactive
    create_response = await async_client.post(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    return await service.create_account_type(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        obj,
        ^^^^
    ...<5 lines>...
        by_name=by_name,
        ^^^^^^^^^^^^^^^^
    )
    ^
pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
icon_url
  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing

The above exception was the direct cause of the following exception:
tests/integration/test_account_type_routes.py:765: in test_deactivate_account_type_already_inactive
    create_response = await async_client.post(
.venv/lib/python3.13/site-packages/httpx/_client.py:1859: in post
    return await self.request(
.venv/lib/python3.13/site-packages/httpx/_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1629: in send
    response = await self._send_handling_auth(
.venv/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
.venv/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/applications.py:1134: in __call__
    await super().__call__(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
.venv/lib/python3.13/site-packages/starlette/middleware/cors.py:85: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:102: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:182: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:56: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:736: in app
    await route.handle(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:290: in handle
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/routing.py:124: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/routing.py:110: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/fastapi/routing.py:390: in app
    raw_response = await run_endpoint_function(
.venv/lib/python3.13/site-packages/fastapi/routing.py:289: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/api/routes/account_types.py:66: in create_account_type
    return await service.create_account_type(
src/services/account_type_service.py:141: in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
E   icon_url
E     Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:53,014", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:53,151", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: dd23a258-25a3-48b7-9191-b801282ee8bc (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:53,183", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=dd23a258-25a3-48b7-9191-b801282ee8bc, action=LOGIN, entity=user:dd23a258-25a3-48b7-9191-b801282ee8bc, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:53,186", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: dd23a258-25a3-48b7-9191-b801282ee8bc (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:53,186", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.084s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:53,187", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:53,216", "name": "src.services.account_type_service", "levelname": "INFO", "filename": "account_type_service.py", "lineno": 121, "funcName": "create_account_type", "message": "Account type created: 11b7cbb4-e37c-4fb7-aa1f-c0d824cd54e2 ('already_inactive') by admin dd23a258-25a3-48b7-9191-b801282ee8bc", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:53,246", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=dd23a258-25a3-48b7-9191-b801282ee8bc, action=CREATE_ACCOUNT_TYPE, entity=account_type:11b7cbb4-e37c-4fb7-aa1f-c0d824cd54e2, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:53,249", "name": "src.middleware", "levelname": "ERROR", "filename": "middleware.py", "lineno": 186, "funcName": "dispatch", "message": "Request failed: POST /api/v1/account-types - request_id=unknown client=127.0.0.1 duration=0.061s error=1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:53,261", "name": "src.main", "levelname": "ERROR", "filename": "main.py", "lineno": 201, "funcName": "general_exception_handler", "message": "Unexpected error: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing (request_id=e95ea601-7c19-4415-97a2-6e199533eae5)", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
____ TestAccountTypeRoutes.test_deactivate_account_type_non_admin_forbidden ____
  + Exception Group Traceback (most recent call last):
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 246, in <lambda>
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 790, in test_deactivate_account_type_non_admin_forbidden
    |     create_response = await async_client.post(
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<6 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...<13 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<4 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    |     return await service.create_account_type(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<5 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    |     return AccountTypeResponse.model_validate(account_type)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    |     return cls.__pydantic_validator__.validate_python(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         obj,
    |         ^^^^
    |     ...<5 lines>...
    |         by_name=by_name,
    |         ^^^^^^^^^^^^^^^^
    |     )
    |     ^
    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
    | icon_url
    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_account_type_routes.py", line 790, in test_deactivate_account_type_non_admin_forbidden
    create_response = await async_client.post(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py", line 66, in create_account_type
    return await service.create_account_type(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py", line 141, in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        obj,
        ^^^^
    ...<5 lines>...
        by_name=by_name,
        ^^^^^^^^^^^^^^^^
    )
    ^
pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
icon_url
  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing

The above exception was the direct cause of the following exception:
tests/integration/test_account_type_routes.py:790: in test_deactivate_account_type_non_admin_forbidden
    create_response = await async_client.post(
.venv/lib/python3.13/site-packages/httpx/_client.py:1859: in post
    return await self.request(
.venv/lib/python3.13/site-packages/httpx/_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1629: in send
    response = await self._send_handling_auth(
.venv/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
.venv/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/applications.py:1134: in __call__
    await super().__call__(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
.venv/lib/python3.13/site-packages/starlette/middleware/cors.py:85: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:102: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:182: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:56: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:736: in app
    await route.handle(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:290: in handle
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/routing.py:124: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/routing.py:110: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/fastapi/routing.py:390: in app
    raw_response = await run_endpoint_function(
.venv/lib/python3.13/site-packages/fastapi/routing.py:289: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/api/routes/account_types.py:66: in create_account_type
    return await service.create_account_type(
src/services/account_type_service.py:141: in create_account_type
    return AccountTypeResponse.model_validate(account_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse
E   icon_url
E     Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.12/v/url_parsing
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:21:53,503", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:53,642", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 31ea35ae-0b54-47db-ad32-b72f5f73afb9 (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:53,679", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=31ea35ae-0b54-47db-ad32-b72f5f73afb9, action=LOGIN, entity=user:31ea35ae-0b54-47db-ad32-b72f5f73afb9, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:53,681", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 31ea35ae-0b54-47db-ad32-b72f5f73afb9 (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:53,682", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.091s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:53,682", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:53,801", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 82328ced-32fb-4340-90c9-c096755ca5a1 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:53,833", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=82328ced-32fb-4340-90c9-c096755ca5a1, action=LOGIN, entity=user:82328ced-32fb-4340-90c9-c096755ca5a1, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:53,836", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 82328ced-32fb-4340-90c9-c096755ca5a1 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:53,836", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.084s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:53,836", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:21:53,866", "name": "src.services.account_type_service", "levelname": "INFO", "filename": "account_type_service.py", "lineno": 121, "funcName": "create_account_type", "message": "Account type created: d9bce789-57dc-468b-8a88-6b94970b9b01 ('no_deactivate') by admin 82328ced-32fb-4340-90c9-c096755ca5a1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:53,899", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=82328ced-32fb-4340-90c9-c096755ca5a1, action=CREATE_ACCOUNT_TYPE, entity=account_type:d9bce789-57dc-468b-8a88-6b94970b9b01, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:53,902", "name": "src.middleware", "levelname": "ERROR", "filename": "middleware.py", "lineno": 186, "funcName": "dispatch", "message": "Request failed: POST /api/v1/account-types - request_id=unknown client=127.0.0.1 duration=0.065s error=1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:21:53,915", "name": "src.main", "levelname": "ERROR", "filename": "main.py", "lineno": 201, "funcName": "general_exception_handler", "message": "Unexpected error: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing (request_id=9b512552-9588-4d7c-af39-ace5edf905be)", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    |     return await service.create_account_type(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    |     return AccountTypeResponse.model_validate(account_type)\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    |     return cls.__pydantic_validator__.validate_python(\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n    |         obj,\n    |         ^^^^\n    |     ...<5 lines>...\n    |         by_name=by_name,\n    |         ^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    | pydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\n    | icon_url\n    |   Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    |     For further information visit https://errors.pydantic.dev/2.12/v/url_parsing\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/account_types.py\", line 66, in create_account_type\n    return await service.create_account_type(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/account_type_service.py\", line 141, in create_account_type\n    return AccountTypeResponse.model_validate(account_type)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pydantic/main.py\", line 716, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj,\n        ^^^^\n    ...<5 lines>...\n        by_name=by_name,\n        ^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AccountTypeResponse\nicon_url\n  Input should be a valid URL, relative URL without a base [type=url_parsing, input_value='None', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/url_parsing", "correlation_id": "no-request-id"}
__ TestFinancialInstitutionRoutes.test_update_institution_swift_code_conflict __
  + Exception Group Traceback (most recent call last):
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 246, in <lambda>
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_financial_institution_routes.py", line 606, in test_update_institution_swift_code_conflict
    |     create_response = await async_client.post(
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<9 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...<13 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<4 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/financial_institutions.py", line 71, in create_institution
    |     return await service.create_institution(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<5 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/financial_institution_service.py", line 106, in create_institution
    |     exists = await self.institution_repo.exists_by_swift_code(data.swift_code)
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/repositories/financial_institution_repository.py", line 237, in exists_by_swift_code
    |     return result.scalar_one_or_none() is not None
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/result.py", line 1492, in scalar_one_or_none
    |     return self._only_one_row(
    |            ~~~~~~~~~~~~~~~~~~^
    |         raise_for_second_row=True, raise_for_none=False, scalar=True
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/result.py", line 813, in _only_one_row
    |     raise exc.MultipleResultsFound(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.MultipleResultsFound: Multiple rows were found when one or none was required
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_financial_institution_routes.py", line 606, in test_update_institution_swift_code_conflict
    create_response = await async_client.post(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<9 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/financial_institutions.py", line 71, in create_institution
    return await service.create_institution(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/financial_institution_service.py", line 106, in create_institution
    exists = await self.institution_repo.exists_by_swift_code(data.swift_code)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/repositories/financial_institution_repository.py", line 237, in exists_by_swift_code
    return result.scalar_one_or_none() is not None
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/result.py", line 1492, in scalar_one_or_none
    return self._only_one_row(
           ~~~~~~~~~~~~~~~~~~^
        raise_for_second_row=True, raise_for_none=False, scalar=True
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/result.py", line 813, in _only_one_row
    raise exc.MultipleResultsFound(
    ...<4 lines>...
    )
sqlalchemy.exc.MultipleResultsFound: Multiple rows were found when one or none was required

The above exception was the direct cause of the following exception:
tests/integration/test_financial_institution_routes.py:606: in test_update_institution_swift_code_conflict
    create_response = await async_client.post(
.venv/lib/python3.13/site-packages/httpx/_client.py:1859: in post
    return await self.request(
.venv/lib/python3.13/site-packages/httpx/_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1629: in send
    response = await self._send_handling_auth(
.venv/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
.venv/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/applications.py:1134: in __call__
    await super().__call__(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
.venv/lib/python3.13/site-packages/starlette/middleware/cors.py:85: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:102: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:182: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:56: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:736: in app
    await route.handle(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:290: in handle
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/routing.py:124: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/routing.py:110: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/fastapi/routing.py:390: in app
    raw_response = await run_endpoint_function(
.venv/lib/python3.13/site-packages/fastapi/routing.py:289: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/api/routes/financial_institutions.py:71: in create_institution
    return await service.create_institution(
src/services/financial_institution_service.py:106: in create_institution
    exists = await self.institution_repo.exists_by_swift_code(data.swift_code)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/repositories/financial_institution_repository.py:237: in exists_by_swift_code
    return result.scalar_one_or_none() is not None
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/engine/result.py:1492: in scalar_one_or_none
    return self._only_one_row(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/result.py:813: in _only_one_row
    raise exc.MultipleResultsFound(
E   sqlalchemy.exc.MultipleResultsFound: Multiple rows were found when one or none was required
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:22:17,865", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:18,001", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: ba7855dc-ef66-408b-86c8-46ed84441e75 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:18,035", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=ba7855dc-ef66-408b-86c8-46ed84441e75, action=LOGIN, entity=user:ba7855dc-ef66-408b-86c8-46ed84441e75, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:18,038", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: ba7855dc-ef66-408b-86c8-46ed84441e75 (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:18,038", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.086s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:18,039", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:22:18,063", "name": "src.services.financial_institution_service", "levelname": "WARNING", "filename": "financial_institution_service.py", "lineno": 108, "funcName": "create_institution", "message": "Institution creation failed: SWIFT code BOFAUS3N already exists", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:18,066", "name": "src.main", "levelname": "WARNING", "filename": "main.py", "lineno": 133, "funcName": "app_exception_handler", "message": "Application exception: ALREADY_EXISTS - Institution with SWIFT code BOFAUS3N already exists already exists (request_id=ef02e6b0-b532-450e-8ac4-5ab57ab19d12)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:18,066", "name": "src.middleware", "levelname": "WARNING", "filename": "middleware.py", "lineno": 208, "funcName": "dispatch", "message": "POST /api/v1/financial-institutions 409 - request_id=unknown client=127.0.0.1 duration=0.027s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:18,067", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/financial-institutions \"HTTP/1.1 409 Conflict\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:18,093", "name": "src.middleware", "levelname": "ERROR", "filename": "middleware.py", "lineno": 186, "funcName": "dispatch", "message": "Request failed: POST /api/v1/financial-institutions - request_id=unknown client=127.0.0.1 duration=0.027s error=Multiple rows were found when one or none was required", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/financial_institutions.py\", line 71, in create_institution\n    |     return await service.create_institution(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/financial_institution_service.py\", line 106, in create_institution\n    |     exists = await self.institution_repo.exists_by_swift_code(data.swift_code)\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/repositories/financial_institution_repository.py\", line 237, in exists_by_swift_code\n    |     return result.scalar_one_or_none() is not None\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/result.py\", line 1492, in scalar_one_or_none\n    |     return self._only_one_row(\n    |            ~~~~~~~~~~~~~~~~~~^\n    |         raise_for_second_row=True, raise_for_none=False, scalar=True\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/result.py\", line 813, in _only_one_row\n    |     raise exc.MultipleResultsFound(\n    |     ...<4 lines>...\n    |     )\n    | sqlalchemy.exc.MultipleResultsFound: Multiple rows were found when one or none was required\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/financial_institutions.py\", line 71, in create_institution\n    return await service.create_institution(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/financial_institution_service.py\", line 106, in create_institution\n    exists = await self.institution_repo.exists_by_swift_code(data.swift_code)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/repositories/financial_institution_repository.py\", line 237, in exists_by_swift_code\n    return result.scalar_one_or_none() is not None\n           ~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/result.py\", line 1492, in scalar_one_or_none\n    return self._only_one_row(\n           ~~~~~~~~~~~~~~~~~~^\n        raise_for_second_row=True, raise_for_none=False, scalar=True\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/result.py\", line 813, in _only_one_row\n    raise exc.MultipleResultsFound(\n    ...<4 lines>...\n    )\nsqlalchemy.exc.MultipleResultsFound: Multiple rows were found when one or none was required", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:18,110", "name": "src.main", "levelname": "ERROR", "filename": "main.py", "lineno": 201, "funcName": "general_exception_handler", "message": "Unexpected error: Multiple rows were found when one or none was required (request_id=fc4a8a1f-751f-4aa9-8f6f-fde6bcfbd855)", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/financial_institutions.py\", line 71, in create_institution\n    |     return await service.create_institution(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/financial_institution_service.py\", line 106, in create_institution\n    |     exists = await self.institution_repo.exists_by_swift_code(data.swift_code)\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/repositories/financial_institution_repository.py\", line 237, in exists_by_swift_code\n    |     return result.scalar_one_or_none() is not None\n    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/result.py\", line 1492, in scalar_one_or_none\n    |     return self._only_one_row(\n    |            ~~~~~~~~~~~~~~~~~~^\n    |         raise_for_second_row=True, raise_for_none=False, scalar=True\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/result.py\", line 813, in _only_one_row\n    |     raise exc.MultipleResultsFound(\n    |     ...<4 lines>...\n    |     )\n    | sqlalchemy.exc.MultipleResultsFound: Multiple rows were found when one or none was required\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/financial_institutions.py\", line 71, in create_institution\n    return await service.create_institution(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/financial_institution_service.py\", line 106, in create_institution\n    exists = await self.institution_repo.exists_by_swift_code(data.swift_code)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/repositories/financial_institution_repository.py\", line 237, in exists_by_swift_code\n    return result.scalar_one_or_none() is not None\n           ~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/result.py\", line 1492, in scalar_one_or_none\n    return self._only_one_row(\n           ~~~~~~~~~~~~~~~~~~^\n        raise_for_second_row=True, raise_for_none=False, scalar=True\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/sqlalchemy/engine/result.py\", line 813, in _only_one_row\n    raise exc.MultipleResultsFound(\n    ...<4 lines>...\n    )\nsqlalchemy.exc.MultipleResultsFound: Multiple rows were found when one or none was required", "correlation_id": "no-request-id"}
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/financial-institutions "HTTP/1.1 409 Conflict"
______ TestFinancialInstitutionRoutes.test_deactivate_institution_success ______
tests/integration/test_financial_institution_routes.py:684: in test_deactivate_institution_success
    assert response.status_code == 200
E   assert 404 == 200
E    +  where 404 = <Response [404 Not Found]>.status_code
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:22:18,949", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:19,086", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 55c0a406-4a36-4f2c-94d7-161b2ae1a0bc (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:19,121", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=55c0a406-4a36-4f2c-94d7-161b2ae1a0bc, action=LOGIN, entity=user:55c0a406-4a36-4f2c-94d7-161b2ae1a0bc, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:19,123", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 55c0a406-4a36-4f2c-94d7-161b2ae1a0bc (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:19,124", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.088s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:19,124", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:22:19,158", "name": "src.services.financial_institution_service", "levelname": "INFO", "filename": "financial_institution_service.py", "lineno": 143, "funcName": "create_institution", "message": "Institution created: 1d286f83-099b-446f-afe1-63d5e15fab14 (DeactivateTest) by admin 55c0a406-4a36-4f2c-94d7-161b2ae1a0bc", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:19,189", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=55c0a406-4a36-4f2c-94d7-161b2ae1a0bc, action=CREATE_FINANCIAL_INSTITUTION, entity=financial_institution:1d286f83-099b-446f-afe1-63d5e15fab14, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:19,189", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/financial-institutions 201 - request_id=unknown client=127.0.0.1 duration=0.064s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:19,192", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/financial-institutions \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:19,192", "name": "src.middleware", "levelname": "WARNING", "filename": "middleware.py", "lineno": 208, "funcName": "dispatch", "message": "POST /api/v1/financial-institutions/1d286f83-099b-446f-afe1-63d5e15fab14/deactivate 404 - request_id=unknown client=127.0.0.1 duration=0.000s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:19,193", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/financial-institutions/1d286f83-099b-446f-afe1-63d5e15fab14/deactivate \"HTTP/1.1 404 Not Found\"", "correlation_id": "no-request-id"}
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/financial-institutions "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/financial-institutions/1d286f83-099b-446f-afe1-63d5e15fab14/deactivate "HTTP/1.1 404 Not Found"
_ TestFinancialInstitutionRoutes.test_deactivate_institution_non_admin_forbidden _
tests/integration/test_financial_institution_routes.py:711: in test_deactivate_institution_non_admin_forbidden
    assert response.status_code == 403
E   assert 404 == 403
E    +  where 404 = <Response [404 Not Found]>.status_code
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:22:19,288", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:19,425", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: ae6339e7-9fa7-427f-a16e-466317aedc25 (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:19,457", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=ae6339e7-9fa7-427f-a16e-466317aedc25, action=LOGIN, entity=user:ae6339e7-9fa7-427f-a16e-466317aedc25, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:19,459", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: ae6339e7-9fa7-427f-a16e-466317aedc25 (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:19,460", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.086s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:19,460", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:19,579", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 9ba8c511-0b4e-4600-8354-ba22b82f567f (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:19,611", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=9ba8c511-0b4e-4600-8354-ba22b82f567f, action=LOGIN, entity=user:9ba8c511-0b4e-4600-8354-ba22b82f567f, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:19,614", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 9ba8c511-0b4e-4600-8354-ba22b82f567f (admin@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:19,614", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.084s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:19,614", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:22:19,649", "name": "src.services.financial_institution_service", "levelname": "INFO", "filename": "financial_institution_service.py", "lineno": 143, "funcName": "create_institution", "message": "Institution created: 6a349132-bed3-49a0-8722-8510665f87f4 (NoDeactivate) by admin 9ba8c511-0b4e-4600-8354-ba22b82f567f", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:19,678", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=9ba8c511-0b4e-4600-8354-ba22b82f567f, action=CREATE_FINANCIAL_INSTITUTION, entity=financial_institution:6a349132-bed3-49a0-8722-8510665f87f4, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:19,679", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/financial-institutions 201 - request_id=unknown client=127.0.0.1 duration=0.064s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:19,682", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/financial-institutions \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:19,683", "name": "src.middleware", "levelname": "WARNING", "filename": "middleware.py", "lineno": 208, "funcName": "dispatch", "message": "POST /api/v1/financial-institutions/6a349132-bed3-49a0-8722-8510665f87f4/deactivate 404 - request_id=unknown client=127.0.0.1 duration=0.000s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:19,683", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/financial-institutions/6a349132-bed3-49a0-8722-8510665f87f4/deactivate \"HTTP/1.1 404 Not Found\"", "correlation_id": "no-request-id"}
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/financial-institutions "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/financial-institutions/6a349132-bed3-49a0-8722-8510665f87f4/deactivate "HTTP/1.1 404 Not Found"
__________________ TestTransactionAPI.test_delete_transaction __________________
  + Exception Group Traceback (most recent call last):
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 246, in <lambda>
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_transaction_api.py", line 163, in test_delete_transaction
    |     response = await async_client.delete(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<2 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1966, in delete
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...<9 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<4 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/transactions.py", line 320, in delete_transaction
    |     await transaction_service.delete_transaction(
    |     ...<5 lines>...
    |     )
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/transaction_service.py", line 751, in delete_transaction
    |     deleted = await self.transaction_repo.soft_delete(transaction_id)
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/repositories/base.py", line 190, in soft_delete
    |     raise AttributeError(f"{self.model.__name__} does not support soft delete")
    | AttributeError: Transaction does not support soft delete
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_transaction_api.py", line 163, in test_delete_transaction
    response = await async_client.delete(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1966, in delete
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...<9 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/transactions.py", line 320, in delete_transaction
    await transaction_service.delete_transaction(
    ...<5 lines>...
    )
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/transaction_service.py", line 751, in delete_transaction
    deleted = await self.transaction_repo.soft_delete(transaction_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/repositories/base.py", line 190, in soft_delete
    raise AttributeError(f"{self.model.__name__} does not support soft delete")
AttributeError: Transaction does not support soft delete

The above exception was the direct cause of the following exception:
tests/integration/test_transaction_api.py:163: in test_delete_transaction
    response = await async_client.delete(
.venv/lib/python3.13/site-packages/httpx/_client.py:1966: in delete
    return await self.request(
.venv/lib/python3.13/site-packages/httpx/_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1629: in send
    response = await self._send_handling_auth(
.venv/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
.venv/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/applications.py:1134: in __call__
    await super().__call__(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
.venv/lib/python3.13/site-packages/starlette/middleware/cors.py:85: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:102: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:182: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:56: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:736: in app
    await route.handle(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:290: in handle
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/routing.py:124: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/routing.py:110: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/fastapi/routing.py:390: in app
    raw_response = await run_endpoint_function(
.venv/lib/python3.13/site-packages/fastapi/routing.py:289: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/api/routes/transactions.py:320: in delete_transaction
    await transaction_service.delete_transaction(
src/services/transaction_service.py:751: in delete_transaction
    deleted = await self.transaction_repo.soft_delete(transaction_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/repositories/base.py:190: in soft_delete
    raise AttributeError(f"{self.model.__name__} does not support soft delete")
E   AttributeError: Transaction does not support soft delete
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:22:23,358", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:23,489", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: ae3d5f07-a722-4c62-95f7-9242db99762e (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:23,523", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=ae3d5f07-a722-4c62-95f7-9242db99762e, action=LOGIN, entity=user:ae3d5f07-a722-4c62-95f7-9242db99762e, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:23,525", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: ae3d5f07-a722-4c62-95f7-9242db99762e (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:23,525", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.085s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:23,526", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:22:23,732", "name": "src.services.transaction_service", "levelname": "INFO", "filename": "transaction_service.py", "lineno": 232, "funcName": "create_transaction", "message": "Created transaction 5824de9e-ed1c-470b-afa1-a019c2633dbe for account 85e69ac2-f8d2-48db-b0e6-d8f69c1899e8, updated balance: 1000.00 -> 975.00", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:23,740", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=ae3d5f07-a722-4c62-95f7-9242db99762e, action=CREATE, entity=transaction:5824de9e-ed1c-470b-afa1-a019c2633dbe, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:23,741", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/accounts/85e69ac2-f8d2-48db-b0e6-d8f69c1899e8/transactions 201 - request_id=unknown client=127.0.0.1 duration=0.067s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:23,744", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/accounts/85e69ac2-f8d2-48db-b0e6-d8f69c1899e8/transactions \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:23,800", "name": "src.middleware", "levelname": "ERROR", "filename": "middleware.py", "lineno": 186, "funcName": "dispatch", "message": "Request failed: DELETE /api/v1/transactions/5824de9e-ed1c-470b-afa1-a019c2633dbe - request_id=unknown client=127.0.0.1 duration=0.055s error=Transaction does not support soft delete", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/transactions.py\", line 320, in delete_transaction\n    |     await transaction_service.delete_transaction(\n    |     ...<5 lines>...\n    |     )\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/transaction_service.py\", line 751, in delete_transaction\n    |     deleted = await self.transaction_repo.soft_delete(transaction_id)\n    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/repositories/base.py\", line 190, in soft_delete\n    |     raise AttributeError(f\"{self.model.__name__} does not support soft delete\")\n    | AttributeError: Transaction does not support soft delete\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/transactions.py\", line 320, in delete_transaction\n    await transaction_service.delete_transaction(\n    ...<5 lines>...\n    )\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/transaction_service.py\", line 751, in delete_transaction\n    deleted = await self.transaction_repo.soft_delete(transaction_id)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/repositories/base.py\", line 190, in soft_delete\n    raise AttributeError(f\"{self.model.__name__} does not support soft delete\")\nAttributeError: Transaction does not support soft delete", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:23,814", "name": "src.main", "levelname": "ERROR", "filename": "main.py", "lineno": 201, "funcName": "general_exception_handler", "message": "Unexpected error: Transaction does not support soft delete (request_id=dc9a058f-1f2e-44fc-b7b8-64a3916d862c)", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/transactions.py\", line 320, in delete_transaction\n    |     await transaction_service.delete_transaction(\n    |     ...<5 lines>...\n    |     )\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/transaction_service.py\", line 751, in delete_transaction\n    |     deleted = await self.transaction_repo.soft_delete(transaction_id)\n    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/repositories/base.py\", line 190, in soft_delete\n    |     raise AttributeError(f\"{self.model.__name__} does not support soft delete\")\n    | AttributeError: Transaction does not support soft delete\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/transactions.py\", line 320, in delete_transaction\n    await transaction_service.delete_transaction(\n    ...<5 lines>...\n    )\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/transaction_service.py\", line 751, in delete_transaction\n    deleted = await self.transaction_repo.soft_delete(transaction_id)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/repositories/base.py\", line 190, in soft_delete\n    raise AttributeError(f\"{self.model.__name__} does not support soft delete\")\nAttributeError: Transaction does not support soft delete", "correlation_id": "no-request-id"}
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/accounts/85e69ac2-f8d2-48db-b0e6-d8f69c1899e8/transactions "HTTP/1.1 201 Created"
__________________ TestTransactionAPI.test_split_transaction ___________________
tests/integration/test_transaction_api.py:211: in test_split_transaction
    assert len(data["child_transactions"]) == 2
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
E   KeyError: 'child_transactions'
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:22:24,072", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:24,209", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 6896c883-9a9d-447d-9521-b90ac1cca985 (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:24,241", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=6896c883-9a9d-447d-9521-b90ac1cca985, action=LOGIN, entity=user:6896c883-9a9d-447d-9521-b90ac1cca985, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:24,243", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 6896c883-9a9d-447d-9521-b90ac1cca985 (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:24,244", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.083s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:24,244", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:22:24,449", "name": "src.services.transaction_service", "levelname": "INFO", "filename": "transaction_service.py", "lineno": 232, "funcName": "create_transaction", "message": "Created transaction 982a2189-e034-4be7-843e-be496fc76484 for account 2b5d4ac5-12cc-4afb-a168-95f47dbf7ae2, updated balance: 1000.00 -> 950.00", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:24,457", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=6896c883-9a9d-447d-9521-b90ac1cca985, action=CREATE, entity=transaction:982a2189-e034-4be7-843e-be496fc76484, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:24,458", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/accounts/2b5d4ac5-12cc-4afb-a168-95f47dbf7ae2/transactions 201 - request_id=unknown client=127.0.0.1 duration=0.067s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:24,461", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/accounts/2b5d4ac5-12cc-4afb-a168-95f47dbf7ae2/transactions \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:24,522", "name": "src.services.transaction_service", "levelname": "INFO", "filename": "transaction_service.py", "lineno": 901, "funcName": "split_transaction", "message": "Split transaction 982a2189-e034-4be7-843e-be496fc76484 into 2 children", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:24,529", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=6896c883-9a9d-447d-9521-b90ac1cca985, action=SPLIT_TRANSACTION, entity=transaction:982a2189-e034-4be7-843e-be496fc76484, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:24,530", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/transactions/982a2189-e034-4be7-843e-be496fc76484/split 200 - request_id=unknown client=127.0.0.1 duration=0.069s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:24,534", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/transactions/982a2189-e034-4be7-843e-be496fc76484/split \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/accounts/2b5d4ac5-12cc-4afb-a168-95f47dbf7ae2/transactions "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/transactions/982a2189-e034-4be7-843e-be496fc76484/split "HTTP/1.1 200 OK"
________________ TestTransactionAPI.test_join_split_transaction ________________
  + Exception Group Traceback (most recent call last):
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 246, in <lambda>
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_transaction_api.py", line 244, in test_join_split_transaction
    |     response = await async_client.post(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<2 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...<13 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<4 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/transactions.py", line 432, in join_split_transaction
    |     parent = await transaction_service.join_split_transaction(
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<5 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/transaction_service.py", line 997, in join_split_transaction
    |     await self.transaction_repo.soft_delete(child.id)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/repositories/base.py", line 190, in soft_delete
    |     raise AttributeError(f"{self.model.__name__} does not support soft delete")
    | AttributeError: Transaction does not support soft delete
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_transaction_api.py", line 244, in test_join_split_transaction
    response = await async_client.post(
               ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/transactions.py", line 432, in join_split_transaction
    parent = await transaction_service.join_split_transaction(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/transaction_service.py", line 997, in join_split_transaction
    await self.transaction_repo.soft_delete(child.id)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/repositories/base.py", line 190, in soft_delete
    raise AttributeError(f"{self.model.__name__} does not support soft delete")
AttributeError: Transaction does not support soft delete

The above exception was the direct cause of the following exception:
tests/integration/test_transaction_api.py:244: in test_join_split_transaction
    response = await async_client.post(
.venv/lib/python3.13/site-packages/httpx/_client.py:1859: in post
    return await self.request(
.venv/lib/python3.13/site-packages/httpx/_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1629: in send
    response = await self._send_handling_auth(
.venv/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
.venv/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/applications.py:1134: in __call__
    await super().__call__(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
.venv/lib/python3.13/site-packages/starlette/middleware/cors.py:85: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:102: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:182: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:56: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:736: in app
    await route.handle(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:290: in handle
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/routing.py:124: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/routing.py:110: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/fastapi/routing.py:390: in app
    raw_response = await run_endpoint_function(
.venv/lib/python3.13/site-packages/fastapi/routing.py:289: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/api/routes/transactions.py:432: in join_split_transaction
    parent = await transaction_service.join_split_transaction(
src/services/transaction_service.py:997: in join_split_transaction
    await self.transaction_repo.soft_delete(child.id)
src/repositories/base.py:190: in soft_delete
    raise AttributeError(f"{self.model.__name__} does not support soft delete")
E   AttributeError: Transaction does not support soft delete
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:22:24,634", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:24,769", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 6df03bc9-9776-4261-ae59-c65effe3d48d (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:24,801", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=6df03bc9-9776-4261-ae59-c65effe3d48d, action=LOGIN, entity=user:6df03bc9-9776-4261-ae59-c65effe3d48d, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:24,803", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 6df03bc9-9776-4261-ae59-c65effe3d48d (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:24,804", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.082s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:24,804", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:22:25,013", "name": "src.services.transaction_service", "levelname": "INFO", "filename": "transaction_service.py", "lineno": 232, "funcName": "create_transaction", "message": "Created transaction bc773b5c-a5f4-445a-8a4c-ed1f022ec4dd for account 9058548a-79b2-4807-a5c3-67cebd1c5208, updated balance: 1000.00 -> 950.00", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:25,021", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=6df03bc9-9776-4261-ae59-c65effe3d48d, action=CREATE, entity=transaction:bc773b5c-a5f4-445a-8a4c-ed1f022ec4dd, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:25,022", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/accounts/9058548a-79b2-4807-a5c3-67cebd1c5208/transactions 201 - request_id=unknown client=127.0.0.1 duration=0.068s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:25,026", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/accounts/9058548a-79b2-4807-a5c3-67cebd1c5208/transactions \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:25,084", "name": "src.services.transaction_service", "levelname": "INFO", "filename": "transaction_service.py", "lineno": 901, "funcName": "split_transaction", "message": "Split transaction bc773b5c-a5f4-445a-8a4c-ed1f022ec4dd into 2 children", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:25,090", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=6df03bc9-9776-4261-ae59-c65effe3d48d, action=SPLIT_TRANSACTION, entity=transaction:bc773b5c-a5f4-445a-8a4c-ed1f022ec4dd, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:25,092", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/transactions/bc773b5c-a5f4-445a-8a4c-ed1f022ec4dd/split 200 - request_id=unknown client=127.0.0.1 duration=0.066s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:25,095", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/transactions/bc773b5c-a5f4-445a-8a4c-ed1f022ec4dd/split \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:25,163", "name": "src.middleware", "levelname": "ERROR", "filename": "middleware.py", "lineno": 186, "funcName": "dispatch", "message": "Request failed: POST /api/v1/transactions/bc773b5c-a5f4-445a-8a4c-ed1f022ec4dd/join - request_id=unknown client=127.0.0.1 duration=0.068s error=Transaction does not support soft delete", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/transactions.py\", line 432, in join_split_transaction\n    |     parent = await transaction_service.join_split_transaction(\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/transaction_service.py\", line 997, in join_split_transaction\n    |     await self.transaction_repo.soft_delete(child.id)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/repositories/base.py\", line 190, in soft_delete\n    |     raise AttributeError(f\"{self.model.__name__} does not support soft delete\")\n    | AttributeError: Transaction does not support soft delete\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/transactions.py\", line 432, in join_split_transaction\n    parent = await transaction_service.join_split_transaction(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/transaction_service.py\", line 997, in join_split_transaction\n    await self.transaction_repo.soft_delete(child.id)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/repositories/base.py\", line 190, in soft_delete\n    raise AttributeError(f\"{self.model.__name__} does not support soft delete\")\nAttributeError: Transaction does not support soft delete", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:25,176", "name": "src.main", "levelname": "ERROR", "filename": "main.py", "lineno": 201, "funcName": "general_exception_handler", "message": "Unexpected error: Transaction does not support soft delete (request_id=d6805581-3387-4d95-8b93-d2174aebbc90)", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/transactions.py\", line 432, in join_split_transaction\n    |     parent = await transaction_service.join_split_transaction(\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<5 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/transaction_service.py\", line 997, in join_split_transaction\n    |     await self.transaction_repo.soft_delete(child.id)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/repositories/base.py\", line 190, in soft_delete\n    |     raise AttributeError(f\"{self.model.__name__} does not support soft delete\")\n    | AttributeError: Transaction does not support soft delete\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/transactions.py\", line 432, in join_split_transaction\n    parent = await transaction_service.join_split_transaction(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/transaction_service.py\", line 997, in join_split_transaction\n    await self.transaction_repo.soft_delete(child.id)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/repositories/base.py\", line 190, in soft_delete\n    raise AttributeError(f\"{self.model.__name__} does not support soft delete\")\nAttributeError: Transaction does not support soft delete", "correlation_id": "no-request-id"}
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/accounts/9058548a-79b2-4807-a5c3-67cebd1c5208/transactions "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/transactions/bc773b5c-a5f4-445a-8a4c-ed1f022ec4dd/split "HTTP/1.1 200 OK"
__________________________ test_owner_has_full_access __________________________
  + Exception Group Traceback (most recent call last):
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 246, in <lambda>
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/_pytest/python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pytest_asyncio/plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_transaction_api.py", line 606, in test_owner_has_full_access
    |     delete_response = await async_client.delete(
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<2 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1966, in delete
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...<9 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<4 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/transactions.py", line 320, in delete_transaction
    |     await transaction_service.delete_transaction(
    |     ...<5 lines>...
    |     )
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/transaction_service.py", line 751, in delete_transaction
    |     deleted = await self.transaction_repo.soft_delete(transaction_id)
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/danieltorres/Documents/emerald/emerald-backend/src/repositories/base.py", line 190, in soft_delete
    |     raise AttributeError(f"{self.model.__name__} does not support soft delete")
    | AttributeError: Transaction does not support soft delete
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/danieltorres/Documents/emerald/emerald-backend/tests/integration/test_transaction_api.py", line 606, in test_owner_has_full_access
    delete_response = await async_client.delete(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1966, in delete
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...<9 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1134, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 102, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 182, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 124, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 110, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 390, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 289, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/transactions.py", line 320, in delete_transaction
    await transaction_service.delete_transaction(
    ...<5 lines>...
    )
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/services/transaction_service.py", line 751, in delete_transaction
    deleted = await self.transaction_repo.soft_delete(transaction_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/danieltorres/Documents/emerald/emerald-backend/src/repositories/base.py", line 190, in soft_delete
    raise AttributeError(f"{self.model.__name__} does not support soft delete")
AttributeError: Transaction does not support soft delete

The above exception was the direct cause of the following exception:
tests/integration/test_transaction_api.py:606: in test_owner_has_full_access
    delete_response = await async_client.delete(
.venv/lib/python3.13/site-packages/httpx/_client.py:1966: in delete
    return await self.request(
.venv/lib/python3.13/site-packages/httpx/_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1629: in send
    response = await self._send_handling_auth(
.venv/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
.venv/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/applications.py:1134: in __call__
    await super().__call__(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
.venv/lib/python3.13/site-packages/starlette/middleware/cors.py:85: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:102: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:182: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:191: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py:162: in __exit__
    self.gen.throw(value)
.venv/lib/python3.13/site-packages/starlette/_utils.py:85: in collapse_excgroups
    raise exc
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:193: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/middleware.py:56: in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:168: in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
.venv/lib/python3.13/site-packages/starlette/middleware/base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:736: in app
    await route.handle(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/routing.py:290: in handle
    await self.app(scope, receive, send)
.venv/lib/python3.13/site-packages/fastapi/routing.py:124: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
.venv/lib/python3.13/site-packages/fastapi/routing.py:110: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/fastapi/routing.py:390: in app
    raw_response = await run_endpoint_function(
.venv/lib/python3.13/site-packages/fastapi/routing.py:289: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/api/routes/transactions.py:320: in delete_transaction
    await transaction_service.delete_transaction(
src/services/transaction_service.py:751: in delete_transaction
    deleted = await self.transaction_repo.soft_delete(transaction_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/repositories/base.py:190: in soft_delete
    raise AttributeError(f"{self.model.__name__} does not support soft delete")
E   AttributeError: Transaction does not support soft delete
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:22:28,403", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:28,535", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: febd41d9-fb39-4e61-8ba3-25c174d1566f (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:28,568", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=febd41d9-fb39-4e61-8ba3-25c174d1566f, action=LOGIN, entity=user:febd41d9-fb39-4e61-8ba3-25c174d1566f, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:28,571", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: febd41d9-fb39-4e61-8ba3-25c174d1566f (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:28,571", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.085s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:28,571", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:22:28,786", "name": "src.services.transaction_service", "levelname": "INFO", "filename": "transaction_service.py", "lineno": 232, "funcName": "create_transaction", "message": "Created transaction 0bc0c7b1-9e36-442d-8318-945cfe6d2444 for account 5c4dea83-b49b-4ea6-b788-f3bba9d26d20, updated balance: 1000.00 -> 975.00", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:28,793", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=febd41d9-fb39-4e61-8ba3-25c174d1566f, action=CREATE, entity=transaction:0bc0c7b1-9e36-442d-8318-945cfe6d2444, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:28,794", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/accounts/5c4dea83-b49b-4ea6-b788-f3bba9d26d20/transactions 201 - request_id=unknown client=127.0.0.1 duration=0.069s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:28,798", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/accounts/5c4dea83-b49b-4ea6-b788-f3bba9d26d20/transactions \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:28,850", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "GET /api/v1/transactions/0bc0c7b1-9e36-442d-8318-945cfe6d2444 200 - request_id=unknown client=127.0.0.1 duration=0.052s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:28,852", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: GET http://test/api/v1/transactions/0bc0c7b1-9e36-442d-8318-945cfe6d2444 \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:28,925", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=febd41d9-fb39-4e61-8ba3-25c174d1566f, action=UPDATE, entity=transaction:0bc0c7b1-9e36-442d-8318-945cfe6d2444, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:28,925", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "PUT /api/v1/transactions/0bc0c7b1-9e36-442d-8318-945cfe6d2444 200 - request_id=unknown client=127.0.0.1 duration=0.073s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:28,928", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: PUT http://test/api/v1/transactions/0bc0c7b1-9e36-442d-8318-945cfe6d2444 \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:28,983", "name": "src.middleware", "levelname": "ERROR", "filename": "middleware.py", "lineno": 186, "funcName": "dispatch", "message": "Request failed: DELETE /api/v1/transactions/0bc0c7b1-9e36-442d-8318-945cfe6d2444 - request_id=unknown client=127.0.0.1 duration=0.055s error=Transaction does not support soft delete", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/transactions.py\", line 320, in delete_transaction\n    |     await transaction_service.delete_transaction(\n    |     ...<5 lines>...\n    |     )\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/transaction_service.py\", line 751, in delete_transaction\n    |     deleted = await self.transaction_repo.soft_delete(transaction_id)\n    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/repositories/base.py\", line 190, in soft_delete\n    |     raise AttributeError(f\"{self.model.__name__} does not support soft delete\")\n    | AttributeError: Transaction does not support soft delete\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/transactions.py\", line 320, in delete_transaction\n    await transaction_service.delete_transaction(\n    ...<5 lines>...\n    )\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/transaction_service.py\", line 751, in delete_transaction\n    deleted = await self.transaction_repo.soft_delete(transaction_id)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/repositories/base.py\", line 190, in soft_delete\n    raise AttributeError(f\"{self.model.__name__} does not support soft delete\")\nAttributeError: Transaction does not support soft delete", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:28,995", "name": "src.main", "levelname": "ERROR", "filename": "main.py", "lineno": 201, "funcName": "general_exception_handler", "message": "Unexpected error: Transaction does not support soft delete (request_id=a32a9cd6-e4be-4867-b345-fee36b2a9bd9)", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/transactions.py\", line 320, in delete_transaction\n    |     await transaction_service.delete_transaction(\n    |     ...<5 lines>...\n    |     )\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/transaction_service.py\", line 751, in delete_transaction\n    |     deleted = await self.transaction_repo.soft_delete(transaction_id)\n    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/repositories/base.py\", line 190, in soft_delete\n    |     raise AttributeError(f\"{self.model.__name__} does not support soft delete\")\n    | AttributeError: Transaction does not support soft delete\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 102, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 182, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 124, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 110, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 390, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/fastapi/routing.py\", line 289, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/api/routes/transactions.py\", line 320, in delete_transaction\n    await transaction_service.delete_transaction(\n    ...<5 lines>...\n    )\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/services/transaction_service.py\", line 751, in delete_transaction\n    deleted = await self.transaction_repo.soft_delete(transaction_id)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/danieltorres/Documents/emerald/emerald-backend/src/repositories/base.py\", line 190, in soft_delete\n    raise AttributeError(f\"{self.model.__name__} does not support soft delete\")\nAttributeError: Transaction does not support soft delete", "correlation_id": "no-request-id"}
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/accounts/5c4dea83-b49b-4ea6-b788-f3bba9d26d20/transactions "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: GET http://test/api/v1/transactions/0bc0c7b1-9e36-442d-8318-945cfe6d2444 "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: PUT http://test/api/v1/transactions/0bc0c7b1-9e36-442d-8318-945cfe6d2444 "HTTP/1.1 200 OK"
___________________ test_split_transaction_maintains_balance ___________________
tests/integration/test_transaction_api.py:724: in test_split_transaction_maintains_balance
    assert response.status_code == 400
E   assert 422 == 400
E    +  where 422 = <Response [422 Unprocessable Entity]>.status_code
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:22:30,729", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:30,865", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: f6d8dbc5-8658-41d2-b4a2-d0b627636e5d (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:30,899", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=f6d8dbc5-8658-41d2-b4a2-d0b627636e5d, action=LOGIN, entity=user:f6d8dbc5-8658-41d2-b4a2-d0b627636e5d, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:30,901", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: f6d8dbc5-8658-41d2-b4a2-d0b627636e5d (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:30,902", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.086s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:30,902", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:22:31,109", "name": "src.services.transaction_service", "levelname": "INFO", "filename": "transaction_service.py", "lineno": 232, "funcName": "create_transaction", "message": "Created transaction 848b2ccb-600c-480d-9720-7e36793e7775 for account d5f75520-20ad-404c-b49a-303f9214670b, updated balance: 1000.00 -> 950.00", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:31,116", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=f6d8dbc5-8658-41d2-b4a2-d0b627636e5d, action=CREATE, entity=transaction:848b2ccb-600c-480d-9720-7e36793e7775, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:31,117", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/accounts/d5f75520-20ad-404c-b49a-303f9214670b/transactions 201 - request_id=unknown client=127.0.0.1 duration=0.068s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:31,121", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/accounts/d5f75520-20ad-404c-b49a-303f9214670b/transactions \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:31,171", "name": "src.services.transaction_service", "levelname": "WARNING", "filename": "transaction_service.py", "lineno": 858, "funcName": "split_transaction", "message": "Split amounts (-45.00) don't equal parent amount (-50.00)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:31,174", "name": "src.main", "levelname": "WARNING", "filename": "main.py", "lineno": 133, "funcName": "app_exception_handler", "message": "Application exception: VALIDATION_ERROR - Split amounts (-45.00) must equal parent amount (-50.00) (request_id=f74c3219-1b3c-467e-b930-bff775b808f7)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:31,174", "name": "src.middleware", "levelname": "WARNING", "filename": "middleware.py", "lineno": 208, "funcName": "dispatch", "message": "POST /api/v1/transactions/848b2ccb-600c-480d-9720-7e36793e7775/split 422 - request_id=unknown client=127.0.0.1 duration=0.053s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:31,305", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/transactions/848b2ccb-600c-480d-9720-7e36793e7775/split \"HTTP/1.1 422 Unprocessable Entity\"", "correlation_id": "no-request-id"}
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/accounts/d5f75520-20ad-404c-b49a-303f9214670b/transactions "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/transactions/848b2ccb-600c-480d-9720-7e36793e7775/split "HTTP/1.1 422 Unprocessable Entity"
_________________ test_cannot_split_already_split_transaction __________________
tests/integration/test_transaction_api.py:772: in test_cannot_split_already_split_transaction
    assert response.status_code == 400
E   assert 200 == 400
E    +  where 200 = <Response [200 OK]>.status_code
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:22:31,430", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:31,567", "name": "src.services.auth_service", "levelname": "INFO", "filename": "auth_service.py", "lineno": 193, "funcName": "login", "message": "User logged in successfully: 22b80a26-a84c-4a8f-b417-b524d7e352af (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:31,600", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=22b80a26-a84c-4a8f-b417-b524d7e352af, action=LOGIN, entity=user:22b80a26-a84c-4a8f-b417-b524d7e352af, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:31,603", "name": "src.api.routes.auth", "levelname": "INFO", "filename": "auth.py", "lineno": 185, "funcName": "login", "message": "User logged in: 22b80a26-a84c-4a8f-b417-b524d7e352af (testuser@example.com)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:31,603", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/auth/login 200 - request_id=unknown client=127.0.0.1 duration=0.086s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:31,604", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/auth/login \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/auth/login "HTTP/1.1 200 OK"
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:22:31,817", "name": "src.services.transaction_service", "levelname": "INFO", "filename": "transaction_service.py", "lineno": 232, "funcName": "create_transaction", "message": "Created transaction 0da02274-a665-467e-931d-c4bae4fcb394 for account a852f604-703b-43f5-8926-e9a3d901a08d, updated balance: 1000.00 -> 950.00", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:31,824", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=22b80a26-a84c-4a8f-b417-b524d7e352af, action=CREATE, entity=transaction:0da02274-a665-467e-931d-c4bae4fcb394, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:31,825", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/accounts/a852f604-703b-43f5-8926-e9a3d901a08d/transactions 201 - request_id=unknown client=127.0.0.1 duration=0.068s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:31,828", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/accounts/a852f604-703b-43f5-8926-e9a3d901a08d/transactions \"HTTP/1.1 201 Created\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:31,885", "name": "src.services.transaction_service", "levelname": "INFO", "filename": "transaction_service.py", "lineno": 901, "funcName": "split_transaction", "message": "Split transaction 0da02274-a665-467e-931d-c4bae4fcb394 into 2 children", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:31,892", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=22b80a26-a84c-4a8f-b417-b524d7e352af, action=SPLIT_TRANSACTION, entity=transaction:0da02274-a665-467e-931d-c4bae4fcb394, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:31,894", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/transactions/0da02274-a665-467e-931d-c4bae4fcb394/split 200 - request_id=unknown client=127.0.0.1 duration=0.065s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:31,897", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/transactions/0da02274-a665-467e-931d-c4bae4fcb394/split \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:31,962", "name": "src.services.transaction_service", "levelname": "INFO", "filename": "transaction_service.py", "lineno": 901, "funcName": "split_transaction", "message": "Split transaction 0da02274-a665-467e-931d-c4bae4fcb394 into 2 children", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:31,969", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=22b80a26-a84c-4a8f-b417-b524d7e352af, action=SPLIT_TRANSACTION, entity=transaction:0da02274-a665-467e-931d-c4bae4fcb394, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:31,974", "name": "src.middleware", "levelname": "INFO", "filename": "middleware.py", "lineno": 206, "funcName": "dispatch", "message": "POST /api/v1/transactions/0da02274-a665-467e-931d-c4bae4fcb394/split 200 - request_id=unknown client=127.0.0.1 duration=0.077s user_agent=python-httpx/0.28.1", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:31,978", "name": "httpx", "levelname": "INFO", "filename": "_client.py", "lineno": 1740, "funcName": "_send_single_request", "message": "HTTP Request: POST http://test/api/v1/transactions/0da02274-a665-467e-931d-c4bae4fcb394/split \"HTTP/1.1 200 OK\"", "correlation_id": "no-request-id"}
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/accounts/a852f604-703b-43f5-8926-e9a3d901a08d/transactions "HTTP/1.1 201 Created"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/transactions/0da02274-a665-467e-931d-c4bae4fcb394/split "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1740 HTTP Request: POST http://test/api/v1/transactions/0da02274-a665-467e-931d-c4bae4fcb394/split "HTTP/1.1 200 OK"
_____________ TestAccountRepository.test_get_by_user_with_filters ______________
tests/unit/repositories/test_account_repository.py:169: in test_get_by_user_with_filters
    assert len(active_accounts) == 2
E   assert 3 == 2
E    +  where 3 = len([Account(id=c01c5e9c-b037-49a4-bfe5-49027a25898c, name=Active Other, type=other, balance=-200.00 USD, institution=Chase), Account(id=13839e49-11df-432c-93bf-176477523ebc, name=Inactive Savings, type=savings, balance=500.00 USD, institution=Chase), Account(id=b3ad337b-44d2-44e9-ab12-c90fd252f109, name=Active Savings, type=savings, balance=1000.00 USD, institution=Chase)])
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:22:40,375", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
________________ TestAccountRepository.test_count_user_accounts ________________
tests/unit/repositories/test_account_repository.py:382: in test_count_user_accounts
    assert count == 3
E   assert 4 == 3
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:22:41,261", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
_____________ TestTransactionRepository.test_soft_delete_filtering _____________
tests/unit/repositories/test_transaction_repository.py:374: in test_soft_delete_filtering
    await repo.soft_delete(created.id)
src/repositories/base.py:190: in soft_delete
    raise AttributeError(f"{self.model.__name__} does not support soft delete")
E   AttributeError: Transaction does not support soft delete
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:22:44,224", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
___________ TestAccountService.test_create_account_invalid_currency ____________
tests/unit/services/test_account_service.py:94: in test_create_account_invalid_currency
    await service.create_account(
src/services/account_service.py:165: in create_account
    raise ValidationError(
E   src.exceptions.ValidationError: Unsupported currency code 'US'. Supported currencies: USD, EUR, GBP, CHF, JPY, CNY
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:22:45,136", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:22:45,290", "name": "src.core.encryption", "levelname": "INFO", "filename": "encryption.py", "lineno": 64, "funcName": "__init__", "message": "Encryption service initialized successfully", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:45,296", "name": "src.services.account_service", "levelname": "WARNING", "filename": "account_service.py", "lineno": 162, "funcName": "create_account", "message": "User 923f4b06-d52e-4ab8-8233-87aeae5a2f1a attempted to create account with unsupported currency: US", "correlation_id": "no-request-id"}
____________________ TestAccountService.test_list_accounts _____________________
tests/unit/services/test_account_service.py:213: in test_list_accounts
    accounts = await service.list_accounts(
                     ^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'AccountService' object has no attribute 'list_accounts'. Did you mean: 'get_account'?
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:22:46,056", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:22:46,207", "name": "src.core.encryption", "levelname": "INFO", "filename": "encryption.py", "lineno": 64, "funcName": "__init__", "message": "Encryption service initialized successfully", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:46,235", "name": "src.services.account_service", "levelname": "INFO", "filename": "account_service.py", "lineno": 217, "funcName": "create_account", "message": "Created account 0638def4-cd97-487a-a7b5-b0b198d5f33a (Account 0) for user 923f4b06-d52e-4ab8-8233-87aeae5a2f1a", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:46,242", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=923f4b06-d52e-4ab8-8233-87aeae5a2f1a, action=CREATE, entity=account:0638def4-cd97-487a-a7b5-b0b198d5f33a, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:46,247", "name": "src.services.account_service", "levelname": "INFO", "filename": "account_service.py", "lineno": 217, "funcName": "create_account", "message": "Created account 47e37cf1-6c86-435f-a9e2-97ba3474be1c (Account 1) for user 923f4b06-d52e-4ab8-8233-87aeae5a2f1a", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:46,249", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=923f4b06-d52e-4ab8-8233-87aeae5a2f1a, action=CREATE, entity=account:47e37cf1-6c86-435f-a9e2-97ba3474be1c, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:46,253", "name": "src.services.account_service", "levelname": "INFO", "filename": "account_service.py", "lineno": 217, "funcName": "create_account", "message": "Created account 01607217-25db-4615-8013-33f62b17171f (Account 2) for user 923f4b06-d52e-4ab8-8233-87aeae5a2f1a", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:46,255", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=923f4b06-d52e-4ab8-8233-87aeae5a2f1a, action=CREATE, entity=account:01607217-25db-4615-8013-33f62b17171f, status=SUCCESS", "correlation_id": "no-request-id"}
______________ TestAccountService.test_list_accounts_with_filters ______________
tests/unit/services/test_account_service.py:258: in test_list_accounts_with_filters
    active_accounts = await service.list_accounts(
                            ^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'AccountService' object has no attribute 'list_accounts'. Did you mean: 'get_account'?
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:22:46,263", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:22:46,440", "name": "src.core.encryption", "levelname": "INFO", "filename": "encryption.py", "lineno": 64, "funcName": "__init__", "message": "Encryption service initialized successfully", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:46,469", "name": "src.services.account_service", "levelname": "INFO", "filename": "account_service.py", "lineno": 217, "funcName": "create_account", "message": "Created account aa86bf4b-07d4-473e-98d4-2bfba1e7109e (Active Savings) for user 923f4b06-d52e-4ab8-8233-87aeae5a2f1a", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:46,475", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=923f4b06-d52e-4ab8-8233-87aeae5a2f1a, action=CREATE, entity=account:aa86bf4b-07d4-473e-98d4-2bfba1e7109e, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:46,480", "name": "src.services.account_service", "levelname": "INFO", "filename": "account_service.py", "lineno": 217, "funcName": "create_account", "message": "Created account 6a02038b-41c4-4bd2-8602-7840a7055e15 (Active Other) for user 923f4b06-d52e-4ab8-8233-87aeae5a2f1a", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:46,481", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=923f4b06-d52e-4ab8-8233-87aeae5a2f1a, action=CREATE, entity=account:6a02038b-41c4-4bd2-8602-7840a7055e15, status=SUCCESS", "correlation_id": "no-request-id"}
_______________ TestAccountService.test_list_accounts_pagination _______________
tests/unit/services/test_account_service.py:293: in test_list_accounts_pagination
    page1 = await service.list_accounts(
                  ^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'AccountService' object has no attribute 'list_accounts'. Did you mean: 'get_account'?
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:22:46,498", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:22:46,645", "name": "src.core.encryption", "levelname": "INFO", "filename": "encryption.py", "lineno": 64, "funcName": "__init__", "message": "Encryption service initialized successfully", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:46,673", "name": "src.services.account_service", "levelname": "INFO", "filename": "account_service.py", "lineno": 217, "funcName": "create_account", "message": "Created account 8805c745-5bce-47d9-a15a-d19f8ca81e0b (Account 0) for user 923f4b06-d52e-4ab8-8233-87aeae5a2f1a", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:46,679", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=923f4b06-d52e-4ab8-8233-87aeae5a2f1a, action=CREATE, entity=account:8805c745-5bce-47d9-a15a-d19f8ca81e0b, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:46,684", "name": "src.services.account_service", "levelname": "INFO", "filename": "account_service.py", "lineno": 217, "funcName": "create_account", "message": "Created account 49fa93c2-3daa-4776-9da4-4af5fd350e4b (Account 1) for user 923f4b06-d52e-4ab8-8233-87aeae5a2f1a", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:46,686", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=923f4b06-d52e-4ab8-8233-87aeae5a2f1a, action=CREATE, entity=account:49fa93c2-3daa-4776-9da4-4af5fd350e4b, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:46,691", "name": "src.services.account_service", "levelname": "INFO", "filename": "account_service.py", "lineno": 217, "funcName": "create_account", "message": "Created account 8cbe2c04-77c8-456c-8d1f-8b1f17f14108 (Account 2) for user 923f4b06-d52e-4ab8-8233-87aeae5a2f1a", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:46,693", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=923f4b06-d52e-4ab8-8233-87aeae5a2f1a, action=CREATE, entity=account:8cbe2c04-77c8-456c-8d1f-8b1f17f14108, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:46,698", "name": "src.services.account_service", "levelname": "INFO", "filename": "account_service.py", "lineno": 217, "funcName": "create_account", "message": "Created account c242e491-408e-4976-8cf7-cc17700d919d (Account 3) for user 923f4b06-d52e-4ab8-8233-87aeae5a2f1a", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:46,700", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=923f4b06-d52e-4ab8-8233-87aeae5a2f1a, action=CREATE, entity=account:c242e491-408e-4976-8cf7-cc17700d919d, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:46,705", "name": "src.services.account_service", "levelname": "INFO", "filename": "account_service.py", "lineno": 217, "funcName": "create_account", "message": "Created account edabdfe8-a46b-4d1d-94bd-3f196f354bfc (Account 4) for user 923f4b06-d52e-4ab8-8233-87aeae5a2f1a", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:46,706", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=923f4b06-d52e-4ab8-8233-87aeae5a2f1a, action=CREATE, entity=account:edabdfe8-a46b-4d1d-94bd-3f196f354bfc, status=SUCCESS", "correlation_id": "no-request-id"}
_____________ TestAccountService.test_list_accounts_limit_enforced _____________
tests/unit/services/test_account_service.py:328: in test_list_accounts_limit_enforced
    accounts = await service.list_accounts(
                     ^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'AccountService' object has no attribute 'list_accounts'. Did you mean: 'get_account'?
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:22:46,714", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:22:46,862", "name": "src.core.encryption", "levelname": "INFO", "filename": "encryption.py", "lineno": 64, "funcName": "__init__", "message": "Encryption service initialized successfully", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:46,889", "name": "src.services.account_service", "levelname": "INFO", "filename": "account_service.py", "lineno": 217, "funcName": "create_account", "message": "Created account 7757bbae-b7cf-41ac-99b4-cb2cfb72774e (Test) for user 923f4b06-d52e-4ab8-8233-87aeae5a2f1a", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:46,895", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=923f4b06-d52e-4ab8-8233-87aeae5a2f1a, action=CREATE, entity=account:7757bbae-b7cf-41ac-99b4-cb2cfb72774e, status=SUCCESS", "correlation_id": "no-request-id"}
____________________ TestAccountService.test_delete_account ____________________
tests/unit/services/test_account_service.py:457: in test_delete_account
    accounts = await service.list_accounts(
                     ^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'AccountService' object has no attribute 'list_accounts'. Did you mean: 'get_account'?
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:22:47,511", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:22:47,659", "name": "src.core.encryption", "levelname": "INFO", "filename": "encryption.py", "lineno": 64, "funcName": "__init__", "message": "Encryption service initialized successfully", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:47,686", "name": "src.services.account_service", "levelname": "INFO", "filename": "account_service.py", "lineno": 217, "funcName": "create_account", "message": "Created account 7b997559-dc61-42d4-a509-df72ed9f14fe (To Delete) for user 923f4b06-d52e-4ab8-8233-87aeae5a2f1a", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:47,693", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=923f4b06-d52e-4ab8-8233-87aeae5a2f1a, action=CREATE, entity=account:7b997559-dc61-42d4-a509-df72ed9f14fe, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:47,707", "name": "src.services.account_service", "levelname": "INFO", "filename": "account_service.py", "lineno": 597, "funcName": "delete_account", "message": "Soft deleted account 7b997559-dc61-42d4-a509-df72ed9f14fe (To Delete)", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:47,709", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=923f4b06-d52e-4ab8-8233-87aeae5a2f1a, action=DELETE, entity=account:7b997559-dc61-42d4-a509-df72ed9f14fe, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:47,709", "name": "src.services.account_service", "levelname": "WARNING", "filename": "account_service.py", "lineno": 273, "funcName": "get_account", "message": "Account 7b997559-dc61-42d4-a509-df72ed9f14fe not found", "correlation_id": "no-request-id"}
_________________ TestAccountService.test_count_user_accounts __________________
tests/unit/services/test_account_service.py:503: in test_count_user_accounts
    assert count == 0
E   assert 13 == 0
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:22:47,940", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:22:48,087", "name": "src.core.encryption", "levelname": "INFO", "filename": "encryption.py", "lineno": 64, "funcName": "__init__", "message": "Encryption service initialized successfully", "correlation_id": "no-request-id"}
_________ TestTransactionServiceDelete.test_delete_transaction_success _________
tests/unit/services/test_transaction_service.py:393: in test_delete_transaction_success
    deleted = await service.delete_transaction(created.id, test_user)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/services/transaction_service.py:751: in delete_transaction
    deleted = await self.transaction_repo.soft_delete(transaction_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/repositories/base.py:190: in soft_delete
    raise AttributeError(f"{self.model.__name__} does not support soft delete")
E   AttributeError: Transaction does not support soft delete
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:22:51,326", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:22:51,555", "name": "src.services.transaction_service", "levelname": "INFO", "filename": "transaction_service.py", "lineno": 232, "funcName": "create_transaction", "message": "Created transaction e0e65874-28e0-4676-830d-9ef593ea6588 for account 20ee9742-f0e5-4eb7-b099-7b93d9a45941, updated balance: 1000.00 -> 950.00", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:51,563", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=923f4b06-d52e-4ab8-8233-87aeae5a2f1a, action=CREATE, entity=transaction:e0e65874-28e0-4676-830d-9ef593ea6588, status=SUCCESS", "correlation_id": "no-request-id"}
_____ TestTransactionServiceDelete.test_delete_transaction_updates_balance _____
tests/unit/services/test_transaction_service.py:423: in test_delete_transaction_updates_balance
    await service.delete_transaction(created.id, test_user)
src/services/transaction_service.py:751: in delete_transaction
    deleted = await self.transaction_repo.soft_delete(transaction_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/repositories/base.py:190: in soft_delete
    raise AttributeError(f"{self.model.__name__} does not support soft delete")
E   AttributeError: Transaction does not support soft delete
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:22:51,591", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:22:51,820", "name": "src.services.transaction_service", "levelname": "INFO", "filename": "transaction_service.py", "lineno": 232, "funcName": "create_transaction", "message": "Created transaction 6993bfa3-7f56-4676-9904-fe406d37667d for account e39bcb0d-4193-4870-b651-66a7df2d2fe9, updated balance: 1000.00 -> 950.00", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:51,827", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=923f4b06-d52e-4ab8-8233-87aeae5a2f1a, action=CREATE, entity=transaction:6993bfa3-7f56-4676-9904-fe406d37667d, status=SUCCESS", "correlation_id": "no-request-id"}
_______ TestTransactionServiceDelete.test_delete_parent_deletes_children _______
tests/unit/services/test_transaction_service.py:457: in test_delete_parent_deletes_children
    await service.delete_transaction(parent.id, test_user)
src/services/transaction_service.py:745: in delete_transaction
    await self.transaction_repo.soft_delete(child.id)
src/repositories/base.py:190: in soft_delete
    raise AttributeError(f"{self.model.__name__} does not support soft delete")
E   AttributeError: Transaction does not support soft delete
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:22:51,919", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:22:52,151", "name": "src.services.transaction_service", "levelname": "INFO", "filename": "transaction_service.py", "lineno": 232, "funcName": "create_transaction", "message": "Created transaction e10da096-1fe3-4a8b-a983-1c992ad7a400 for account 7ac5859d-db84-4c5b-ad54-63c8f70048ff, updated balance: 1000.00 -> 950.00", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:52,159", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=923f4b06-d52e-4ab8-8233-87aeae5a2f1a, action=CREATE, entity=transaction:e10da096-1fe3-4a8b-a983-1c992ad7a400, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:52,172", "name": "src.services.transaction_service", "levelname": "INFO", "filename": "transaction_service.py", "lineno": 901, "funcName": "split_transaction", "message": "Split transaction e10da096-1fe3-4a8b-a983-1c992ad7a400 into 2 children", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:52,174", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=923f4b06-d52e-4ab8-8233-87aeae5a2f1a, action=SPLIT_TRANSACTION, entity=transaction:e10da096-1fe3-4a8b-a983-1c992ad7a400, status=SUCCESS", "correlation_id": "no-request-id"}
___________ TestTransactionServiceSplit.test_join_split_transaction ____________
tests/unit/services/test_transaction_service.py:623: in test_join_split_transaction
    joined = await service.join_split_transaction(parent.id, test_user)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src/services/transaction_service.py:997: in join_split_transaction
    await self.transaction_repo.soft_delete(child.id)
src/repositories/base.py:190: in soft_delete
    raise AttributeError(f"{self.model.__name__} does not support soft delete")
E   AttributeError: Transaction does not support soft delete
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:22:53,233", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:22:53,463", "name": "src.services.transaction_service", "levelname": "INFO", "filename": "transaction_service.py", "lineno": 232, "funcName": "create_transaction", "message": "Created transaction 60b1a74d-e643-433f-94bb-722dbb1559f7 for account def8ffb6-8ec4-4acc-9943-ff8525c535e0, updated balance: 1000.00 -> 950.00", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:53,471", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=923f4b06-d52e-4ab8-8233-87aeae5a2f1a, action=CREATE, entity=transaction:60b1a74d-e643-433f-94bb-722dbb1559f7, status=SUCCESS", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:53,485", "name": "src.services.transaction_service", "levelname": "INFO", "filename": "transaction_service.py", "lineno": 901, "funcName": "split_transaction", "message": "Split transaction 60b1a74d-e643-433f-94bb-722dbb1559f7 into 2 children", "correlation_id": "no-request-id"}
{"asctime": "2025-12-14 19:22:53,486", "name": "src.services.audit_service", "levelname": "DEBUG", "filename": "audit_service.py", "lineno": 118, "funcName": "log_event", "message": "Audit log created: user=923f4b06-d52e-4ab8-8233-87aeae5a2f1a, action=SPLIT_TRANSACTION, entity=transaction:60b1a74d-e643-433f-94bb-722dbb1559f7, status=SUCCESS", "correlation_id": "no-request-id"}
_ TestTransactionServiceCardValidation.test_create_transaction_with_other_users_card_raises_not_found _
.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:550: in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/asyncpg/prepared_stmt.py:176: in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
    data, status, _ = await self.__do_execute(
.venv/lib/python3.13/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:206: in bind_execute
    ???
E   asyncpg.exceptions.NotNullViolationError: null value in column "current_balance" of relation "accounts" violates not-null constraint
E   DETAIL:  Failing row contains (2b2c5992-6334-4f30-bf19-3bfb8b02989f, 9afda364-a169-4aab-bb4b-6416f25decce, Admin Account, 1a7e9233-2547-4d89-a5a0-1c02869de94d, USD, 0.00, null, #818E8F, null, null, null, null, 7095d7b0-5f6a-404f-ba2f-1a95f822a5c3, 2025-12-14 18:22:54.785336+00, 2025-12-14 18:22:54.785339+00, null, null, null).

The above exception was the direct cause of the following exception:
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:585: in execute
    self._adapt_connection.await_(
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:563: in _prepare_and_execute
    self._handle_exception(error)
.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:513: in _handle_exception
    self._adapt_connection._handle_exception(error)
.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:797: in _handle_exception
    raise translated_error from error
E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column "current_balance" of relation "accounts" violates not-null constraint
E   DETAIL:  Failing row contains (2b2c5992-6334-4f30-bf19-3bfb8b02989f, 9afda364-a169-4aab-bb4b-6416f25decce, Admin Account, 1a7e9233-2547-4d89-a5a0-1c02869de94d, USD, 0.00, null, #818E8F, null, null, null, null, 7095d7b0-5f6a-404f-ba2f-1a95f822a5c3, 2025-12-14 18:22:54.785336+00, 2025-12-14 18:22:54.785339+00, null, null, null).

The above exception was the direct cause of the following exception:
tests/unit/services/test_transaction_service.py:732: in test_create_transaction_with_other_users_card_raises_not_found
    admin_account = await AccountRepository(db_session).create(
src/repositories/base.py:87: in create
    await self.session.flush()
.venv/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py:787: in flush
    await greenlet_spawn(self.sync_session.flush, objects=objects)
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:203: in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py:4331: in flush
    self._flush(objects)
.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py:4466: in _flush
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
.venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py:4427: in _flush
    flush_context.execute()
.venv/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py:466: in execute
    rec.execute(self)
.venv/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py:642: in execute
    util.preloaded.orm_persistence.save_obj(
.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py:93: in save_obj
    _emit_insert_statements(
.venv/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py:1233: in _emit_insert_statements
    result = connection.execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1419: in execute
    return meth(
.venv/lib/python3.13/site-packages/sqlalchemy/sql/elements.py:526: in _execute_on_connection
    return connection._execute_clauseelement(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1641: in _execute_clauseelement
    ret = self._execute_context(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1846: in _execute_context
    return self._exec_single_context(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1986: in _exec_single_context
    self._handle_dbapi_exception(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2355: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1967: in _exec_single_context
    self.dialect.do_execute(
.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py:951: in do_execute
    cursor.execute(statement, parameters)
.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:585: in execute
    self._adapt_connection.await_(
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:563: in _prepare_and_execute
    self._handle_exception(error)
.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:513: in _handle_exception
    self._adapt_connection._handle_exception(error)
.venv/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:797: in _handle_exception
    raise translated_error from error
E   sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column "current_balance" of relation "accounts" violates not-null constraint
E   DETAIL:  Failing row contains (2b2c5992-6334-4f30-bf19-3bfb8b02989f, 9afda364-a169-4aab-bb4b-6416f25decce, Admin Account, 1a7e9233-2547-4d89-a5a0-1c02869de94d, USD, 0.00, null, #818E8F, null, null, null, null, 7095d7b0-5f6a-404f-ba2f-1a95f822a5c3, 2025-12-14 18:22:54.785336+00, 2025-12-14 18:22:54.785339+00, null, null, null).
E   [SQL: INSERT INTO accounts (user_id, financial_institution_id, account_name, account_type_id, currency, opening_balance, current_balance, color_hex, icon_url, iban, iban_last_four, notes, id, created_at, updated_at, deleted_at, created_by, updated_by) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::UUID, $5::VARCHAR, $6::NUMERIC(15, 2), $7::NUMERIC(15, 2), $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::UUID, $14::TIMESTAMP WITH TIME ZONE, $15::TIMESTAMP WITH TIME ZONE, $16::TIMESTAMP WITH TIME ZONE, $17::UUID, $18::UUID)]
E   [parameters: (UUID('2b2c5992-6334-4f30-bf19-3bfb8b02989f'), UUID('9afda364-a169-4aab-bb4b-6416f25decce'), 'Admin Account', UUID('1a7e9233-2547-4d89-a5a0-1c02869de94d'), 'USD', Decimal('0'), None, '#818E8F', None, None, None, None, UUID('7095d7b0-5f6a-404f-ba2f-1a95f822a5c3'), datetime.datetime(2025, 12, 14, 18, 22, 54, 785336, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 12, 14, 18, 22, 54, 785339, tzinfo=datetime.timezone.utc), None, None, None)]
E   (Background on this error at: https://sqlalche.me/e/20/gkpj)
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:22:54,572", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
_______________ TestDeactivateUser.test_deactivate_user_as_admin _______________
tests/unit/services/test_user_service.py:492: in test_deactivate_user_as_admin
    mock_user_repo.update.assert_called_once_with(regular_user)
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:988: in assert_called_once_with
    raise AssertionError(msg)
E   AssertionError: Expected 'update' to be called once. Called 0 times.
---------------------------- Captured stdout setup -----------------------------
{"asctime": "2025-12-14 19:22:55,994", "name": "asyncio", "levelname": "DEBUG", "filename": "selector_events.py", "lineno": 64, "funcName": "__init__", "message": "Using selector: KqueueSelector", "correlation_id": "no-request-id"}
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------- Captured stdout call -----------------------------
{"asctime": "2025-12-14 19:22:55,995", "name": "src.services.user_service", "levelname": "INFO", "filename": "user_service.py", "lineno": 376, "funcName": "deactivate_user", "message": "User 9dfc2660-17ea-4cf8-b9c8-7c625a7cecdc deactivated by admin 84d9e8be-1770-4db6-9386-ab92de50ee3b", "correlation_id": "no-request-id"}
=============================== warnings summary ===============================
.venv/lib/python3.13/site-packages/pythonjsonlogger/jsonlogger.py:11
  /Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/pythonjsonlogger/jsonlogger.py:11: DeprecationWarning: pythonjsonlogger.jsonlogger has been moved to pythonjsonlogger.json
    warnings.warn(

tests/e2e/test_user_journey.py: 1 warning
tests/integration/test_account_routes.py: 4 warnings
tests/integration/test_account_type_routes.py: 4 warnings
tests/integration/test_auth_routes.py: 3 warnings
tests/integration/test_card_routes.py: 1 warning
tests/integration/test_financial_institution_routes.py: 2 warnings
tests/integration/test_transaction_api.py: 1 warning
  /Users/danieltorres/Documents/emerald/emerald-backend/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py:59: DeprecationWarning: 'HTTP_422_UNPROCESSABLE_ENTITY' is deprecated. Use 'HTTP_422_UNPROCESSABLE_CONTENT' instead.
    response = await handler(conn, exc)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/e2e/test_collaboration_workflow.py::test_account_sharing_collaboration_workflow
FAILED tests/e2e/test_collaboration_workflow.py::test_shared_account_transaction_visibility
FAILED tests/e2e/test_user_journey.py::test_new_user_creates_multiple_accounts_and_transactions
FAILED tests/e2e/test_user_journey.py::test_transaction_split_and_join_workflow
FAILED tests/e2e/test_user_journey.py::test_account_lifecycle_workflow - asse...
FAILED tests/integration/test_account_routes.py::TestAccountRoutes::test_create_account_inactive_account_type
FAILED tests/integration/test_account_routes.py::TestAccountRoutes::test_update_account_invalid_account_type
FAILED tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_create_account_type_minimal_data
FAILED tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_create_account_type_duplicate_key
FAILED tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_create_account_type_invalid_key_format
FAILED tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_create_account_type_whitespace_trimming
FAILED tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_list_account_types_success
FAILED tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_list_account_types_filter_active_only
FAILED tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_list_account_types_filter_inactive_only
FAILED tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_list_account_types_all
FAILED tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_list_account_types_ordering
FAILED tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_get_account_type_by_id_success
FAILED tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_get_account_type_by_id_inactive
FAILED tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_get_account_type_by_key_success
FAILED tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_get_account_type_by_key_case_insensitive
FAILED tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_update_account_type_success
FAILED tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_update_account_type_partial
FAILED tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_update_account_type_deactivate_via_update
FAILED tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_update_account_type_non_admin_forbidden
FAILED tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_deactivate_account_type_success
FAILED tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_deactivate_account_type_already_inactive
FAILED tests/integration/test_account_type_routes.py::TestAccountTypeRoutes::test_deactivate_account_type_non_admin_forbidden
FAILED tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_update_institution_swift_code_conflict
FAILED tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_deactivate_institution_success
FAILED tests/integration/test_financial_institution_routes.py::TestFinancialInstitutionRoutes::test_deactivate_institution_non_admin_forbidden
FAILED tests/integration/test_transaction_api.py::TestTransactionAPI::test_delete_transaction
FAILED tests/integration/test_transaction_api.py::TestTransactionAPI::test_split_transaction
FAILED tests/integration/test_transaction_api.py::TestTransactionAPI::test_join_split_transaction
FAILED tests/integration/test_transaction_api.py::test_owner_has_full_access
FAILED tests/integration/test_transaction_api.py::test_split_transaction_maintains_balance
FAILED tests/integration/test_transaction_api.py::test_cannot_split_already_split_transaction
FAILED tests/unit/repositories/test_account_repository.py::TestAccountRepository::test_get_by_user_with_filters
FAILED tests/unit/repositories/test_account_repository.py::TestAccountRepository::test_count_user_accounts
FAILED tests/unit/repositories/test_transaction_repository.py::TestTransactionRepository::test_soft_delete_filtering
FAILED tests/unit/services/test_account_service.py::TestAccountService::test_create_account_invalid_currency
FAILED tests/unit/services/test_account_service.py::TestAccountService::test_list_accounts
FAILED tests/unit/services/test_account_service.py::TestAccountService::test_list_accounts_with_filters
FAILED tests/unit/services/test_account_service.py::TestAccountService::test_list_accounts_pagination
FAILED tests/unit/services/test_account_service.py::TestAccountService::test_list_accounts_limit_enforced
FAILED tests/unit/services/test_account_service.py::TestAccountService::test_delete_account
FAILED tests/unit/services/test_account_service.py::TestAccountService::test_count_user_accounts
FAILED tests/unit/services/test_transaction_service.py::TestTransactionServiceDelete::test_delete_transaction_success
FAILED tests/unit/services/test_transaction_service.py::TestTransactionServiceDelete::test_delete_transaction_updates_balance
FAILED tests/unit/services/test_transaction_service.py::TestTransactionServiceDelete::test_delete_parent_deletes_children
FAILED tests/unit/services/test_transaction_service.py::TestTransactionServiceSplit::test_join_split_transaction
FAILED tests/unit/services/test_transaction_service.py::TestTransactionServiceCardValidation::test_create_transaction_with_other_users_card_raises_not_found
FAILED tests/unit/services/test_user_service.py::TestDeactivateUser::test_deactivate_user_as_admin
=========== 52 failed, 348 passed, 17 warnings in 114.17s (0:01:54) ============
